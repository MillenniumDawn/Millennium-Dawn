# Decisions that Relate to Debt Management
# Written by Bird
bankruptcy_decisions = {
	# Commit To Reducing Debt
	committed_to_reducing_debt = {
		icon = generic_break_treaty
		# This mission should only trigger
		activation = {
			OR = {
				has_country_flag = BANK_committed_reducing_debt
				has_variable = reduce_debt_by_5
			}
		}

		available = {
			custom_trigger_tooltip = {
				tooltip = passed_desired_amount_tt
				check_variable = { debt < reduce_debt_by_5 }
			}
		}

		days_mission_timeout = 180
		cancel_if_not_visible = yes

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision timeout bankruptcy_timer"
			country_event = { id = bankruptcy.201 }
			clr_country_flag = BANK_committed_reducing_debt
		}
	}

	# Use Investments to Pay Down Debt
	apply_investments_to_debt = {
		icon = attract_foreign_investor
		available = {
			custom_trigger_tooltip = {
				tooltip = has_int_investments_tt
				check_variable = { int_investments > 0 }
			}
		}
		days_remove = 25
		days_re_enable = 5

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision apply_investments_to_debt"
			set_temp_variable = { investment_reducer = int_investments }
			multiply_temp_variable = { investment_reducer = 0.05 }
			subtract_from_variable = { debt = investment_reducer }
			subtract_from_variable = { int_investments = investment_reducer }
			custom_effect_tooltip = apply_int_investments_to_debt_5_tt
			if = {
				limit = {
					has_idea = international_bankers
					NOT = { has_country_flag = recently_scoured_investments }
				}
				set_country_flag = { flag = recently_scoured_investments value = 1 days = 90 }
				decrease_international_bankers_opinion = yes
				custom_effect_tooltip = internal_faction_decrease_every_three_months_tt
			}
			ingame_update_setup = yes
		}
	}

	# Seek Foreign Bailouts
	seek_additional_bailouts = {
		icon = attract_foreign_investor

		available = {
			custom_trigger_tooltip = {
				tooltip = "has_foreign_influence"
				check_variable = { influence_array^0 > 0 }
			}
		}
		days_remove = 0
		days_re_enable = 120

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision seek_additional_bailouts"
			if = { limit = { NOT = { has_country_flag = hostile_international_bankers } }
				decrease_international_bankers_opinion = yes
			}
			country_event = { id = bankruptcy.0 } # Seek Foreign Bailouts
		}
	}

	# Temporary Interest Rate Reduction
	reduce_interest_rate = {
		icon = generic_break_treaty

		available = {
			custom_trigger_tooltip = {
				tooltip = interest_rate_greater_than_13_tt
				check_variable = { interest_rate > 12.999 }
			}
		}

		days_remove = 75
		days_re_enable = 15

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision reduce_interest_rate"
			set_country_flag = { flag = reduce_interest_by_1 value = 1 days = 75 }
			custom_effect_tooltip = reduce_interest_by_1_tt
			add_1_popularity = yes
			ingame_update_setup = yes
		}
	}
}