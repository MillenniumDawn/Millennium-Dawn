add_namespace = taiwan

### 228 Hand-in-Hand rally

country_event = {
	id = taiwan.1
	immediate = {log = "[GetDateText]: [Root.GetName]: event taiwan.1"}

	title = taiwan.1.t
	desc = taiwan.1.d
	picture = GFX_TAI_taiwan

	fire_only_once = yes

	trigger = {
		tag = TAI
		date > 2004.2.28
	}

	option = {
		name = taiwan.1.a
		log = "[GetDateText]: [This.GetName]: taiwan.1.a executed"
		add_popularity = { ideology = democratic popularity = 0.03 }
	}
}

### Typhoon Bilis

country_event = {
	id = taiwan.2
	immediate = {log = "[GetDateText]: [Root.GetName]: event taiwan.2"}

	title = taiwan.2.t
	desc = taiwan.2.d
	picture = GFX_typhoon

	fire_only_once = yes

	trigger = {
		tag = TAI
		date > 2000.8.20
	}

	option = {
		name = taiwan.2.a
		log = "[GetDateText]: [This.GetName]: taiwan.2.a executed"
		subtract_from_variable = {
			var = treasury
			value = 0.13
		}
		add_manpower = -14
		598 = { damage_building = { type = infrastructure damage = 0.2 } damage_building = { type = industrial_complex damage = 0.3 } }
		600 = { damage_building = { type = infrastructure damage = 0.2 } damage_building = { type = industrial_complex damage = 0.3 } }
		hidden_effect = { CHI = { country_event = { id = china.4 days = 2 } } }
	}
}

### 2000 presidential election

country_event = {

	id = taiwan.3
	immediate = {log = "[GetDateText]: [Root.GetName]: event taiwan.3"}
	title = taiwan.3.t
	desc = taiwan.3.d
	picture = GFX_TAI_taiwan

	fire_only_once = yes

	is_triggered_only = yes

	trigger = {
		tag = TAI
		date > 2000.1.1
		date < 2001.1.1
	}

	option = {
		name = taiwan.3.a
		log = "[GetDateText]: [This.GetName]: taiwan.3.a executed"
		set_politics = {
			ruling_party = democratic
			elections_allowed = yes
		}
	}
	option = {
		name = taiwan.3.b
		log = "[GetDateText]: [This.GetName]: taiwan.3.b executed"
		create_country_leader = {
			name = "Lien Chan"
			desc = ""
			picture = "Lien_Chan.dds"
			expire = "2055.1.1"
			ideology = Neutral_conservatism
			traits = {

			}
		}
	}
	option = {
		name = taiwan.3.c
		log = "[GetDateText]: [This.GetName]: taiwan.3.c executed"
		create_country_leader = {
			name = "James Soong"
			desc = ""
			picture = "James_Soong.dds"
			expire = "2055.1.1"
			ideology = Neutral_conservatism
			traits = {

			}
		}
	}
}

### Coast Guard created

country_event = {
	id = taiwan.4
	immediate = {log = "[GetDateText]: [Root.GetName]: event taiwan.4"}

	title = taiwan.4.t
	desc = taiwan.4.d
	picture = GFX_TAI_coast_guard

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = taiwan.4.a
		log = "[GetDateText]: [This.GetName]: taiwan.4.a executed"
		navy_experience = 5
	}
}

### National University of Kaohsiung

country_event = {
	id = taiwan.5
	immediate = {log = "[GetDateText]: [Root.GetName]: event taiwan.5"}

	title = taiwan.5.t
	desc = taiwan.5.d
	picture = GFX_TAI_kaoshiung_university

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = taiwan.5.a
		log = "[GetDateText]: [This.GetName]: taiwan.5.a executed"
		### TODO research bonus for industry
	}
}

### CSSTA passed
news_event = {
	id = taiwan.6
	immediate = {log = "[GetDateText]: [Root.GetName]: event taiwan.6"}

	title = taiwan.6.t
	desc = taiwan.6.d
	picture = GFX_news_press_conference

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = taiwan.6.a
		log = "[GetDateText]: [This.GetName]: taiwan.6.a executed"
	}
}

### The Sunflower Movement
news_event = {
	id = taiwan.7
	immediate = {log = "[GetDateText]: [Root.GetName]: event taiwan.7"}

	title = taiwan.7.t
	desc = taiwan.7.d
	picture = GFX_news_election_rally

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = taiwan.7.a
		log = "[GetDateText]: [This.GetName]: taiwan.7.a executed"
	}
}

### CSSTA passed
country_event = {
	id = taiwan.8
	immediate = {log = "[GetDateText]: [Root.GetName]: event taiwan.8"}

	title = taiwan.8.t
	desc = taiwan.8.d
	picture = GFX_political_deal

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = taiwan.8.a
		add_opinion_modifier = {
			target = CHI
			modifier = CSSTA
		}
		add_opinion_modifier = {
			target = CHI
			modifier = large_commercial_relations
		}
		custom_effect_tooltip = TAI_influence_CHI_tt
				hidden_effect = {
					set_temp_variable = { influence_gain = 20 }
					for_loop_effect = {
						end = influence_array^num
						value = v
						if = {
							limit = {
								check_variable = { influence_array^v = CHI }
							}
							add_to_variable = { influence_array_val^v = influence_gain }
							set_country_flag = found
						}
					}
					if = {
						limit = { NOT = { has_country_flag = found } }
							add_to_array = { influence_array = CHI.id }
							add_to_array = { influence_array_val = influence_gain }
					}
					clr_country_flag = found
					recalculate_influence = yes
				}
		CHI = {
			add_opinion_modifier = {
				target = TAI
				modifier = CSSTA
			}
			add_opinion_modifier = {
				target = TAI
				modifier = large_commercial_relations
			}
		}
		log = "[GetDateText]: [This.GetName]: taiwan.8.a executed"
	}
}

### The Sunflower Movement
country_event = {
	id = taiwan.9
	immediate = {log = "[GetDateText]: [Root.GetName]: event taiwan.9"}

	title = taiwan.9.t
	desc = taiwan.9.d
	picture = GFX_politics_protest

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = taiwan.9.a
		add_political_power = -100
		add_timed_idea = {
			idea = legislative_yuan_occupied
			days = 30
		}
		log = "[GetDateText]: [This.GetName]: taiwan.9.a executed"
	}
}

#The PRC's "Roadmap to Reunification" Released
country_event = {
	id = taiwan.10
	title = taiwan.10.t
	desc = taiwan.10.d
	
	picture = GFX_politics_negotiations
	
	is_triggered_only = yes
		
	option = {
		name = taiwan.10.a
		set_country_flag = accepted_roadmap
		log = "[GetDateText]: [This.GetName]: taiwan.10.a executed"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 2
				TAI = {
							set_temp_variable = { temp_idx = -1 }
							any_of = {
								array = influence_array
								value = v
								index = i
								if = {
									limit = { var:v = { tag = CHI } }
									set_temp_variable = { temp_idx = i }
									always = yes
								}
								else = { always = no }
							}
							check_variable = { temp_idx > -1 }
							check_variable = { influence_array_calc^temp_idx > 0.3 }
				}
			}
			modifier = {
				factor = 2
				TAI = {
							set_temp_variable = { temp_idx = -1 }
							any_of = {
								array = influence_array
								value = v
								index = i
								if = {
									limit = { var:v = { tag = CHI } }
									set_temp_variable = { temp_idx = i }
									always = yes
								}
								else = { always = no }
							}
							check_variable = { temp_idx > -1 }
							check_variable = { influence_array_calc^temp_idx > 0.4 }
				}
			}
			modifier = {
				factor = 5
				OR = {
					is_in_array = { ruling_party = 1 }
					is_in_array = { ruling_party = 6 }
					is_in_array = { ruling_party = 14 }
				}
			}
			modifier = {
				factor = 10
				if = {
					limit = { has_government = communism }
					TAI = { has_government = communism }
				}
				else_if = {
					limit = { has_government = democratic }
					TAI = { has_government = democratic }
				}
				else_if = {
					limit = { has_government = neutrality }
					TAI = { has_government = neutrality }
				}
				else_if = {
					limit = { has_government = nationalist }
					TAI = { has_government = nationalist }
				}
				else_if = {
					limit = { has_government = fascism }
					TAI = { has_government = fascism }
				}
			}
			modifier = {
				factor = 2
				TAI = { 
					has_opinion = {
						target = CHI
						value > 0
					}
				}
			}
			modifier = {
				factor = 2
				TAI = { 
					has_opinion = {
						target = CHI
						value > 24
					}
				}
			}
			modifier = {
				factor = 2
				TAI = { 
					has_opinion = {
						target = CHI
						value > 49
					}
				}
			}
		}
	}
	option = {
		name = taiwan.10.b	
		set_country_flag = rejected_roadmap		
		log = "[GetDateText]: [This.GetName]: taiwan.10.b executed"
		ai_chance = {
			factor = 25
		}
	}
}

### Suspicious Chinese intelligence activity
country_event = {
	id = taiwan.11
	immediate = {log = "[GetDateText]: [Root.GetName]: event taiwan.11"}

	title = taiwan.11.t
	desc = taiwan.11.d
	picture = GFX_politics_eye

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = taiwan.11.a #Seems harmless
		set_variable = {
			var = TAI_preparations
			value = 0
		}
		log = "[GetDateText]: [This.GetName]: taiwan.11.a executed"
	}
	
	option = {
		name = taiwan.11.b #We should investigate
		add_political_power = -100
		set_variable = {
			var = TAI_preparations
			value = 5
		}
		set_country_flag = TAI_investigated_suspicious_activity
		log = "[GetDateText]: [This.GetName]: taiwan.11.b executed"
	}
}

### Betrayed!
news_event = {
	id = taiwan.12
	immediate = {log = "[GetDateText]: [Root.GetName]: event taiwan.12"}

	title = taiwan.12.t
	desc = taiwan.12.d
	picture = GFX_generic_soldiers

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = taiwan.12.a
		effect_tooltip = {
			TAI = {
				activate_mission = prevent_coup_taiwan
				add_timed_idea = {
					idea = taiwanese_coup
					days = 14
				}
			}
		}
		log = "[GetDateText]: [This.GetName]: taiwan.12.a executed"
	}
}

### The coup succeeds
news_event = {
	id = taiwan.13
	immediate = {log = "[GetDateText]: [Root.GetName]: event taiwan.13"}

	title = taiwan.13.t
	desc = taiwan.13.d
	picture = GFX_generic_soldiers

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = taiwan.13.a
		log = "[GetDateText]: [This.GetName]: taiwan.13.a executed"
	}
}

### The coup fails!
news_event = {
	id = taiwan.14
	immediate = {log = "[GetDateText]: [Root.GetName]: event taiwan.14"}

	title = taiwan.14.t
	desc = taiwan.14.d
	picture = GFX_generic_soldiers

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = taiwan.14.a
		trigger = { NOT = { original_tag = CHI } }
		log = "[GetDateText]: [This.GetName]: taiwan.14.a executed"
	}
	
	option = {
		name = taiwan.14.b
		trigger = { original_tag = CHI }
		log = "[GetDateText]: [This.GetName]: taiwan.14.b executed"
	}
}