algeria_update_casablanca_accords_acceptance = {
	#Morocco
	set_variable = { Morocco_acceptance = 0 }
	if = {
		limit = { MOR = { is_subject_of = ROOT } }
		set_variable = { Morocco_acceptance = 100 }
	}
	else = {
		if = {
			limit = { has_country_flag = algeria_western_sahara_peace_plan_annexation }
			add_to_variable = { Morocco_acceptance = 95 }
		}
		else_if = {
			limit = { has_country_flag = algeria_western_sahara_peace_plan_autonomy }
			add_to_variable = { Morocco_acceptance = 40 }
		}
		else_if = {
			limit = { has_country_flag = algeria_western_sahara_peace_plan_independence }
			add_to_variable = { Morocco_acceptance = 5 }
		}
		else_if = {
			limit = { has_country_flag = algeria_western_sahara_peace_plan_mauritania }
			add_to_variable = { Morocco_acceptance = 5 }
		}
		if = {
			limit = {
				is_in_array = {
					array = MOR.influence_array
					value = ROOT.id
				}
			}
			for_each_loop = {
				array = MOR.influence_array
				index = i
				if = {
					limit = { check_variable = { MOR.influence_array^i = ROOT.id } }
					add_to_variable = { ROOT.Morocco_acceptance = MOR.influence_array_val^i }
				}
			}
		}
		if = {
			limit = {
				MOR = {
					has_opinion = {
						target = ROOT
						value > 150
					}
				}
			}
			multiply_variable = { Morocco_acceptance = 1.3 }
		}
		else_if = {
			limit = {
				MOR = {
					has_opinion = {
						target = ROOT
						value > 100
					}
				}
			}
			multiply_variable = { Morocco_acceptance = 1.2 }
		}
		else_if = {
			limit = {
				MOR = {
					has_opinion = {
						target = ROOT
						value > 50
					}
				}
			}
			multiply_variable = { Morocco_acceptance = 1.1 }
		}
		if = {
			limit = {
				OR = {
					AND = {
						ROOT = { has_government = democratic }
						MOR = { has_government = democratic }
					}
					AND = {
						ROOT = { has_government = communism }
						MOR = { has_government = communism }
					}
					AND = {
						ROOT = { has_government = fascism }
						MOR = { has_government = fascism }
					}
					AND = {
						ROOT = { has_government = neutrality }
						MOR = { has_government = neutrality }
					}
					AND = {
						ROOT = { has_government = nationalist }
						MOR = { has_government = nationalist }
					}
				}
			}
			multiply_variable = { Morocco_acceptance = 1.2 }
		}
		clamp_variable = {
			var = Morocco_acceptance
			max = 100
		}
		set_variable = { Morocco_acceptance_neg = 100 }
		subtract_from_variable = { Morocco_acceptance_neg = Morocco_acceptance }
	}
	#Sahrawi
	set_variable = { Sahrawi_acceptance = 0 }
	if = {
		limit = { SHA = { is_subject_of = ROOT } }
		set_variable = { Sahrawi_acceptance = 100 }
	}
	else = {
		if = {
			limit = { has_country_flag = algeria_western_sahara_peace_plan_annexation }
			add_to_variable = { Sahrawi_acceptance = 5 }
		}
		else_if = {
			limit = { has_country_flag = algeria_western_sahara_peace_plan_autonomy }
			add_to_variable = { Sahrawi_acceptance = 20 }
		}
		else_if = {
			limit = { has_country_flag = algeria_western_sahara_peace_plan_independence }
			add_to_variable = { Sahrawi_acceptance = 95 }
		}
		else_if = {
			limit = { has_country_flag = algeria_western_sahara_peace_plan_mauritania }
			add_to_variable = { Sahrawi_acceptance = 5 }
		}
		if = {
			limit = {
				is_in_array = {
					array = SHA.influence_array
					value = ROOT.id
				}
			}
			for_each_loop = {
				array = SHA.influence_array
				index = i
				if = {
					limit = { check_variable = { MOR.influence_array^i = ROOT.id } }
					add_to_variable = { ROOT.Sahrawi_acceptance = SHA.influence_array_val^i }
				}
			}
		}
		if = {
			limit = {
				SHA = {
					has_opinion = {
						target = ROOT
						value > 150
					}
				}
			}
			multiply_variable = { Sahrawi_acceptance = 1.3 }
		}
		else_if = {
			limit = {
				SHA = {
					has_opinion = {
						target = ROOT
						value > 100
					}
				}
			}
			multiply_variable = { Sahrawi_acceptance = 1.2 }
		}
		else_if = {
			limit = {
				SHA = {
					has_opinion = {
						target = ROOT
						value > 50
					}
				}
			}
			multiply_variable = { Sahrawi_acceptance = 1.1 }
		}
		if = {
			limit = {
				OR = {
					AND = {
						ROOT = { has_government = democratic }
						SHA = { has_government = democratic }
					}
					AND = {
						ROOT = { has_government = communism }
						SHA = { has_government = communism }
					}
					AND = {
						ROOT = { has_government = fascism }
						SHA = { has_government = fascism }
					}
					AND = {
						ROOT = { has_government = neutrality }
						SHA = { has_government = neutrality }
					}
					AND = {
						ROOT = { has_government = nationalist }
						SHA = { has_government = nationalist }
					}
				}
			}
			multiply_variable = { Sahrawi_acceptance = 1.2 }
		}
		clamp_variable = {
			var = Sahrawi_acceptance
			max = 100
		}
		set_variable = { Sahrawi_acceptance_neg = 100 }
		subtract_from_variable = { Sahrawi_acceptance_neg = Sahrawi_acceptance }
	}
	#Libya
	set_variable = { Libya_acceptance = 0 }
	if = {
		limit = { LBA = { is_subject_of = ROOT } }
		set_variable = { Libya_acceptance = 100 }
	}
	else = {
		if = {
			limit = { has_country_flag = algeria_western_sahara_peace_plan_annexation }
			add_to_variable = { Libya_acceptance = 10 }
		}
		else_if = {
			limit = { has_country_flag = algeria_western_sahara_peace_plan_autonomy }
			add_to_variable = { Libya_acceptance = 30 }
		}
		else_if = {
			limit = { has_country_flag = algeria_western_sahara_peace_plan_independence }
			add_to_variable = { Libya_acceptance = 80 }
		}
		else_if = {
			limit = { has_country_flag = algeria_western_sahara_peace_plan_mauritania }
			add_to_variable = { Libya_acceptance = 15 }
		}
		if = {
			limit = {
				is_in_array = {
					array = LBA.influence_array
					value = ROOT.id
				}
			}
			for_each_loop = {
				array = LBA.influence_array
				index = i
				if = {
					limit = { check_variable = { LBA.influence_array^i = ROOT.id } }
					add_to_variable = { ROOT.Libya_acceptance = LBA.influence_array_val^i }
				}
			}
		}
		if = {
			limit = {
				LBA = {
					has_opinion = {
						target = ROOT
						value > 150
					}
				}
			}
			multiply_variable = { Libya_acceptance = 1.3 }
		}
		else_if = {
			limit = {
				LBA = {
					has_opinion = {
						target = ROOT
						value > 100
					}
				}
			}
			multiply_variable = { Libya_acceptance = 1.2 }
		}
		else_if = {
			limit = {
				LBA = {
					has_opinion = {
						target = ROOT
						value > 50
					}
				}
			}
			multiply_variable = { Libya_acceptance = 1.1 }
		}
		if = {
			limit = {
				OR = {
					AND = {
						ROOT = { has_government = democratic }
						LBA = { has_government = democratic }
					}
					AND = {
						ROOT = { has_government = communism }
						LBA = { has_government = communism }
					}
					AND = {
						ROOT = { has_government = fascism }
						LBA = { has_government = fascism }
					}
					AND = {
						ROOT = { has_government = neutrality }
						LBA = { has_government = neutrality }
					}
					AND = {
						ROOT = { has_government = nationalist }
						LBA = { has_government = nationalist }
					}
				}
			}
			multiply_variable = { Libya_acceptance = 1.2 }
		}
		clamp_variable = {
			var = Libya_acceptance
			max = 100
		}
		set_variable = { Libya_acceptance_neg = 100 }
		subtract_from_variable = { Libya_acceptance_neg = Libya_acceptance }
	}
	#Mauritania
	set_variable = { Mauritania_acceptance = 0 }
	if = {
		limit = { MAU = { is_subject_of = ROOT } }
		set_variable = { Mauritania_acceptance = 100 }
	}
	else = {
		if = {
			limit = { has_country_flag = algeria_western_sahara_peace_plan_annexation }
			add_to_variable = { Mauritania_acceptance = 50 }
		}
		else_if = {
			limit = { has_country_flag = algeria_western_sahara_peace_plan_autonomy }
			add_to_variable = { Mauritania_acceptance = 50 }
		}
		else_if = {
			limit = { has_country_flag = algeria_western_sahara_peace_plan_independence }
			add_to_variable = { Mauritania_acceptance = 50 }
		}
		else_if = {
			limit = { has_country_flag = algeria_western_sahara_peace_plan_mauritania }
			if = {
				limit = { MAU = { has_government = nationalist } }
				add_to_variable = { Mauritania_acceptance = 100 }
			}
			else = {
				add_to_variable = { Mauritania_acceptance = 10 }
			}
		}
		if = {
			limit = {
				is_in_array = {
					array = MAU.influence_array
					value = ROOT.id
				}
			}
			for_each_loop = {
				array = MAU.influence_array
				index = i
				if = {
					limit = { check_variable = { MAU.influence_array^i = ROOT.id } }
					add_to_variable = { ROOT.Mauritania_acceptance = MAU.influence_array_val^i }
				}
			}
		}
		if = {
			limit = {
				MAU = {
					has_opinion = {
						target = ROOT
						value > 150
					}
				}
			}
			multiply_variable = { Mauritania_acceptance = 1.3 }
		}
		else_if = {
			limit = {
				MAU = {
					has_opinion = {
						target = ROOT
						value > 100
					}
				}
			}
			multiply_variable = { Mauritania_acceptance = 1.2 }
		}
		else_if = {
			limit = {
				MAU = {
					has_opinion = {
						target = ROOT
						value > 50
					}
				}
			}
			multiply_variable = { Mauritania_acceptance = 1.1 }
		}
		if = {
			limit = {
				OR = {
					AND = {
						ROOT = { has_government = democratic }
						MAU = { has_government = democratic }
					}
					AND = {
						ROOT = { has_government = communism }
						MAU = { has_government = communism }
					}
					AND = {
						ROOT = { has_government = fascism }
						MAU = { has_government = fascism }
					}
					AND = {
						ROOT = { has_government = neutrality }
						MAU = { has_government = neutrality }
					}
					AND = {
						ROOT = { has_government = nationalist }
						MAU = { has_government = nationalist }
					}
				}
			}
			multiply_variable = { Mauritania_acceptance = 1.2 }
		}
		clamp_variable = {
			var = Mauritania_acceptance
			max = 100
		}
		set_variable = { Mauritania_acceptance_neg = 100 }
		subtract_from_variable = { Mauritania_acceptance_neg = Mauritania_acceptance }
	}
}
# PRODUCTIVITY GROWTH
update_ALG_productivity_cost = {
	custom_effect_tooltip = ALG_productivity_cost_tt
	add_to_variable = { ALG_productivity_growth = ALG_productivity_cost_change }
}
# SANCTIONS #
update_ALG_sanction_trade_opinion_factor = {
	custom_effect_tooltip = ALG_sanction_trade_opinion_factor_tt
	add_to_variable = { ALG_sanction_trade_opinion_factor = ALG_sanction_trade_opinion_factor_change }
}
update_ALG_sanction_oil_export_multiplier_modifier = {
	custom_effect_tooltip = ALG_sanction_oil_export_multiplier_modifier_tt
	add_to_variable = { ALG_sanction_oil_export_multiplier_modifier = ALG_sanction_oil_export_multiplier_modifier_change }
}
update_ALG_sanction_trade_laws_cost_factor = {
	custom_effect_tooltip = ALG_sanction_trade_laws_cost_factor_tt
	add_to_variable = { ALG_sanction_trade_laws_cost_factor = ALG_sanction_trade_laws_cost_factor_change }
}
update_ALG_sanction_improve_relations_maintain_cost_factor = {
	custom_effect_tooltip = ALG_sanction_improve_relations_maintain_cost_factor_tt
	add_to_variable = { ALG_sanction_improve_relations_maintain_cost_factor = ALG_sanction_improve_relations_maintain_cost_factor_change }
}
update_ALG_sanction_productivity_growth_modifier = {
	custom_effect_tooltip = ALG_sanction_productivity_growth_modifier_tt
	add_to_variable = { ALG_sanction_productivity_growth_modifier = ALG_sanction_productivity_growth_modifier_change }
}
update_ALG_sanction_stability_factor = {
	custom_effect_tooltip = ALG_sanction_stability_factor_tt
	add_to_variable = { ALG_sanction_stability_factor = ALG_sanction_stability_factor_change }
}
ALG_minister_clear = {
    clr_country_flag = ALG_sellal_minister
    clr_country_flag = ALG_ouyahia_minister
    clr_country_flag = ALG_bedoui_minister
}
# Constitution #
alg_increase_reform = {
	custom_effect_tooltip = alg_increase_reform_tt
	add_to_variable = { algeria_constitution_reform = 1 }
}

alg_decrease_reform = {
	custom_effect_tooltip = alg_decrease_reform_tt
	add_to_variable = { algeria_constitution_reform = -1 }
}

ALG_modify_ALG_productivity_growth_modifier_pvda_effect = {
	custom_effect_tooltip = ALG_productivity_growth_modifier_pvda_tt
	add_to_variable = {
		ALG_productivity_growth_modifier_pvda = ALG_productivity_growth_modifier_pvda_change
	}
}
ALG_modify_ALG_recruitable_population_factor_pvda_effect = {
	custom_effect_tooltip = ALG_recruitable_population_factor_pvda_tt
	add_to_variable = {
		ALG_recruitable_population_factor_pvda = ALG_recruitable_population_factor_pvda_change
	}
}
update_ALG_bureaucracy_cost_multiplier_modifier = {
	custom_effect_tooltip = ALG_bureaucracy_cost_multiplier_modifier_tt
	add_to_variable = { ALG_bureaucracy_cost_multiplier_modifier = ALG_bureaucracy_cost_multiplier_modifier_change }
}
ALG_increase_desertification = {
	if = {
		limit = { has_idea = ALG_sahara_expansion_1 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_2
			remove_idea = ALG_sahara_expansion_1
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_2 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_3
			remove_idea = ALG_sahara_expansion_2
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_3 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_4
			remove_idea = ALG_sahara_expansion_3
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_4 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_5
			remove_idea = ALG_sahara_expansion_4
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_5 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_6
			remove_idea = ALG_sahara_expansion_5
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_6 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_7
			remove_idea = ALG_sahara_expansion_6
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_7 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_8
			remove_idea = ALG_sahara_expansion_7
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_8 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_9
			remove_idea = ALG_sahara_expansion_8
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_9 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_10
			remove_idea = ALG_sahara_expansion_9
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_10 }
		add_political_power = -200
	}
}

ALG_decrease_desertification = {
	if = {
		limit = { has_idea = ALG_sahara_expansion_1 }
		add_political_power = 200
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_2 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_1
			remove_idea = ALG_sahara_expansion_2
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_3 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_2
			remove_idea = ALG_sahara_expansion_3
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_4 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_3
			remove_idea = ALG_sahara_expansion_4
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_5 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_4
			remove_idea = ALG_sahara_expansion_5
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_6 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_5
			remove_idea = ALG_sahara_expansion_6
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_7 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_6
			remove_idea = ALG_sahara_expansion_7
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_8 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_7
			remove_idea = ALG_sahara_expansion_8
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_9 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_8
			remove_idea = ALG_sahara_expansion_9
		}
	}
	else_if = {
		limit = { has_idea = ALG_sahara_expansion_10 }
		swap_ideas = {
			add_idea = ALG_sahara_expansion_9
			remove_idea = ALG_sahara_expansion_10
		}
	}
}

ALG_increase_desertification_rate = {
	if = {
		limit = {
			check_variable = { sahara_retreats > 4 }
		}
		custom_effect_tooltip = ALG_increase_yearly_bad_desertification_5
		add_to_variable = { sahara_expands = 5 }
		custom_effect_tooltip = ALG_reduce_yearly_good_desertification_5
		subtract_from_variable = { sahara_retreats = 5 }
	}
	else_if = {
		limit = {
			check_variable = { sahara_steady > 4 }
		}
		custom_effect_tooltip = ALG_increase_yearly_bad_desertification_5
		add_to_variable = { sahara_expands = 5 }
		custom_effect_tooltip = ALG_reduce_yearly_neutral_desertification_5
		subtract_from_variable = { sahara_steady = 5 }
	}
	else = {
		add_political_power = -200
	}
}

ALG_decrease_desertification_rate = {
	if = {
		limit = {
			check_variable = { sahara_steady < 30 }
		}
		custom_effect_tooltip = ALG_decrease_yearly_bad_desertification_5
		subtract_from_variable = { sahara_expands = 5 }
		custom_effect_tooltip = ALG_increase_yearly_neutral_desertification_5
		add_to_variable = { sahara_steady = 5 }
	}
	else_if = {
		limit = {
			check_variable = { sahara_retreats < 70 }
		}
		custom_effect_tooltip = ALG_decrease_yearly_bad_desertification_5
		subtract_from_variable = { sahara_expands = 5 }
		custom_effect_tooltip = ALG_increase_yearly_good_desertification_5
		add_to_variable = { sahara_retreats = 5 }
	}
	else = {
		add_political_power = 200
	}
}
ALG_update_anti_poaching = {
	# From internal security level
	if = {
		limit = { has_idea = police_01 }
		set_variable = { chance_to_kill_poachers = 15 }
	}
	else_if = {
		limit = { has_idea = police_02 }
		set_variable = { chance_to_kill_poachers = 30 }
	}
	else_if = {
		limit = { has_idea = police_03 }
		set_variable = { chance_to_kill_poachers = 45 }
	}
	else_if = {
		limit = { has_idea = police_04 }
		set_variable = { chance_to_kill_poachers = 60 }
	}
	else_if = {
		limit = { has_idea = police_05 }
		set_variable = { chance_to_kill_poachers = 75 }
	}

	# From hiring extra security
	if = {
		limit = { has_decision = ALG_anti_poaching_extra_security }
		add_to_variable = { chance_to_kill_poachers = 10 }
	}

	clamp_variable = { var = chance_to_kill_poachers max = 100 }
	set_variable = { chance_to_not_kill_poachers = 100 }
	subtract_from_variable = { chance_to_not_kill_poachers = chance_to_kill_poachers }

	set_variable = { no_of_poachers_to_kill = 10 }
	if = {
		limit = { has_decision = ALG_anti_poaching_heavy_weapons }
		add_to_variable = { no_of_poachers_to_kill = 5 }
	}
	if = {
		limit = { has_idea = ALG_army_against_poaching }
		add_to_variable = { no_of_poachers_to_kill = 5 }
	}
}
