scripted_gui = {
	MD_missiles_stateview_gui = {
		window_name = "missiles_stateview_window_container"

		context_type = selected_state_context
		parent_window_token = selected_state_view

		visible = {
			#has_dlc = "La Resistance"
			#has_country_flag = open_MD_countrymissilesview
			always = yes
		}

		effects = {
			MD_missiles_ground_launch_button_click = {
				ROOT = {
					set_country_flag = search_target_point
					add_to_array = {
						array = missile_launch_point_array
						value = PREV.id
					}
					add_to_variable = {
						var_missile_trajectory_ID = 1
					}
				}
			}
			MD_missiles_sea_launch_button_click = {
				ROOT = {
					set_country_flag = search_target_point
					add_to_array = {
						array = missile_launch_point_array
						value = PREV.id
					}
					add_to_variable = {
						var_missile_trajectory_ID = 1
					}
				}
			}
			MD_missiles_air_launch_button_click = {
				ROOT = {
					set_country_flag = search_target_point
					add_to_array = {
						array = missile_launch_point_array
						value = PREV.id
					}
					add_to_variable = {
						var_missile_trajectory_ID = 1
					}
				}
			}
			MD_missiles_target_button_click = {
				ROOT = {
					set_country_flag = has_trajectory
					clr_country_flag = search_target_point
					add_to_array = {
						array = missile_target_point_array
						value = PREV.id
						index = var_missile_trajectory_ID
					}
				}	
				controller = {
					add_to_array = {
						array = ROOT.missile_target_controller_array
						value = THIS
						index = ROOT.var_missile_trajectory_ID
					}
				}
			}
		}

		triggers = {
			MD_missiles_target_button_click_enabled = {
				ROOT = { has_country_flag = search_target_point }
			}
			MD_missiles_ground_launch_button_click_enabled = {
				ROOT = {
					OR = {
						### ICBM ###
						AND = {
							check_variable = { var_gui_missile_type > 10 }
							check_variable = { var_gui_missile_type < 20 }
						}
						### IRBM ###
						AND = {
							check_variable = { var_gui_missile_type > 20 }
							check_variable = { var_gui_missile_type < 30 }
						}
						### GLCM ###
						AND = {
							check_variable = { var_gui_missile_type > 50 }
							check_variable = { var_gui_missile_type < 60 }
						}
						### HSCM ### trigger for GLCM mod to add
						AND = {
							check_variable = { var_gui_missile_type > 70 }
							check_variable = { var_gui_missile_type < 80 }
						}										
					}
				}
				ROOT = { NOT = { has_country_flag = search_target_point } }
			}
			MD_missiles_sea_launch_button_click_enabled = {
				ROOT = {
					OR = {
						### SLBM ###
						AND = {
							check_variable = { var_gui_missile_type > 30 }
							check_variable = { var_gui_missile_type < 40 }
						}
						### SLCM ###
						AND = {
							check_variable = { var_gui_missile_type > 60 }
							check_variable = { var_gui_missile_type < 70 }
						}
						### HSCM ### trigger for SLCM mod to add
						AND = {
							check_variable = { var_gui_missile_type > 70 }
							check_variable = { var_gui_missile_type < 80 }
						}
					}
				}
				ROOT = { NOT = { has_country_flag = search_target_point } }
			}
			MD_missiles_air_launch_button_click_enabled = {
				ROOT = {
					OR = {
						### ALCM ###
						AND = {
							check_variable = { var_gui_missile_type > 40 }
							check_variable = { var_gui_missile_type < 50 }
						}
						### HSCM ### trigger for ALCM mod to add
						AND = {
							check_variable = { var_gui_missile_type > 70 }
							check_variable = { var_gui_missile_type < 80 }
						}
					}
				}
				ROOT = { NOT = { has_country_flag = search_target_point } }
			}
		}

	}

	MD_missiles_gui = {
		window_name = MD_countrymissilesview
		context_type = player_context
		parent_window_token = topbar #after_intel_agency_button #country_menu_window ### idk if that is correct???
		 
		visible = {
			#has_dlc = "La Resistance"
			has_country_flag = open_MD_countrymissilesview
		}
		
		effects = {
			close_button_click = {
				clr_country_flag = open_MD_countrymissilesview
				clr_country_flag = open_MD_target_selection_view
				if = {
					limit = {
						has_country_flag = open_MD_missile_stat_view
					}
					clr_country_flag = open_MD_missile_stat_view
				}
				if = {
					limit = {
						has_country_flag = open_MD_missile_type_window
					}
					clr_country_flag = open_MD_missile_type_window
				}				
			}
			missiles_gui_ledger_btn_1_click = {
				set_variable = { var_open_MD_missiles_gui_ledger_1 = 2 }
				clear_variable = var_open_MD_missiles_gui_ledger_2
				clear_variable = var_open_MD_missiles_gui_ledger_3
				clear_variable = var_open_MD_missiles_gui_ledger_4
				#set_country_flag = open_MD_missiles_gui_ledger_1
				#clr_country_flag = open_MD_missiles_gui_ledger_2
				#clr_country_flag = open_MD_missiles_gui_ledger_3
				#clr_country_flag = open_MD_missiles_gui_ledger_4
			}
			missiles_gui_ledger_btn_2_click = {
				set_variable = { var_open_MD_missiles_gui_ledger_2 = 2 }
				clear_variable = var_open_MD_missiles_gui_ledger_1
				clear_variable = var_open_MD_missiles_gui_ledger_3
				clear_variable = var_open_MD_missiles_gui_ledger_4
				#set_country_flag = open_MD_missiles_gui_ledger_2
				#clr_country_flag = open_MD_missiles_gui_ledger_1
				#clr_country_flag = open_MD_missiles_gui_ledger_3
				#clr_country_flag = open_MD_missiles_gui_ledger_4
			}
			missiles_gui_ledger_btn_3_click = {
				set_variable = { var_open_MD_missiles_gui_ledger_3 = 2 }
				clear_variable = var_open_MD_missiles_gui_ledger_1
				clear_variable = var_open_MD_missiles_gui_ledger_2
				clear_variable = var_open_MD_missiles_gui_ledger_4
				#set_country_flag = open_MD_missiles_gui_ledger_3
				#clr_country_flag = open_MD_missiles_gui_ledger_1
				#clr_country_flag = open_MD_missiles_gui_ledger_2
				#clr_country_flag = open_MD_missiles_gui_ledger_4
			}
			missiles_gui_ledger_btn_4_click = {
				set_variable = { var_open_MD_missiles_gui_ledger_4 = 2 }
				clear_variable = var_open_MD_missiles_gui_ledger_1
				clear_variable = var_open_MD_missiles_gui_ledger_2
				clear_variable = var_open_MD_missiles_gui_ledger_3
				#set_country_flag = open_MD_missiles_gui_ledger_4
				#clr_country_flag = open_MD_missiles_gui_ledger_1
				#clr_country_flag = open_MD_missiles_gui_ledger_2
				#clr_country_flag = open_MD_missiles_gui_ledger_3
			}
		}



		properties = {
			missiles_gui_ledger_btn_1 = {
				frame = var_open_MD_missiles_gui_ledger_1
			}
			missiles_gui_ledger_btn_2 = {
				frame = var_open_MD_missiles_gui_ledger_2
			}
			missiles_gui_ledger_btn_3 = {
				frame = var_open_MD_missiles_gui_ledger_3
			}
			missiles_gui_ledger_btn_4 = {
				frame = var_open_MD_missiles_gui_ledger_4
			}
		}
	}

	MD_countrymissilesview_production_gui = {
		window_name = MD_countrymissilesview_production
		context_type = player_context
		parent_window_name = MD_countrymissilesview
		 
		visible = {
			check_variable = { var_open_MD_missiles_gui_ledger_1 = 2 }
			has_country_flag = open_MD_countrymissilesview
		}		
	}

	MD_countrymissilesview_launch_gui = {
		window_name = MD_countrymissilesview_launch
		context_type = player_context
		parent_window_name = MD_countrymissilesview

		visible = {
			check_variable = { var_open_MD_missiles_gui_ledger_2 = 2 }
			has_country_flag = open_MD_countrymissilesview
		}

		effects = {
			target_selection_button_click = {
				set_country_flag = has_targets_selected
				if = {
					limit = {
						has_country_flag = open_MD_target_selection_view
					}
					clr_country_flag = open_MD_target_selection_view
				}
				else = {
					set_country_flag = open_MD_target_selection_view
					set_warhead_targets = yes
				}
			}
			### temp for testing ###
			missile_model_button_click = {
				#set_country_flag = has_missile_model
				#add_to_variable = { var_gui_missile_type = 1 }
				#add_to_variable = { var_gui_missile_tech = 1 }
				### MD_missile_type_window ###
				set_country_flag = open_MD_missile_type_window
			}
			#missile_model_button_right_click = {
			#	subtract_from_variable = { var_gui_missile_type = 1 }
			#	subtract_from_variable = { var_gui_missile_tech = 1 }
			#}
			warhead_button_click = {
				set_country_flag = has_warhead
				add_to_variable = { var_gui_warhead = 1 }
			}
			warhead_button_right_click = {
				subtract_from_variable = { var_gui_warhead = 1 }
			}
			### end of temp for testing ###

			### salvo button effects ###
			salvo_small_plus_button_bg_click = {
				add_to_variable = { var_gui_salvo = 1 }
				set_variable = { var_total_firing = var_gui_salvo }
				multiply_variable = { var_total_firing = var_gui_duration }
			}
			salvo_small_minus_button_bg_click = {
				subtract_from_variable = { var_gui_salvo = 1 }
				if = {
					limit = {
						check_variable = { var_gui_salvo < 0 }
					}
					set_variable = { var_gui_salvo = 0 }
				}
				set_variable = { var_total_firing = var_gui_salvo }
				multiply_variable = { var_total_firing = var_gui_duration }
			}
			salvo_small_plus_button_bg_control_click = {
				add_to_variable = { var_gui_salvo = 10 }
			}
			salvo_small_minus_button_bg_control_click = {
				subtract_from_variable = { var_gui_salvo = 10 }
				if = {
					limit = {
						check_variable = { var_gui_salvo < 0 }
					}
					set_variable = { var_gui_salvo = 0 }
				}
				set_variable = { var_total_firing = var_gui_salvo }
				multiply_variable = { var_total_firing = var_gui_duration }
			}
			salvo_small_plus_button_bg_shift_click = {
				add_to_variable = { var_gui_salvo = 100 }
				set_variable = { var_total_firing = var_gui_salvo }
				multiply_variable = { var_total_firing = var_gui_duration }
			}
			salvo_small_minus_button_bg_shift_click = {
				subtract_from_variable = { var_gui_salvo = 100 }
				if = {
					limit = {
						check_variable = { var_gui_salvo < 0 }
					}
					set_variable = { var_gui_salvo = 0 }
				}
				set_variable = { var_total_firing = var_gui_salvo }
				multiply_variable = { var_total_firing = var_gui_duration }
			}
			### duration button effects ###
			duration_small_plus_button_bg_click = {
				add_to_variable = { var_gui_duration = 1 }
				set_variable = { var_total_firing = var_gui_salvo }
				multiply_variable = { var_total_firing = var_gui_duration }
			}
			duration_small_minus_button_bg_click = {
				subtract_from_variable = { var_gui_duration = 1 }
				if = {
					limit = {
						check_variable = { var_gui_duration < 0 }
					}
					set_variable = { var_gui_duration = 0 }
				}
				set_variable = { var_total_firing = var_gui_salvo }
				multiply_variable = { var_total_firing = var_gui_duration }
			}
			duration_small_plus_button_bg_control_click = {
				add_to_variable = { var_gui_duration = 10 }
			}
			duration_small_minus_button_bg_control_click = {
				subtract_from_variable = { var_gui_duration = 10 }
				if = {
					limit = {
						check_variable = { var_gui_duration < 0 }
					}
					set_variable = { var_gui_duration = 0 }
				}
				set_variable = { var_total_firing = var_gui_salvo }
				multiply_variable = { var_total_firing = var_gui_duration }
			}
			duration_small_plus_button_bg_shift_click = {
				add_to_variable = { var_gui_duration = 100 }
				set_variable = { var_total_firing = var_gui_salvo }
				multiply_variable = { var_total_firing = var_gui_duration }
			}
			duration_small_minus_button_bg_shift_click = {
				subtract_from_variable = { var_gui_duration = 100 }
				if = {
					limit = {
						check_variable = { var_gui_duration < 0 }
					}
					set_variable = { var_gui_duration = 0 }
				}
				set_variable = { var_total_firing = var_gui_salvo }
				multiply_variable = { var_total_firing = var_gui_duration }
			}
			fire_button_click = {
				clr_country_flag = has_trajectory
				clr_country_flag = has_missile_model
				clr_country_flag = has_warhead
				clr_country_flag = has_targets_selected
				clear_variable = var_selected_air_priority_icon_1
				clear_variable = var_selected_air_priority_icon_2
				clear_variable = var_selected_air_priority_icon_3
				clear_variable = var_selected_air_priority_icon_4
				clear_variable = var_selected_air_priority_icon_5
				clear_variable = var_selected_air_priority_icon_6
				clear_variable = var_selected_air_priority_icon_7
				clear_variable = var_selected_air_priority_icon_8
				clear_variable = var_selected_air_priority_icon_9
				clear_variable = var_selected_air_priority_icon_10
				clear_variable = var_selected_air_priority_icon_11
				clear_variable = var_selected_air_priority_icon_12
				clear_variable = var_selected_air_priority_icon_13
				clear_variable = var_selected_air_priority_icon_14
				clear_variable = var_selected_air_priority_icon_15
				clear_variable = var_selected_air_priority_icon_16
				add_to_array = {
					missile_type_array = var_gui_missile_type
					index = var_missile_trajectory_ID
				}
				add_to_array = {
					missile_tech_array = var_gui_missile_tech
					index = var_missile_trajectory_ID
				}
				add_to_array = {
					missile_warhead_array = var_gui_warhead
					index = var_missile_trajectory_ID
				}
				add_to_array = {
					missile_salvo_array = var_gui_salvo
					index = var_missile_trajectory_ID
				}
				add_to_array = {
					missile_duration_array = var_gui_duration
					index = var_missile_trajectory_ID
				}
			}
			missile_stat_button_click = {
				if = {
					limit = {
						has_country_flag = open_MD_missile_stat_view
					}
					clr_country_flag = open_MD_missile_stat_view
				}
				else = {
					set_country_flag = open_MD_missile_stat_view
				}
				### set stats for current ID ###
				set_variable = { var_stat_trajectory_ID = 0 } # var_missile_trajectory_ID
			}
		}

		triggers = {
			fire_button_click_enabled = {
				has_country_flag = has_trajectory
				has_country_flag = has_missile_model
				has_country_flag = has_warhead
				has_country_flag = has_targets_selected
			}
			target_selection_button_click_enabled = {
				has_country_flag = has_trajectory
				has_country_flag = has_missile_model
				has_country_flag = has_warhead
			}
		}
		properties = {
			missile_model_icon = {
				image = "[MD_missile_type_selected_texture]"
			}
		}
		dynamic_lists = {
			trajectory_gridbox = {
				array = missile_launch_point_array
				entry_container = trajectory_list_entry
				change_scope = yes
			}
		}
	}

	MD_target_selection_view_gui = {
		window_name = MD_target_selection_view
		context_type = player_context
		parent_window_name = MD_countrymissilesview_launch

		visible = {
			has_country_flag = open_MD_target_selection_view
		}

		dynamic_lists = {
			missiles_priorities_gridbox = {
				array = global.building_array #missile_launch_point_array
				entry_container = missiles_priority_item
				change_scope = yes
			}
		}

		effects = {
			# building_button_click = {
			#	 meta_effect = {
			#		 text = {
			#			 if = {
			#				 limit = {
			#					 NOT = { check_variable = { var_selected_air_priority_icon = 3 } } #NOT = { check_variable = { selected_air_priority_icon_array^i = 3 } } 
			#					 #check_variable = { target_building_[i]_array^var_missile_trajectory_ID = 1 }
			#				 }
			#				 ROOT = { remove_from_array = { array = target_building_[i]_array value = 1 index = var_missile_trajectory_ID } } #remove_from_array = { array = ROOT.target_building_[i]_array value = 1 index = ROOT.var_missile_trajectory_ID } #
			#				 set_variable = { var_selected_air_priority_icon = 3 }
			#				 #add_to_array = { array = selected_air_priority_icon_array value = 3 index = var_missile_trajectory_ID }
			#			 }
			#			 else = {
			#				 ROOT = { add_to_array = { array = target_building_[i]_array value = 1 index = var_missile_trajectory_ID } } #add_to_array = { array = ROOT.target_building_[i]_array value = 1 index = ROOT.var_missile_trajectory_ID } #
			#				 set_variable = { var_selected_air_priority_icon = 1 }
			#				 #add_to_array = { array = selected_air_priority_icon_array value = 1 index = var_missile_trajectory_ID }
			#			 }
			#		 }
			#		 i = "[?global.building_array^i]"
			#	 }
			# }
			building_button_1_click = {
				if = {
					limit = {
						check_variable = { target_building_1_array^var_missile_trajectory_ID = 1 }
					}
					add_to_array = { array = target_building_1_array value = -1 index = var_missile_trajectory_ID }
				}
				else = {
					add_to_array = { array = target_building_1_array value = 1 index = var_missile_trajectory_ID }
				}
				if = {
					limit = {
						NOT = { check_variable = { var_selected_air_priority_icon_1 = 3 } }
					}
					set_variable = { var_selected_air_priority_icon_1 = 3 }
				}
				else = {
					set_variable = { var_selected_air_priority_icon_1 = 1 }
				}
			}
			building_button_2_click = {
				if = {
					limit = {
						check_variable = { target_building_2_array^var_missile_trajectory_ID = 1 }
					}
					add_to_array = { array = target_building_2_array value = -1 index = var_missile_trajectory_ID }
				}
				else = {
					add_to_array = { array = target_building_2_array value = 1 index = var_missile_trajectory_ID }
				}
				if = {
					limit = {
						NOT = { check_variable = { var_selected_air_priority_icon_2 = 3 } }
					}
					set_variable = { var_selected_air_priority_icon_2 = 3 }
				}
				else = {
					set_variable = { var_selected_air_priority_icon_2 = 1 }
				}
			}
			building_button_3_click = {
				if = {
					limit = {
						check_variable = { target_building_3_array^var_missile_trajectory_ID = 1 }
					}
					add_to_array = { array = target_building_3_array value = -1 index = var_missile_trajectory_ID }
				}
				else = {
					add_to_array = { array = target_building_3_array value = 1 index = var_missile_trajectory_ID }
				}
				if = {
					limit = {
						NOT = { check_variable = { var_selected_air_priority_icon_3 = 3 } }
					}
					set_variable = { var_selected_air_priority_icon_3 = 3 }
				}
				else = {
					set_variable = { var_selected_air_priority_icon_3 = 1 }
				}
			}
			building_button_4_click = {
				if = {
					limit = {
						check_variable = { target_building_4_array^var_missile_trajectory_ID = 1 }
					}
					add_to_array = { array = target_building_4_array value = -1 index = var_missile_trajectory_ID }
				}
				else = {
					add_to_array = { array = target_building_4_array value = 1 index = var_missile_trajectory_ID }
				}
				if = {
					limit = {
						NOT = { check_variable = { var_selected_air_priority_icon_4 = 3 } }
					}
					set_variable = { var_selected_air_priority_icon_4 = 3 }
				}
				else = {
					set_variable = { var_selected_air_priority_icon_4 = 1 }
				}
			}
			building_button_5_click = {
				if = {
					limit = {
						check_variable = { target_building_5_array^var_missile_trajectory_ID = 1 }
					}
					add_to_array = { array = target_building_5_array value = -1 index = var_missile_trajectory_ID }
				}
				else = {
					add_to_array = { array = target_building_5_array value = 1 index = var_missile_trajectory_ID }
				}
				if = {
					limit = {
						NOT = { check_variable = { var_selected_air_priority_icon_5 = 3 } }
					}
					set_variable = { var_selected_air_priority_icon_5 = 3 }
				}
				else = {
					set_variable = { var_selected_air_priority_icon_5 = 1 }
				}
			}
			building_button_6_click = {
				if = {
					limit = {
						check_variable = { target_building_6_array^var_missile_trajectory_ID = 1 }
					}
					add_to_array = { array = target_building_6_array value = -1 index = var_missile_trajectory_ID }
				}
				else = {
					add_to_array = { array = target_building_6_array value = 1 index = var_missile_trajectory_ID }
				}
				if = {
					limit = {
						NOT = { check_variable = { var_selected_air_priority_icon_6 = 3 } }
					}
					set_variable = { var_selected_air_priority_icon_6 = 3 }
				}
				else = {
					set_variable = { var_selected_air_priority_icon_6 = 1 }
				}
			}
			building_button_7_click = {
				if = {
					limit = {
						check_variable = { target_building_7_array^var_missile_trajectory_ID = 1 }
					}
					add_to_array = { array = target_building_7_array value = -1 index = var_missile_trajectory_ID }
				}
				else = {
					add_to_array = { array = target_building_7_array value = 1 index = var_missile_trajectory_ID }
				}
				if = {
					limit = {
						NOT = { check_variable = { var_selected_air_priority_icon_7 = 3 } }
					}
					set_variable = { var_selected_air_priority_icon_7 = 3 }
				}
				else = {
					set_variable = { var_selected_air_priority_icon_7 = 1 }
				}
			}
			building_button_8_click = {
				if = {
					limit = {
						check_variable = { target_building_8_array^var_missile_trajectory_ID = 1 }
					}
					add_to_array = { array = target_building_8_array value = -1 index = var_missile_trajectory_ID }
				}
				else = {
					add_to_array = { array = target_building_8_array value = 1 index = var_missile_trajectory_ID }
				}
				if = {
					limit = {
						NOT = { check_variable = { var_selected_air_priority_icon_8 = 3 } }
					}
					set_variable = { var_selected_air_priority_icon_8 = 3 }
				}
				else = {
					set_variable = { var_selected_air_priority_icon_8 = 1 }
				}
			}
			building_button_9_click = {
				if = {
					limit = {
						check_variable = { target_building_9_array^var_missile_trajectory_ID = 1 }
					}
					add_to_array = { array = target_building_9_array value = -1 index = var_missile_trajectory_ID }
				}
				else = {
					add_to_array = { array = target_building_9_array value = 1 index = var_missile_trajectory_ID }
				}
				if = {
					limit = {
						NOT = { check_variable = { var_selected_air_priority_icon_9 = 3 } }
					}
					set_variable = { var_selected_air_priority_icon_9 = 3 }
				}
				else = {
					set_variable = { var_selected_air_priority_icon_9 = 1 }
				}
			}
			building_button_10_click = {
				if = {
					limit = {
						check_variable = { target_building_10_array^var_missile_trajectory_ID = 1 }
					}
					add_to_array = { array = target_building_10_array value = -1 index = var_missile_trajectory_ID }
				}
				else = {
					add_to_array = { array = target_building_10_array value = 1 index = var_missile_trajectory_ID }
				}
				if = {
					limit = {
						NOT = { check_variable = { var_selected_air_priority_icon_10 = 3 } }
					}
					set_variable = { var_selected_air_priority_icon_10 = 3 }
				}
				else = {
					set_variable = { var_selected_air_priority_icon_10 = 1 }
				}
			}
			building_button_11_click = {
				if = {
					limit = {
						check_variable = { target_building_11_array^var_missile_trajectory_ID = 1 }
					}
					add_to_array = { array = target_building_11_array value = -1 index = var_missile_trajectory_ID }
				}
				else = {
					add_to_array = { array = target_building_11_array value = 1 index = var_missile_trajectory_ID }
				}
				if = {
					limit = {
						NOT = { check_variable = { var_selected_air_priority_icon_11 = 3 } }
					}
					set_variable = { var_selected_air_priority_icon_11 = 3 }
				}
				else = {
					set_variable = { var_selected_air_priority_icon_11 = 1 }
				}
			}
			building_button_12_click = {
				if = {
					limit = {
						check_variable = { target_building_12_array^var_missile_trajectory_ID = 1 }
					}
					add_to_array = { array = target_building_12_array value = -1 index = var_missile_trajectory_ID }
				}
				else = {
					add_to_array = { array = target_building_12_array value = 1 index = var_missile_trajectory_ID }
				}
				if = {
					limit = {
						NOT = { check_variable = { var_selected_air_priority_icon_12 = 3 } }
					}
					set_variable = { var_selected_air_priority_icon_12 = 3 }
				}
				else = {
					set_variable = { var_selected_air_priority_icon_12 = 1 }
				}
			}
			building_button_13_click = {
				if = {
					limit = {
						check_variable = { target_building_13_array^var_missile_trajectory_ID = 1 }
					}
					add_to_array = { array = target_building_13_array value = -1 index = var_missile_trajectory_ID }
				}
				else = {
					add_to_array = { array = target_building_13_array value = 1 index = var_missile_trajectory_ID }
				}
				if = {
					limit = {
						NOT = { check_variable = { var_selected_air_priority_icon_13 = 3 } }
					}
					set_variable = { var_selected_air_priority_icon_13 = 3 }
				}
				else = {
					set_variable = { var_selected_air_priority_icon_13 = 1 }
				}
			}
			building_button_14_click = {
				if = {
					limit = {
						check_variable = { target_building_14_array^var_missile_trajectory_ID = 1 }
					}
					add_to_array = { array = target_building_14_array value = -1 index = var_missile_trajectory_ID }
				}
				else = {
					add_to_array = { array = target_building_14_array value = 1 index = var_missile_trajectory_ID }
				}
				if = {
					limit = {
						NOT = { check_variable = { var_selected_air_priority_icon_14 = 3 } }
					}
					set_variable = { var_selected_air_priority_icon_14 = 3 }
				}
				else = {
					set_variable = { var_selected_air_priority_icon_14 = 1 }
				}
			}
			building_button_15_click = {
				if = {
					limit = {
						check_variable = { target_building_15_array^var_missile_trajectory_ID = 1 }
					}
					add_to_array = { array = target_building_15_array value = -1 index = var_missile_trajectory_ID }
				}
				else = {
					add_to_array = { array = target_building_15_array value = 1 index = var_missile_trajectory_ID }
				}
				if = {
					limit = {
						NOT = { check_variable = { var_selected_air_priority_icon_15 = 3 } }
					}
					set_variable = { var_selected_air_priority_icon_15 = 3 }
				}
				else = {
					set_variable = { var_selected_air_priority_icon_15 = 1 }
				}
			}
			building_button_16_click = {
				if = {
					limit = {
						check_variable = { target_building_16_array^var_missile_trajectory_ID = 1 }
					}
					add_to_array = { array = target_building_16_array value = -1 index = var_missile_trajectory_ID }
				}
				else = {
					add_to_array = { array = target_building_16_array value = 1 index = var_missile_trajectory_ID }
				}
				if = {
					limit = {
						NOT = { check_variable = { var_selected_air_priority_icon_16 = 3 } }
					}
					set_variable = { var_selected_air_priority_icon_16 = 3 }
				}
				else = {
					set_variable = { var_selected_air_priority_icon_16 = 1 }
				}
			}

		}
		triggers = {
			# building_button_click_enabled = {
			#	 meta_trigger = {
			#		 text = {
			#			 if = {
			#				 limit = {
			#					 check_variable = { target_building_[i]_array^var_missile_trajectory_ID = 1 }
			#				 }
			#				 set_temp_variable  = { var_selected_air_priority_icon = 3 }
			#			 }
			#			 else = {
			#				 set_temp_variable = { var_selected_air_priority_icon = 1 }
			#			 }
			#		 }
			#		 i = "[?global.building_array^i]"
			#	 }
			# }
			# building_button_1_click_enabled = {
			#	 if = {
			#		 limit = {
			#			 NOT = { check_variable = { target_building_1_array^var_missile_trajectory_ID = 1 } }
			#		 }
			#		 set_temp_variable  = { var_selected_air_priority_icon_1 = 3 }
			#	 }
			#	 else = {
			#		 set_temp_variable = { var_selected_air_priority_icon_1 = 1 }
			#	 }
			# }
		}
		properties = {
			# building_button = {
			#	 frame = global.building_array^i # frame = global.building_array^i
			# }
			selected_air_priority_icon_1 = {
				frame = var_selected_air_priority_icon_1
			}
			selected_air_priority_icon_2 = {
				frame = var_selected_air_priority_icon_2
			}
			selected_air_priority_icon_3 = {
				frame = var_selected_air_priority_icon_3
			}
			selected_air_priority_icon_4 = {
				frame = var_selected_air_priority_icon_4
			}
			selected_air_priority_icon_5 = {
				frame = var_selected_air_priority_icon_5
			}
			selected_air_priority_icon_6 = {
				frame = var_selected_air_priority_icon_6
			}
			selected_air_priority_icon_7 = {
				frame = var_selected_air_priority_icon_7
			}
			selected_air_priority_icon_8 = {
				frame = var_selected_air_priority_icon_8
			}
			selected_air_priority_icon_9 = {
				frame = var_selected_air_priority_icon_9
			}
			selected_air_priority_icon_10 = {
				frame = var_selected_air_priority_icon_10
			}
			selected_air_priority_icon_11 = {
				frame = var_selected_air_priority_icon_11
			}
			selected_air_priority_icon_12 = {
				frame = var_selected_air_priority_icon_12
			}
			selected_air_priority_icon_13 = {
				frame = var_selected_air_priority_icon_13
			}
			selected_air_priority_icon_14 = {
				frame = var_selected_air_priority_icon_14
			}
			selected_air_priority_icon_15 = {
				frame = var_selected_air_priority_icon_15
			}
			selected_air_priority_icon_16 = {
				frame = var_selected_air_priority_icon_16
			}
		}
	}

	MD_missile_type_window_gui = {
		window_name = MD_missile_type_window
		context_type = player_context
		parent_window_name = MD_countrymissilesview_launch

		visible = {
			has_country_flag = open_MD_missile_type_window
		}

		effects = {
			missile_type_button_click = {
				set_country_flag = has_missile_model
				set_variable = { var_gui_missile_type = missile_type_tech_array^i }
				set_missile_model_gui = yes
				clr_country_flag = open_MD_missile_type_window
				#add_to_variable = { var_gui_missile_tech = 1 }
			}
			close_button_click = {
				if = {
					limit = {
						has_country_flag = open_MD_missile_type_window
					}
					clr_country_flag = open_MD_missile_type_window
				}
			}
		}
		properties = {
			missile_type_icon = {
				image = "[MD_missile_type_tech_icon_texture]"
			}
		}		
		dynamic_lists = {
			missile_types_gridbox = {
				array = missile_type_tech_array # one element per type, value = tech lvl
				entry_container = missile_type_tech_entry
				#change_scope = yes
			}
		}

	}

	MD_missile_stat_view_gui = {
		window_name = MD_missile_stat_view
		context_type = player_context
		parent_window_name = MD_countrymissilesview_launch

		visible = {
			has_country_flag = open_MD_missile_stat_view
		}

		effects = {
			previous_stat_trajectory_button_click = {
				subtract_from_variable = { var_stat_trajectory_ID = 1 }
			}
			next_stat_trajectory_button_click = {
				add_to_variable = { var_stat_trajectory_ID = 1 }
			}
		}

		dynamic_lists = {
			missiles_stat_gridbox = {
				array = global.building_array #missile_launch_point_array
				entry_container = missiles_stat_item
				change_scope = yes
			}
		}

		properties = {
			stat_icon = {
				frame = global.building_array^i
			}
		}
	}

	MD_countrymissilesview_defense_gui = {
		window_name = MD_countrymissilesview_defense
		context_type = player_context
		parent_window_name = MD_countrymissilesview
		 
		visible = {
			check_variable = { var_open_MD_missiles_gui_ledger_3 = 2 }
			has_country_flag = open_MD_countrymissilesview
		}		
	}

	MD_countrymissilesview_satellites_gui = {
		window_name = MD_countrymissilesview_satellites
		context_type = player_context
		parent_window_name = MD_countrymissilesview
		 
		visible = {
			check_variable = { var_open_MD_missiles_gui_ledger_4 = 2 }
			has_country_flag = open_MD_countrymissilesview
		}		
	}

}