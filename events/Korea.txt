add_namespace = korea

### China Demands Our Withdrawal from the Korean Peninsula
country_event = {
	id = korea.1

	title = korea.1.t
	desc = korea.1.d
	picture = GFX_CHI_generic

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = korea.1.a #This demand is ludicrous!
		add_political_power = 25
		ai_chance = {
			factor = 40
		}
		log = "[GetDateText]: [This.GetName]: korea.1.a executed"
	}

	option = {
		name = korea.1.b #It is better for us to concede...
		diplomatic_relation = {
			country = KOR
			relation = guarantee
			active = no
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 20
				USA = {
					set_temp_variable = { temp_idx = -1 }
					any_of = {
						array = influence_array
						value = v
						index = i
						if = {
							limit = { var:v = { tag = CHI } }
							set_temp_variable = { temp_idx = i }
							always = yes
						}
						else = { always = no }
					}
					check_variable = { temp_idx > -1 }
					check_variable = { influence_array_calc^temp_idx > 0.25 }
				}
			}
			modifier = {
				factor = 2
				USA = {
					set_temp_variable = { temp_idx = -1 }
					any_of = {
						array = influence_array
						value = v
						index = i
						if = {
							limit = { var:v = { tag = CHI } }
							set_temp_variable = { temp_idx = i }
							always = yes
						}
						else = { always = no }
					}
					check_variable = { temp_idx > -1 }
					check_variable = { influence_array_calc^temp_idx > 0.4 }
				}
			}
			modifier = {
				factor = 40
				CHI = { has_completed_focus = CHI_End_US_Hegemony }
			}
		}
		log = "[GetDateText]: [This.GetName]: korea.1.b executed"
	}
}

### China is encouraging us to start economic reforms
country_event = {
	id = korea.2

	title = korea.2.t
	desc = korea.2.d
	picture = GFX_united_states_dollar

	fire_only_once = yes

	is_triggered_only = yes

	option = {
		name = korea.2.a #Now is not the time for reform.
		CHI = {
			add_opinion_modifier = {
				target = NKO
				modifier = diplomatic_distance
			}
		}
		ai_chance = {
			factor = 20
			modifier = {
				factor = 2
				has_country_leader = {
					name = "Kim Jong-Un"
					ruling_only = yes
				}
			}
			modifier = {
				factor = 2
				communism > 0.9
			}
		}
		log = "[GetDateText]: [This.GetName]: korea.2.a executed"
	}

	option = {
		name = korea.2.b #Initiate minor reforms.
		swap_ideas = {
			remove_idea = Planned_Economy
			add_idea = Socialist_Market_Economy_planned_2
		}
		add_stability = -0.02
		every_country = { news_event = { id = korea.3 } }
		ai_chance = {
			factor = 60
			modifier = {
				factor = 2
				NKO = {
					set_temp_variable = { temp_idx = -1 }
					any_of = {
						array = influence_array
						value = v
						index = i
						if = {
							limit = { var:v = { tag = KOR } }
							set_temp_variable = { temp_idx = i }
							always = yes
						}
						else = { always = no }
					}
					check_variable = { temp_idx > -1 }
					check_variable = { influence_array_calc^temp_idx > 0.25 }
				}
			}
			modifier = {
				factor = 2
				communism < 0.8
			}
		}
		log = "[GetDateText]: [This.GetName]: korea.2.b executed"
	}

	option = {
		name = korea.2.c #Initiate moderate reforms.
		swap_ideas = {
			remove_idea = Planned_Economy
			add_idea = Socialist_Market_Economy
		}
		add_stability = -0.05
		every_country = { news_event = { id = korea.3 } }
		ai_chance = {
			factor = 40
			modifier = {
				factor = 3
				NKO = {
					set_temp_variable = { temp_idx = -1 }
					any_of = {
						array = influence_array
						value = v
						index = i
						if = {
							limit = { var:v = { tag = KOR } }
							set_temp_variable = { temp_idx = i }
							always = yes
						}
						else = { always = no }
					}
					check_variable = { temp_idx > -1 }
					check_variable = { influence_array_calc^temp_idx > 0.4 }
				}
			}
			modifier = {
				factor = 2
				communism < 0.6
			}
		}
		log = "[GetDateText]: [This.GetName]: korea.2.c executed"
	}

	option = {
		name = korea.2.e #Initiate major reforms.
		swap_ideas = {
			remove_idea = Planned_Economy
			add_idea = Socialist_Market_Economy_free_2
		}
		add_stability = -0.1
		every_country = { news_event = { id = korea.3 } }
		ai_chance = {
			factor = 20
			modifier = {
				factor = 4
				NKO = {
					set_temp_variable = { temp_idx = -1 }
					any_of = {
						array = influence_array
						value = v
						index = i
						if = {
							limit = { var:v = { tag = KOR } }
							set_temp_variable = { temp_idx = i }
							always = yes
						}
						else = { always = no }
					}
					check_variable = { temp_idx > -1 }
					check_variable = { influence_array_calc^temp_idx > 0.5 }
				}
			}
			modifier = {
				factor = 2
				communism < 0.4
			}
		}
		log = "[GetDateText]: [This.GetName]: korea.2.e executed"
	}
}

### [NKO.GetLeader] has announced fresh economic reforms
news_event = {
	id = korea.3

	title = korea.3.t
	desc = korea.3.d
	picture = GFX_trade_agreement

	is_triggered_only = yes

	option = {
		name = korea.3.a #Encouraging news!
		log = "[GetDateText]: [This.GetName]: korea.3.a executed"
	}
}

### The Chinese-North Korean Split
news_event = {
	id = korea.4

	title = korea.4.t
	desc = korea.4.d
	picture = GFX_news_press_conference

	is_triggered_only = yes

	option = {
		name = korea.4.a #Only [CHI.GetLeader] knows where this going...
		log = "[GetDateText]: [This.GetName]: korea.4.a executed"
	}
}

#Peace Talks in Beijing
country_event = {
	id = korea.5

	title = korea.5.t
	desc = {
		trigger = { original_tag = KOR }
		text = korea.5.d
	}
	desc = {
		trigger = { original_tag = NKO }
		text = korea.5.d_NKO
	}
	picture = GFX_politics_negotiations

	is_triggered_only = yes

	option = {
		name = korea.5.a #Our country will never be whole again unless we take a few risks...
		set_country_flag = compromise_offered
		if = {
			limit = {
				NKO = { has_country_flag = compromise_offered }
				KOR = { has_country_flag = compromise_offered }
			}
			NKO = {
				remove_ideas = NKO_nuclear_tests
				remove_ideas = Massive_International_Sanctions
				remove_opinion_modifier = {
					target = KOR
					modifier = imminent_danger_to_national_security
				}
				add_opinion_modifier = {
					target = KOR
					modifier = peace_talks
				}
			}
			KOR = {
				remove_ideas = KOR_joint_us_exercises
				remove_opinion_modifier = {
					target = NKO
					modifier = imminent_danger_to_national_security
				}
				add_opinion_modifier = {
					target = NKO
					modifier = peace_talks
				}
			}
			every_country = {
				news_event = { days = 2 id = korea.7 }
			}
		}
		if = {
			limit = { has_idea = the_military }
			visually_display_opinion_fall_the_military = yes
			set_country_flag = current_the_military
			decrease_internal_faction_opinion = yes
		}
		log = "[GetDateText]: [This.GetName]: korea.5.a executed"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 2
				set_temp_variable = { temp_idx = -1 }
				any_of = {
					array = influence_array
					value = v
					index = i
					if = {
						limit = { var:v = { tag = CHI } }
						set_temp_variable = { temp_idx = i }
						always = yes
					}
					else = { always = no }
				}
				check_variable = { temp_idx > -1 }
				check_variable = { influence_array_calc^temp_idx > 0.2 }
			}
			modifier = {
				factor = 2
				set_temp_variable = { temp_idx = -1 }
				any_of = {
					array = influence_array
					value = v
					index = i
					if = {
						limit = { var:v = { tag = CHI } }
						set_temp_variable = { temp_idx = i }
						always = yes
					}
					else = { always = no }
				}
				check_variable = { temp_idx > -1 }
				check_variable = { influence_array_calc^temp_idx > 0.3 }
			}
			modifier = {
				factor = 2
				set_temp_variable = { temp_idx = -1 }
				any_of = {
					array = influence_array
					value = v
					index = i
					if = {
						limit = { var:v = { tag = CHI } }
						set_temp_variable = { temp_idx = i }
						always = yes
					}
					else = { always = no }
				}
				check_variable = { temp_idx > -1 }
				check_variable = { influence_array_calc^temp_idx > 0.4 }
			}
			modifier = {
				factor = 2
				set_temp_variable = { temp_idx = -1 }
				any_of = {
					array = influence_array
					value = v
					index = i
					if = {
						limit = { var:v = { tag = CHI } }
						set_temp_variable = { temp_idx = i }
						always = yes
					}
					else = { always = no }
				}
				check_variable = { temp_idx > -1 }
				check_variable = { influence_array_calc^temp_idx > 0.5 }
			}
			modifier = {
				factor = 2
				original_tag = KOR
				has_opinion = {
					target = NKO
					value > -50
				}
			}
			modifier = {
				factor = 2
				original_tag = NKO
				has_opinion = {
					target = KOR
					value > -50
				}
			}
			modifier = {
				factor = 8
				is_puppet_of = CHI
			}
			modifier = {
				factor = 2
				original_tag = KOR
				NKO = { NOT = { has_idea = Planned_Economy } }
			}
		}
	}

	option = {
		name = korea.5.b #Some risks are too big too take.
		log = "[GetDateText]: [This.GetName]: korea.5.b executed"
		ai_chance = {
			factor = 40
			modifier = {
				factor = 2
				original_tag = KOR
				OR = {
					is_in_array = { ruling_party = 1 }
					has_government = nationalist
				}
			}
			modifier = {
				factor = 2
				threat > 0.3
			}
		}
	}
}

### Korean Peace Talks Held in Beijing
news_event = {
	id = korea.6

	title = korea.6.t
	desc = korea.6.d
	picture = GFX_news_press_conference

	is_triggered_only = yes

	option = {
		name = korea.6.a #Can the two sides reach a compromise?
		log = "[GetDateText]: [This.GetName]: korea.6.a executed"
	}
}

### Korean Peace Talks a Success!
news_event = {
	id = korea.7

	title = korea.7.t
	desc = korea.7.d
	picture = GFX_trade_agreement

	is_triggered_only = yes

	option = {
		name = korea.7.a #An encouraging development!
		log = "[GetDateText]: [This.GetName]: korea.7.a executed"
	}
}

### Radical Leftist Movement Gains Popularity in South Korea
news_event = {
	id = korea.8
	immediate = { log = "[GetDateText]: [Root.GetName]: event korea.8" }

	title = korea.8.t
	desc = korea.8.d
	picture = GFX_news_election_rally

	is_triggered_only = yes

	option = {
		name = korea.8.a #Something is afoot in the ROK...
		log = "[GetDateText]: [This.GetName]: korea.8.a executed"
	}
}

country_event = {
	id = korea.9
	immediate = { log = "[GetDateText]: [Root.GetName]: event korea.9" }

	title = korea.9.t
	desc = korea.9.d
	picture = GFX_politics_negotiations

	is_triggered_only = yes

	option = {
		name = korea.9.a #We will join their struggle!
		log = "[GetDateText]: [This.GetName]: korea.9.a executed"
		add_political_power = 100
		add_war_support = 0.1
		KOR = {
			create_faction = JUCHE_FACTION
			add_to_faction = NKO
		}
		hidden_effect = {
			every_other_country = {
				limit = {
					has_guaranteed = NKO
				}
				diplomatic_relation = {
					country = NKO
					relation = guarantee
					active = no
				}
				set_country_flag = guaranteed_NKO
			}
		}
		random_country_with_original_tag = {
			original_tag_to_check = KOR
			limit = { NOT = { has_government = communism }}
			declare_war_on = {
				target = NKO
				type = annex_everything
			}
		}
		hidden_effect = {
			every_other_country = {
				limit = {
					has_country_flag = guaranteed_NKO
				}
				clr_country_flag = guaranteed_NKO
				diplomatic_relation = {
					country = NKO
					relation = guarantee
					active = yes
				}
			}
		}
		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = korea.9.b #We will watch from the sidelines.
		log = "[GetDateText]: [This.GetName]: korea.9.b executed"
		ai_chance = {
			factor = 0
		}
	}
}

country_event = {
	id = korea.10
	immediate = { log = "[GetDateText]: [Root.GetName]: event korea.10" }

	title = korea.10.t
	desc = korea.10.d
	picture = GFX_politics_talks

	is_triggered_only = yes

	option = {
		name = korea.10.a #We will stand by our allies!
		log = "[GetDateText]: [This.GetName]: korea.10.a executed"

		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = korea.10.b #This is not worth the lives of our troops.
		log = "[GetDateText]: [This.GetName]: korea.10.b executed"
		CHI = {
			diplomatic_relation = {
				country = NKO
				relation = guarantee
				active = no
			}
		}
		every_country = {
			news_event = {
				id = korea.14
				days = 1
			}
		}
		ai_chance = {
			factor = 1
		}
	}
}

country_event = {
	id = korea.11
	immediate = { log = "[GetDateText]: [Root.GetName]: event korea.11" }

	title = korea.11.t #Korean Arms Companies Offer Products
	desc = korea.11.d
	picture = GFX_politics_talks

	is_triggered_only = yes

	option = {
		name = korea.11.a #Purchase Korean Tanks
		log = "[GetDateText]: [This.GetName]: korea.11.a executed"
		subtract_from_variable = { treasury = 5 }
		custom_effect_tooltip = 5_billion_expense_tt
		KOR = {
			add_to_variable = { treasury = 3.75 }
		}
		if = {
			limit = {
				KOR = { has_tech = MBT_5 }
			}
			add_equipment_to_stockpile = {
				type = MBT_5
				amount = 45
				producer = KOR
			}
		}
		else_if = {
			add_equipment_to_stockpile = {
				type = MBT_3
				amount = 45
				producer = KOR
			}
		}
		generic_grant_1_percent_influence_of_KOR = yes
		KOR = {
			country_event = {
				id = korea.12
				days = 1
			}
		}
		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = korea.11.b #Purchase Korean Self-Propelled Artillery
		log = "[GetDateText]: [This.GetName]: korea.11.b executed"
		subtract_from_variable = { treasury = 3 }
		custom_effect_tooltip = 3_billion_expense_tt
		KOR = {
			add_to_variable = { treasury = 2.25 }
		}
		add_equipment_to_stockpile = {
			type = SP_arty_2
			amount = 50
			producer = KOR
		}
		generic_grant_1_percent_influence_of_KOR = yes
		KOR = {
			country_event = {
				id = korea.12
				days = 1
			}
		}
		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = korea.11.c #Purchase Korean Trainer Jets
		log = "[GetDateText]: [This.GetName]: korea.11.c executed"
		trigger = {
			KOR = { has_tech = L_Strike_fighter2 }
		}
		subtract_from_variable = { treasury = 2 }
		KOR = {
			add_to_variable = { treasury = 1.5 }
		}
		custom_effect_tooltip = 2_billion_expense_tt
		add_equipment_to_stockpile = {
			type = L_Strike_fighter2
			amount = 24
			producer = KOR
		}
		generic_grant_1_percent_influence_of_KOR = yes
		KOR = {
			country_event = {
				id = korea.12
				days = 1
			}
		}
		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = korea.11.e #Purchase Korean Rifles
		log = "[GetDateText]: [This.GetName]: korea.11.e executed"
		subtract_from_variable = { treasury = 0.5 }
		KOR = {
			add_to_variable = { treasury = 0.375 }
		}
		custom_effect_tooltip = 0_5_billion_expense_tt
		if = {
			limit = {
				KOR = { has_tech = MBT_5 }
			}
			add_equipment_to_stockpile = {
				type = infantry_weapons5
				amount = 1000
				producer = KOR
			}
		}
		else_if = {
			add_equipment_to_stockpile = {
				type = infantry_weapons3
				amount = 1000
				producer = KOR
			}
		}
		generic_grant_1_percent_influence_of_KOR = yes
		KOR = {
			country_event = {
				id = korea.12
				days = 1
			}
		}
		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = korea.11.f #Refuse Offer
		log = "[GetDateText]: [This.GetName]: korea.11.f executed"
		ai_chance = {
			factor = 1
		}
	}
}

country_event = {
	id = korea.12
	immediate = { log = "[GetDateText]: [Root.GetName]: event korea.12" }

	title = korea.12.t #[FROM.GetNameDef] Agrees to Arms Deal!
	desc = korea.12.d
	picture = GFX_politics_talks

	is_triggered_only = yes

	option = {
		name = korea.12.a #Our international standing grows!
		log = "[GetDateText]: [This.GetName]: korea.12.a executed"
	}
}

#Beijing and Seoul Jointly Criticize Japanese WW2 Actions
news_event = {
	id = korea.13

	title = korea.13.t
	desc = korea.13.d
	picture = GFX_news_press_conference

	is_triggered_only = yes

	option = {
		name = korea.13.a #We will never forget what they did.
		log = "[GetDateText]: [This.GetName]: korea.13.a executed"
		trigger = {
			OR = {
				original_tag = CHI
				original_tag = KOR
				original_tag = NKO
			}
		}
	}

	option = {
		name = korea.13.b #Their criticism is tiresome...
		log = "[GetDateText]: [This.GetName]: korea.13.b executed"
		trigger = {
			original_tag = JAP
		}
	}

	option = {
		name = korea.13.c #The past casts a long shadow...
		log = "[GetDateText]: [This.GetName]: korea.13.b executed"
		trigger = {
			NOT = {
				original_tag = JAP
				original_tag = CHI
				original_tag = KOR
				original_tag = NKO
			}
		}
	}
}

#China Annuls Defense Treaty with North Korea
news_event = {
	id = korea.14

	title = korea.14.t
	desc = korea.14.d
	picture = GFX_news_press_conference

	is_triggered_only = yes

	option = {
		name = korea.14.a #Our efforts have paid off.
		log = "[GetDateText]: [This.GetName]: korea.14.a executed"
		trigger = {
			original_tag = KOR
		}
	}

	option = {
		name = korea.14.b #We have tolerated Pyongyang for too long.
		log = "[GetDateText]: [This.GetName]: korea.14.b executed"
		trigger = {
			original_tag = NKO
		}
	}

	option = {
		name = korea.14.c #Is war on the horizon?
		log = "[GetDateText]: [This.GetName]: korea.14.c executed"
		trigger = {
			NOT = {
				original_tag = CHI
				original_tag = KOR
			}
		}
	}
}