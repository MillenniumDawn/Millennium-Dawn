clamp_threat = {
	if = {	
		limit = { 
			OR = {
				jihadist_government = yes
				has_completed_focus = GCC_a_radical_reorientation
			}
		}
		clamp_variable = { 
			var = threat_level 
			min = 0
			max = 100
		}
	}
	else_if = {	
		limit = { 
			has_war = yes
			no_jihadist_government = yes
		}
		clamp_variable = { 
			var = threat_level 
			min = 50
			max = 90
		}
	}
	else_if = {	
		limit = { 
			has_war = no 
			no_jihadist_government = yes
			has_stability < 0.5
			OR = {
				has_idea = paralyzing_corruption
				has_idea = crippling_corruption
				has_idea = rampant_corruption
				has_idea = unrestrained_corruption
			}
			OR = {
				has_idea = gdp_1
				has_idea = gdp_2
				has_idea = gdp_3
				has_idea = gdp_4
			}
		}
		clamp_variable = { 
			var = threat_level 
			min = 30
			max = 70
		}
	}
	else_if = {	
		limit = { 
			has_war = no 
			no_jihadist_government = yes
			OR = {
				AND = {
					has_stability < 0.5
					OR = {	
						has_idea = paralyzing_corruption
						has_idea = crippling_corruption
						has_idea = rampant_corruption
						has_idea = unrestrained_corruption
					}
				}
				AND = {
					has_stability < 0.5
					OR = {
						has_idea = gdp_1
						has_idea = gdp_2
						has_idea = gdp_3
						has_idea = gdp_4
					}
				}
				AND = {
					OR = {
						has_idea = gdp_1
						has_idea = gdp_2
						has_idea = gdp_3
						has_idea = gdp_4
					}
					OR = {	
						has_idea = paralyzing_corruption
						has_idea = crippling_corruption
						has_idea = rampant_corruption
						has_idea = unrestrained_corruption
					}
				}
			}
		}
		clamp_variable = { 
			var = threat_level 
			min = 20
			max = 60
		}
	}
	else_if = {	
		limit = { 
			has_war = no 
			no_jihadist_government = yes
			OR = {
				has_stability < 0.5
				OR = {	
					has_idea = paralyzing_corruption
					has_idea = crippling_corruption
					has_idea = rampant_corruption
					has_idea = unrestrained_corruption
				}
				OR = {
					has_idea = gdp_1
					has_idea = gdp_2
					has_idea = gdp_3
					has_idea = gdp_4
				}
			}
		}
		clamp_variable = { 
			var = threat_level 
			min = 10
			max = 50
		}
	}
	else_if = {	
		limit = { 
			has_war = no 
			no_jihadist_government = yes
			NOT = {
				has_stability < 0.5
				has_idea = paralyzing_corruption
				has_idea = crippling_corruption
				has_idea = rampant_corruption
				has_idea = unrestrained_corruption
				has_idea = gdp_1
				has_idea = gdp_2
				has_idea = gdp_3
				has_idea = gdp_4
			}
		}
		clamp_variable = { 
			var = threat_level 
			min = 0
			max = 40
		}
	}
	if = {
		limit = { 
			has_country_flag = threat_level_critical
			check_variable = { threat_level < 81 }
		}
		clr_country_flag = threat_level_critical
		set_country_flag = threat_level_severe
	}
	else_if = {
		limit = { 
			has_country_flag = threat_level_severe
			check_variable = { threat_level > 80 }
		}
		clr_country_flag = threat_level_severe
		set_country_flag = threat_level_critical
	}
	else_if = {
		limit = { 
			has_country_flag = threat_level_severe
			check_variable = { threat_level < 51 }
		}
		clr_country_flag = threat_level_severe
		set_country_flag = threat_level_substantial
	}
	else_if = {
		limit = { 
			has_country_flag = threat_level_substantial
			check_variable = { threat_level > 50 }
		}
		clr_country_flag = threat_level_substantial
		set_country_flag = threat_level_severe
	}
	else_if = {
		limit = { 
			has_country_flag = threat_level_substantial
			check_variable = { threat_level < 31 }
		}
		clr_country_flag = threat_level_substantial
		set_country_flag = threat_level_moderate
	}
	else_if = {
		limit = { 
			has_country_flag = threat_level_moderate
			check_variable = { threat_level > 30 }
		}
		clr_country_flag = threat_level_moderate
		set_country_flag = threat_level_substantial
	}
	else_if = {
		limit = { 
			has_country_flag = threat_level_moderate
			check_variable = { threat_level < 21 }
		}
		clr_country_flag = threat_level_moderate
		set_country_flag = threat_level_low
	}
	else_if = {
		limit = { 
			has_country_flag = threat_level_low
			check_variable = { threat_level > 20 }
		}
		clr_country_flag = threat_level_low
		set_country_flag = threat_level_moderate
	}
	else_if = {
		limit = { 
			has_country_flag = threat_level_low
			check_variable = { threat_level < 11 }
		}
		clr_country_flag = threat_level_low
		set_country_flag = threat_level_negligible
	}
	else_if = {
		limit = { 
			has_country_flag = threat_level_negligible
			check_variable = { threat_level > 10 }
		}
		clr_country_flag = threat_level_negligible
		set_country_flag = threat_level_low
	}
}

clamp_radicalization = {
	if = {
		limit = {
			has_stability < 0.5
			OR = {
				has_idea = paralyzing_corruption
				has_idea = crippling_corruption
				has_idea = rampant_corruption
				has_idea = unrestrained_corruption
			}
			OR = {
				has_idea = gdp_1
				has_idea = gdp_2
				has_idea = gdp_3
				has_idea = gdp_4
			}
		}
		clamp_variable = {
			var = radicalization
			min = 30
			max = 100
		}
	}
	else_if = {
		limit = {
			OR = {
				AND = {
					has_stability < 0.5
					OR = {	
						has_idea = paralyzing_corruption
						has_idea = crippling_corruption
						has_idea = rampant_corruption
						has_idea = unrestrained_corruption
					}
				}
				AND = {
					has_stability < 0.5
					OR = {
						has_idea = gdp_1
						has_idea = gdp_2
						has_idea = gdp_3
						has_idea = gdp_4
					}
				}
				AND = {
					OR = {
						has_idea = gdp_1
						has_idea = gdp_2
						has_idea = gdp_3
						has_idea = gdp_4
					}
					OR = {	
						has_idea = paralyzing_corruption
						has_idea = crippling_corruption
						has_idea = rampant_corruption
						has_idea = unrestrained_corruption
					}
				}
			}
		}
		clamp_variable = {
			var = radicalization
			min = 20
			max = 100
		}
	}
	else_if = {
		limit = {
			OR = {
				has_stability < 0.5
				OR = {	
					has_idea = paralyzing_corruption
					has_idea = crippling_corruption
					has_idea = rampant_corruption
					has_idea = unrestrained_corruption
				}
				OR = {
					has_idea = gdp_1
					has_idea = gdp_2
					has_idea = gdp_3
					has_idea = gdp_4
				}
			}
		}
		clamp_variable = {
			var = radicalization
			min = 10
			max = 100
		}
	}
	else_if = {
		limit = {
			OR = {
				NOT = {
					has_stability < 0.5
					has_idea = paralyzing_corruption
					has_idea = crippling_corruption
					has_idea = rampant_corruption
					has_idea = unrestrained_corruption
					has_idea = gdp_1
					has_idea = gdp_2
					has_idea = gdp_3
					has_idea = gdp_4
				}
				has_idea = shia
				has_idea = ibadi
			}
		}
		clamp_variable = {
			var = radicalization
			min = 0
			max = 100
		}
	}
	if = {
		limit = { 
			NOT = { has_idea = youth_radicalization }
			check_variable = { radicalization > 9 }
		}
		add_ideas = youth_radicalization
	}
	else_if = {
		limit = { 
			has_idea = youth_radicalization
			check_variable = { radicalization < 10 }
		}
		remove_ideas = youth_radicalization
	}
}