add_namespace = small_medium_business_owners_request_events
add_namespace = small_medium_business_owners_bonus_events

######################################
### Small & Medium Business Owners ###
######################################

### Requests ###

#S&M Business Owners Demand a Tax Cut
country_event = {
	id = small_medium_business_owners_request_events.0
	title = small_medium_business_owners_request_events.0.t
	desc = small_medium_business_owners_request_events.0.d
	immediate = { log = "[Get.DateText]: [This.GetName]: small_medium_business_owners_request_events.0" }
	picture = GFX_internal_faction_tax_cut
	
	is_triggered_only = yes
	trigger = {
		current_active_small_medium_business_owners = yes
		NOT = { has_country_flag = enthusiastic_small_medium_business_owners }
		check_variable = { tax_rate > 10 }
	}
	
	mean_time_to_happen = {
		days = 1
		#More likely if high tax rate
		modifier = {
			factor = 0.5
			check_variable = { tax_rate > 30 }
		}
		#Less likely if low tax rate
		modifier = {
			factor = 1.5
			check_variable = { tax_rate < 20 }
		}
		#More likely if low economic cycle
		modifier = {
			factor = 1.5
			OR = {
				has_idea = depression
				has_idea = recession
				has_idea = stagnation
			}
		}
	}
	
	option = {
		name = small_medium_business_owners_request_events.0.o1
		log = "[GetDateText]: [This.GetName]: small_medium_business_owners_request_events.0.o1 executed"	#Decrease taxes
		increase_small_medium_business_owners_opinion = yes
		add_timed_idea = {
			idea = internal_faction_tax_cuts
			days = 360
		}
		if = {
			limit = {
				OR = {
					has_socialist_government = yes
					has_communist_government = yes
				}
			}
			decrease_popularity_5 = yes
			set_party_index_to_ruling_party = yes
			set_temp_variable = { party_popularity_increase = -0.05 }
			add_relative_party_popularity = yes
			if = {
				limit = { check_variable = { party_pop_array^1 > 0.01 } }
				hidden_effect = {
					if = { 
						limit = { NOT = { has_government = democratic } }
						add_popularity = { party = democratic popularity = -0.01 }
					}
					set_temp_variable = { party_index = 1 }
					set_temp_variable = { party_popularity_increase = -0.01 }
					add_relative_party_popularity = yes
					set_party_index_to_ruling_party = yes
					set_temp_variable = { party_popularity_increase = 0.01 }
					add_relative_party_popularity = yes
				}
				custom_effect_tooltip = attract_voters_pos.1
			}
			if = {
				limit = { check_variable = { party_pop_array^2 > 0.01 } }
				hidden_effect = {
					if = { 
						limit = { NOT = { has_government = democratic } }
						add_popularity = { party = democratic popularity = -0.01 }
					}
					set_temp_variable = { party_index = 2 }
					set_temp_variable = { party_popularity_increase = -0.01 }
					add_relative_party_popularity = yes
					set_party_index_to_ruling_party = yes
					set_temp_variable = { party_popularity_increase = 0.01 }
					add_relative_party_popularity = yes
				}
				custom_effect_tooltip = attract_voters_pos.2
			}
			if = {
				limit = { check_variable = { party_pop_array^14 > 0.01 } }
				hidden_effect = {
					if = { 
						limit = { NOT = { has_government = neutrality } }
						add_popularity = { party = neutrality popularity = -0.01 }
					}
					set_temp_variable = { party_index = 14 }
					set_temp_variable = { party_popularity_increase = -0.01 }
					add_relative_party_popularity = yes
					set_party_index_to_ruling_party = yes
					set_temp_variable = { party_popularity_increase = 0.01 }
					add_relative_party_popularity = yes
				}
				custom_effect_tooltip = attract_voters_pos.14
			}
			if = {
				limit = { check_variable = { party_pop_array^15 > 0.01 } }
				hidden_effect = {
					if = { 
						limit = { NOT = { has_government = neutrality } }
						add_popularity = { party = neutrality popularity = -0.01 }
					}
					set_temp_variable = { party_index = 15 }
					set_temp_variable = { party_popularity_increase = -0.01 }
					add_relative_party_popularity = yes
					set_party_index_to_ruling_party = yes
					set_temp_variable = { party_popularity_increase = 0.01 }
					add_relative_party_popularity = yes
				}
				custom_effect_tooltip = attract_voters_pos.15
			}
			if = {
				limit = { check_variable = { party_pop_array^16 > 0.01 } }
				hidden_effect = {
					if = { 
						limit = { NOT = { has_government = neutrality } }
						add_popularity = { party = neutrality popularity = -0.01 }
					}
					set_temp_variable = { party_index = 16 }
					set_temp_variable = { party_popularity_increase = -0.01 }
					add_relative_party_popularity = yes
					set_party_index_to_ruling_party = yes
					set_temp_variable = { party_popularity_increase = 0.01 }
					add_relative_party_popularity = yes
				}
				custom_effect_tooltip = attract_voters_pos.16
			}
		}
	}
}