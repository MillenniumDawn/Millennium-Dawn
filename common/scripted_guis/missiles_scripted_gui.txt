scripted_gui = {
	MD_missiles_stateview_gui = {
		window_name = "missiles_stateview_window_container"

		context_type = selected_state_context
        parent_window_token = selected_state_view

        visible = {
            #has_dlc = "La Resistance"
            #has_country_flag = open_MD_countrymissilesview
            always = yes
        }

        effects = {
            MD_missiles_ground_launch_button_click = {
                ROOT = {
                    set_country_flag = search_target_point
                    add_to_array = {
                        array = missile_launch_point_array
                        value = PREV.id
                    }
                    add_to_variable = {
                        var_missile_trajectory_ID = 1
                    }
                }
            }
            MD_missiles_sea_launch_button_click = {
                ROOT = {
                    set_country_flag = search_target_point
                    add_to_array = {
                        array = missile_launch_point_array
                        value = PREV.id
                    }
                    add_to_variable = {
                        var_missile_trajectory_ID = 1
                    }
                }
            }
            MD_missiles_air_launch_button_click = {
                ROOT = {
                    set_country_flag = search_target_point
                    add_to_array = {
                        array = missile_launch_point_array
                        value = PREV.id
                    }
                    add_to_variable = {
                        var_missile_trajectory_ID = 1
                    }
                }
            }
            MD_missiles_target_button_click = {
                ROOT = {
                    clr_country_flag = search_target_point
                    add_to_array = {
                        array = missile_target_point_array
                        value = PREV.id
                        index = var_missile_trajectory_ID
                    }
                }    
                controller = {
                    add_to_array = {
                        array = ROOT.missile_target_controller_array
                        value = THIS
                        index = ROOT.var_missile_trajectory_ID
                    }
                }
            }
        }

        triggers = {
            MD_missiles_target_button_click_enabled = {
                ROOT = { has_country_flag = search_target_point }
            }
            MD_missiles_ground_launch_button_click_enabled = {
                ROOT = { NOT = { has_country_flag = search_target_point } }
            }
            MD_missiles_sea_launch_button_click_enabled = {
                ROOT = { NOT = { has_country_flag = search_target_point } }
            }
            MD_missiles_air_launch_button_click_enabled = {
                ROOT = { NOT = { has_country_flag = search_target_point } }
            }
        }

    }

    MD_missiles_gui = {
        window_name = MD_countrymissilesview
        context_type = player_context
        parent_window_token = topbar #after_intel_agency_button #country_menu_window ### idk if that is correct???
         
        visible = {
            #has_dlc = "La Resistance"
            has_country_flag = open_MD_countrymissilesview
        }
        
        effects = {
            close_button_click = {
                clr_country_flag = open_MD_countrymissilesview
                clr_country_flag = open_MD_target_selection_view
            }
            missiles_gui_ledger_btn_1_click = {
                set_variable = { var_open_MD_missiles_gui_ledger_1 = 2 }
                clear_variable = var_open_MD_missiles_gui_ledger_2
                clear_variable = var_open_MD_missiles_gui_ledger_3
                clear_variable = var_open_MD_missiles_gui_ledger_4
                #set_country_flag = open_MD_missiles_gui_ledger_1
                #clr_country_flag = open_MD_missiles_gui_ledger_2
                #clr_country_flag = open_MD_missiles_gui_ledger_3
                #clr_country_flag = open_MD_missiles_gui_ledger_4
            }
            missiles_gui_ledger_btn_2_click = {
                set_variable = { var_open_MD_missiles_gui_ledger_2 = 2 }
                clear_variable = var_open_MD_missiles_gui_ledger_1
                clear_variable = var_open_MD_missiles_gui_ledger_3
                clear_variable = var_open_MD_missiles_gui_ledger_4
                #set_country_flag = open_MD_missiles_gui_ledger_2
                #clr_country_flag = open_MD_missiles_gui_ledger_1
                #clr_country_flag = open_MD_missiles_gui_ledger_3
                #clr_country_flag = open_MD_missiles_gui_ledger_4
            }
            missiles_gui_ledger_btn_3_click = {
                set_variable = { var_open_MD_missiles_gui_ledger_3 = 2 }
                clear_variable = var_open_MD_missiles_gui_ledger_1
                clear_variable = var_open_MD_missiles_gui_ledger_2
                clear_variable = var_open_MD_missiles_gui_ledger_4
                #set_country_flag = open_MD_missiles_gui_ledger_3
                #clr_country_flag = open_MD_missiles_gui_ledger_1
                #clr_country_flag = open_MD_missiles_gui_ledger_2
                #clr_country_flag = open_MD_missiles_gui_ledger_4
            }
            missiles_gui_ledger_btn_4_click = {
                set_variable = { var_open_MD_missiles_gui_ledger_4 = 2 }
                clear_variable = var_open_MD_missiles_gui_ledger_1
                clear_variable = var_open_MD_missiles_gui_ledger_2
                clear_variable = var_open_MD_missiles_gui_ledger_3
                #set_country_flag = open_MD_missiles_gui_ledger_4
                #clr_country_flag = open_MD_missiles_gui_ledger_1
                #clr_country_flag = open_MD_missiles_gui_ledger_2
                #clr_country_flag = open_MD_missiles_gui_ledger_3
            }
        }



        properties = {
            missiles_gui_ledger_btn_1 = {
                frame = var_open_MD_missiles_gui_ledger_1
            }
            missiles_gui_ledger_btn_2 = {
                frame = var_open_MD_missiles_gui_ledger_2
            }
            missiles_gui_ledger_btn_3 = {
                frame = var_open_MD_missiles_gui_ledger_3
            }
            missiles_gui_ledger_btn_4 = {
                frame = var_open_MD_missiles_gui_ledger_4
            }
        }
    }

    MD_countrymissilesview_production_gui = {
        window_name = MD_countrymissilesview_production
        context_type = player_context
        parent_window_name = MD_countrymissilesview
         
        visible = {
            check_variable = { var_open_MD_missiles_gui_ledger_1 = 2 }
            has_country_flag = open_MD_countrymissilesview
        }        
    }

    MD_countrymissilesview_launch_gui = {
        window_name = MD_countrymissilesview_launch
        context_type = player_context
        parent_window_name = MD_countrymissilesview

        visible = {
            check_variable = { var_open_MD_missiles_gui_ledger_2 = 2 }
            has_country_flag = open_MD_countrymissilesview
        }

        effects = {
            target_selection_button_click = {
                set_warhead_targets = yes
                if = {
                    limit = {
                        has_country_flag = open_MD_target_selection_view
                    }
                    clr_country_flag = open_MD_target_selection_view
                }
                else = {
                    set_country_flag = open_MD_target_selection_view
                }
            }
            ### temp for testing ###
            missile_model_button_click = {
                add_to_variable = { var_gui_missile_type = 1 }
                add_to_variable = { var_gui_missile_tech = 1 }
            }
            missile_model_button_right_click = {
                subtract_from_variable = { var_gui_missile_type = 1 }
                subtract_from_variable = { var_gui_missile_tech = 1 }
            }
            warhead_button_click = {
                add_to_variable = { var_gui_warhead = 1 }
            }
            warhead_button_right_click = {
                subtract_from_variable = { var_gui_warhead = 1 }
            }                        
            ### end of temp for testing ###

            ### salvo button effects ###
            salvo_small_plus_button_bg_click = {
                add_to_variable = { var_gui_salvo = 1 }
                set_variable = { var_total_firing = var_gui_salvo }
                multiply_variable = { var_total_firing = var_gui_duration }
            }
            salvo_small_minus_button_bg_click = {
                subtract_from_variable = { var_gui_salvo = 1 }
                if = {
                    limit = {
                        check_variable = { var_gui_salvo < 0 }
                    }
                    set_variable = { var_gui_salvo = 0 }
                }
                set_variable = { var_total_firing = var_gui_salvo }
                multiply_variable = { var_total_firing = var_gui_duration }
            }
            salvo_small_plus_button_bg_control_click = {
                add_to_variable = { var_gui_salvo = 10 }
            }
            salvo_small_minus_button_bg_control_click = {
                subtract_from_variable = { var_gui_salvo = 10 }
                if = {
                    limit = {
                        check_variable = { var_gui_salvo < 0 }
                    }
                    set_variable = { var_gui_salvo = 0 }
                }
                set_variable = { var_total_firing = var_gui_salvo }
                multiply_variable = { var_total_firing = var_gui_duration }
            }
            salvo_small_plus_button_bg_shift_click = {
                add_to_variable = { var_gui_salvo = 100 }
                set_variable = { var_total_firing = var_gui_salvo }
                multiply_variable = { var_total_firing = var_gui_duration }
            }
            salvo_small_minus_button_bg_shift_click = {
                subtract_from_variable = { var_gui_salvo = 100 }
                if = {
                    limit = {
                        check_variable = { var_gui_salvo < 0 }
                    }
                    set_variable = { var_gui_salvo = 0 }
                }
                set_variable = { var_total_firing = var_gui_salvo }
                multiply_variable = { var_total_firing = var_gui_duration }
            }
            ### duration button effects ###
            duration_small_plus_button_bg_click = {
                add_to_variable = { var_gui_duration = 1 }
                set_variable = { var_total_firing = var_gui_salvo }
                multiply_variable = { var_total_firing = var_gui_duration }
            }
            duration_small_minus_button_bg_click = {
                subtract_from_variable = { var_gui_duration = 1 }
                if = {
                    limit = {
                        check_variable = { var_gui_duration < 0 }
                    }
                    set_variable = { var_gui_duration = 0 }
                }
                set_variable = { var_total_firing = var_gui_salvo }
                multiply_variable = { var_total_firing = var_gui_duration }
            }
            duration_small_plus_button_bg_control_click = {
                add_to_variable = { var_gui_duration = 10 }
            }
            duration_small_minus_button_bg_control_click = {
                subtract_from_variable = { var_gui_duration = 10 }
                if = {
                    limit = {
                        check_variable = { var_gui_duration < 0 }
                    }
                    set_variable = { var_gui_duration = 0 }
                }
                set_variable = { var_total_firing = var_gui_salvo }
                multiply_variable = { var_total_firing = var_gui_duration }
            }
            duration_small_plus_button_bg_shift_click = {
                add_to_variable = { var_gui_duration = 100 }
                set_variable = { var_total_firing = var_gui_salvo }
                multiply_variable = { var_total_firing = var_gui_duration }
            }
            duration_small_minus_button_bg_shift_click = {
                subtract_from_variable = { var_gui_duration = 100 }
                if = {
                    limit = {
                        check_variable = { var_gui_duration < 0 }
                    }
                    set_variable = { var_gui_duration = 0 }
                }
                set_variable = { var_total_firing = var_gui_salvo }
                multiply_variable = { var_total_firing = var_gui_duration }
            }
            fire_button_click = {                
                add_to_array = {
                    missile_type_array = var_gui_missile_type
                    index = var_missile_trajectory_ID
                }
                add_to_array = {
                    missile_tech_array = var_gui_missile_tech
                    index = var_missile_trajectory_ID
                }
                add_to_array = {
                    missile_warhead_array = var_gui_warhead
                    index = var_missile_trajectory_ID
                }
                add_to_array = {
                    missile_salvo_array = var_gui_salvo
                    index = var_missile_trajectory_ID
                }
                add_to_array = {
                    missile_duration_array = var_gui_duration
                    index = var_missile_trajectory_ID
                }
            }
            missile_stat_button_click = {
                if = {
                    limit = {
                        has_country_flag = open_MD_missile_stat_view
                    }
                    clr_country_flag = open_MD_missile_stat_view
                }
                else = {
                    set_country_flag = open_MD_missile_stat_view
                }
                ### set stats for current ID ###
                set_variable = { var_stat_trajectory_ID = var_missile_trajectory_ID }
            }
        }

        dynamic_lists = {
            trajectory_gridbox = {
                array = missile_launch_point_array
                entry_container = trajectory_list_entry
                change_scope = yes
            }
        }
    }

    MD_target_selection_view_gui = {
        window_name = MD_target_selection_view
        context_type = player_context
        parent_window_name = MD_countrymissilesview_launch

        visible = {
            has_country_flag = open_MD_target_selection_view
        }

        dynamic_lists = {
            missiles_priorities_gridbox = {
                array = global.building_array #missile_launch_point_array
                entry_container = missiles_priority_item
                change_scope = yes
            }
        }

        effects = {
            building_button_click = {
                meta_effect = {
                    text = {
                        if = {
                            limit = {
                                NOT = { check_variable = { var_selected_air_priority_icon = 3 } }
                                #check_variable = { target_building_[i]_array^var_missile_trajectory_ID = 1 }
                            }
                            ROOT = { remove_from_array = { array = target_building_[i]_array value = 1 index = var_missile_trajectory_ID } }
                            set_variable = { var_selected_air_priority_icon = 3 }
                        }
                        else = {
                            ROOT = { add_to_array = { array = target_building_[i]_array value = 1 index = var_missile_trajectory_ID } }
                            set_variable = { var_selected_air_priority_icon = 1 }
                        }
                    }
                    i = "[?global.building_array^i]"
                }
            }
        }

        properties = {
            building_button = {
                frame = global.building_array^i # frame = global.building_array^i
            }
            selected_air_priority_icon = {
                frame = var_selected_air_priority_icon
            }
        }
    }

    MD_missile_stat_view_gui = {
        window_name = MD_missile_stat_view
        context_type = player_context
        parent_window_name = MD_countrymissilesview_launch

        visible = {
            has_country_flag = open_MD_missile_stat_view
        }

        effects = {
            previous_stat_trajectory_button_click = {
                subtract_from_variable = { var_stat_trajectory_ID = 1 }
            }
            next_stat_trajectory_button_click = {
                add_to_variable = { var_stat_trajectory_ID = 1 }
            }
        }

        dynamic_lists = {
            missiles_stat_gridbox = {
                array = global.building_array #missile_launch_point_array
                entry_container = missiles_stat_item
                change_scope = yes
            }
        }

        properties = {
            stat_icon = {
                frame = global.building_array^i
            }
        }
    }

    MD_countrymissilesview_defense_gui = {
        window_name = MD_countrymissilesview_defense
        context_type = player_context
        parent_window_name = MD_countrymissilesview
         
        visible = {
            check_variable = { var_open_MD_missiles_gui_ledger_3 = 2 }
            has_country_flag = open_MD_countrymissilesview
        }        
    }

    MD_countrymissilesview_satellites_gui = {
        window_name = MD_countrymissilesview_satellites
        context_type = player_context
        parent_window_name = MD_countrymissilesview
         
        visible = {
            check_variable = { var_open_MD_missiles_gui_ledger_4 = 2 }
            has_country_flag = open_MD_countrymissilesview
        }        
    }

}