#LegCo
calculate_total_legco_seats = {
	set_variable = { legco_total_seats = legco_PE_seats }
	add_to_variable = { legco_total_seats = legco_PD_seats }
	add_to_variable = { legco_total_seats = legco_LC_seats }
}
set_total_legco_seats = {
	if = {
		limit = {
			date > 2001.10.1
			NOT = {
				OR = {
					has_country_flag = HKG_electoral_reform_mainland_b
					has_country_flag = HKG_electoral_reform_mainland_C
				}
			}
		}
		set_variable = { legco_total_seats = 60 }
	}
	if = {
		limit = {
			has_country_flag = HKG_electoral_reform_mainland_b
		}
		set_variable = { legco_total_seats = 70 }
	}
	if = {
		limit = {
			has_country_flag = HKG_electoral_reform_mainland_c
		}
		set_variable = { legco_total_seats = 90 }
	}
}

calculate_required_legco_seats = {
	set_temp_variable = { legco_temp_total_seats = legco_total_seats }
	multiply_temp_variable = { legco_temp_total_seats = 0.5 }
	set_variable = { legco_required_seats = legco_temp_total_seats }
	round_variable = legco_required_seats
}
calculate_legco_seats_four_yearly = {
	#Pro-establishment camp
	set_variable = { legco_PE_party_pop = party_pop_array^6 }
	add_to_variable = { legco_PE_party_pop = party_pop_array^7 }
	add_to_variable = { legco_PE_party_pop = party_pop_array^8 }
	add_to_variable = { legco_PE_party_pop = party_pop_array^15 }
	add_to_variable = { legco_PE_party_pop = party_pop_array^16 }
	add_to_variable = { legco_PE_party_pop = party_pop_array^17 }
	#Pan-democracy Camp
	set_variable = { legco_PD_party_pop = party_pop_array^1 }
	add_to_variable = { legco_PD_party_pop = party_pop_array^2 }
	add_to_variable = { legco_PD_party_pop = party_pop_array^3 }
	add_to_variable = { legco_PD_party_pop = party_pop_array^4 }
	add_to_variable = { legco_PD_party_pop = party_pop_array^14 }
	add_to_variable = { legco_PD_party_pop = party_pop_array^18 }
	add_to_variable = { legco_PD_party_pop = party_pop_array^19 }
	add_to_variable = { legco_PD_party_pop = party_pop_array^20 }
	#Localist Camp
	set_variable = { legco_LC_party_pop = party_pop_array^21 }
	add_to_variable = { legco_LC_party_pop = party_pop_array^22 }
	add_to_variable = { legco_LC_party_pop = party_pop_array^23 }
	add_to_variable = { legco_LC_party_pop = party_pop_array^24 }

	set_variable = { legco_PE_seats = legco_total_seats }
	multiply_variable = { legco_PE_seats = legco_PE_party_pop }
	#multiply_variable = { legco_PE_seats = 0.01 }
	round_variable = legco_PE_seats
	set_variable = { legco_PD_seats = legco_total_seats }
	multiply_variable = { legco_PD_seats = legco_PD_party_pop }
	#multiply_variable = { legco_PD_seats = 0.01 }
	round_variable = legco_PD_seats
	set_variable = { legco_LC_seats = legco_total_seats }
	multiply_variable = { legco_LC_seats = legco_LC_party_pop }
	#multiply_variable = { legco_LC_seats = 0.01 }
	round_variable = legco_LC_seats
	custom_effect_tooltip = legco_election_seats
	
	clamp_temp_variable = {
		var = legco_PE_seats
		min = 0
		max = legco_total_seats
	}	
	clamp_temp_variable = {
		var = legco_PD_seats
		min = 0
		max = legco_total_seats
	}
	clamp_temp_variable = {
		var = legco_LC_seats
		min = 0
		max = legco_total_seats
	}	
}
HKG_legco_votes_initialize = {
	clamp_temp_variable = {
		var = legco_PE_temp_support
		min = 0
		max = 1
	}	
	clamp_temp_variable = {
		var = legco_PD_temp_support
		min = 0
		max = 1
	}	
	clamp_temp_variable = {
		var = legco_LC_temp_support
		min = 0
		max = 1
	}
	set_temp_variable = { legco_PE_support = legco_PE_seats }
	multiply_temp_variable = { legco_PE_support = legco_PE_temp_support }
	round_variable = legco_PE_support

	set_temp_variable = { legco_PD_support = legco_PD_seats }
	multiply_temp_variable = { legco_PD_support = legco_PD_temp_support }
	round_variable = legco_PD_support

	set_temp_variable = { legco_LC_support = legco_LC_seats }
	multiply_temp_variable = { legco_LC_support = legco_LC_temp_support }
	round_variable = legco_LC_support

	set_temp_variable = { legco_temp_total_seats = legco_total_seats }


	set_variable = { legco_approval_seats = legco_PE_support }
	add_to_variable = { legco_approval_seats = legco_PD_support }
	add_to_variable = { legco_approval_seats = legco_LC_support }
	round_variable = legco_approval_seats

	set_variable = { legco_negative_seats = legco_total_seats }
	subtract_from_variable = { legco_negative_seats = legco_approval_seats }
	round_variable = legco_negative_seats
}

HKG_railway_development_strategy_2000_effect = {
	add_ideas = HKG_idea_railway_development_strategy_2000
	clr_country_flag = railway_development_strategy_2000_done
	set_variable = { legco_approval_seats = 0 }
	set_variable = { legco_negative_seats = 0 }
}

HKG_approve_funding_for_XRL_effect = {
	set_temp_variable = { treasury_change = -1.00 }
	modify_treasury_effect = yes
	595 = {
		add_building_construction = {
			type = rail_way
			level = 1
			instant_build = yes
			province = 10062
		}
	}
	CHI = {
		532 = {
			add_building_construction = {
				type = rail_way
				level = 1
				instant_build = yes
				province = 7108
			}
			add_building_construction = {
				type = rail_way
				level = 1
				instant_build = yes
				province = 14594
			}
			add_building_construction = {
				type = rail_way
				level = 1
				instant_build = yes
				province = 14596
			}
		}
	}

	clr_country_flag = approve_funding_for_XRL_done
	set_variable = { legco_approval_seats = 0 }
	set_variable = { legco_negative_seats = 0 }
}

#Housing Issue
UHM_update_political_power_factor = {
	custom_effect_tooltip = UHM_update_pp_cost_TT
	add_to_variable = { UHM_political_power_cost_var = UHM_political_power_cost_var }
}
UHM_update_stability_factor = {
	custom_effect_tooltip = UHM_update_stability_factor_TT
	add_to_variable = { UHM_stability_factor_var = UHM_stability_factor_var }
}
UHM_update_stability_weekly = {
	custom_effect_tooltip = UHM_update_stability_weekly_TT
	add_to_variable = { UHM_stability_weekly_var = UHM_stability_weekly_var }
}
UHM_update_monthly_population = {
	custom_effect_tooltip = UHM_update_monthly_population_TT
	add_to_variable = { UHM_monthly_population_var = UHM_monthly_population_var }
}
UHM_update_democratic_drift = {
	custom_effect_tooltip = UHM_update_democratic_drift_TT
	add_to_variable = { UHM_democratic_drift_var = UHM_democratic_drift_var }
}
UHM_update_communism_drift = {
	custom_effect_tooltip = UHM_update_communism_drift_TT
	add_to_variable = { UHM_communism_drift_var = UHM_communism_drift_var }
}
UHM_update_nationalist_drift = {
	custom_effect_tooltip = UHM_update_nationalist_drift_TT
	add_to_variable = { UHM_nationalist_drift_var = UHM_nationalist_drift_var }
}
UHM_update_consumer_goods_factor = {
	custom_effect_tooltip = UHM_update_consumer_goods_factor_TT
	add_to_variable = { UHM_consumer_goods_factor_var = UHM_consumer_goods_factor_var }
}
UHM_update_buildings_speed = {
	custom_effect_tooltip = UHM_update_buildings_speed_TT
	add_to_variable = { UHM_buildings_speed_var = UHM_buildings_speed_var }
}
UHM_update_industry_free_repair = {
	custom_effect_tooltip = UHM_update_industry_free_repair_TT
	add_to_variable = { UHM_industry_free_repair_var = UHM_industry_free_repair_var }
}

#Triads
triads_update_political_power_factor = {
	custom_effect_tooltip = triads_update_pp_cost_TT
	add_to_variable = { triads_political_power_cost_var = triads_political_power_cost_var }
}
triads_update_stability_factor = {
	custom_effect_tooltip = triads_update_stability_factor_TT
	add_to_variable = { triads_stability_factor_var = triads_stability_factor_var }
}
triads_update_stability_weekly = {
	custom_effect_tooltip = triads_update_stability_weekly_TT
	add_to_variable = { triads_stability_weekly_var = triads_stability_weekly_var }
}
triads_update_drift_defence_factor = {
	custom_effect_tooltip = triads_update_drift_defence_factor_TT
	add_to_variable = { triads_drift_defence_factor_var = triads_drift_defence_factor_var }
}
triads_update_drift_defence_factor = {
	custom_effect_tooltip = triads_update_drift_defence_factor_TT
	add_to_variable = { triads_drift_defence_factor_var = triads_drift_defence_factor_var }
}
triads_update_trade_opinion = {
	custom_effect_tooltip = triads_update_trade_opinion_TT
	add_to_variable = { triads_trade_opinion_factor_var = triads_trade_opinion_factor_var }
}
triads_update_communism_drift = {
	custom_effect_tooltip = triads_update_communism_drift_TT
	add_to_variable = { triads_communism_drift_var = triads_communism_drift_var }
}
triads_update_nationalist_drift = {
	custom_effect_tooltip = triads_update_nationalist_drift_TT
	add_to_variable = { triads_nationalist_drift_var = triads_nationalist_drift_var }
}
triads_update_corruption_cost_factor_var = {
	custom_effect_tooltip = triads_update_corruption_cost_factor_var_TT
	add_to_variable = { triads_update_corruption_cost_factor_var = triads_update_corruption_cost_factor_var }
}

# set_temp_variable = { modify_triad_evidance = +- }
HKG_modify_triad_evidance = {
	add_to_variable = { HKG_triad_evidance = HKG_modify_triad_evidance }
	clamp_variable = {
		var = HKG_triad_evidance
		min = 0
		max = 50
	}
	custom_effect_tooltip = HKG_modify_triad_evidance_tt
}

HKG_modify_triad_strength = {
	add_to_variable = { HKG_triad_strength = HKG_modify_triad_strength }
	clamp_variable = {
		var = HKG_triad_strength
		min = 0
		max = 100
	}
	custom_effect_tooltip = HKG_modify_triad_strength_tt
}