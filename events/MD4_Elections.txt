add_namespace = MD4_election
add_namespace = western_win
add_namespace = emerging_win
add_namespace = salafist_win
add_namespace = non_alligned_win
add_namespace = nationalist_win
add_namespace = News_MD4_election

country_event = {
    id = MD4_election.0

	hidden = yes
    is_triggered_only = yes
	
	trigger = {
		NOT = { 
			OR = {
				tag = BRA
				tag = USA
			}
		}
	}
	
	immediate  = {
		determine_largest_outlook = yes
	}
		
	option = {
	}
}

country_event = {
    id = western_win.0
	title = western_win.0.t
	desc = western_win.0.d
	picture = GFX_election_day
	
    is_triggered_only = yes
	
	immediate  = {
		
	}
		
	option = {
		name = western_win.0.a
		ai_chance = { factor = 100 }
		trigger = { has_government = democratic }
		country_event = { id = MD4_election.1 }
	}
	option = {
		name = western_win.0.b
		ai_chance = { factor = 80 }
		trigger = { NOT = { has_government = democratic } }
		retire_country_leader = yes
		set_country_flag = { flag = approval_rating value = 50 }
		set_politics = {
					ruling_party = democratic
				}
	}
	option = {
		name = western_win.0.c
		ai_chance = { factor = 20 }
		trigger = { NOT = { has_government = democratic } }
		increase_corruption = yes
		add_popularity = {
		ideology = democratic
		popularity = 0.10
		}
		country_event = { id = MD4_election.1 }
	}
}

country_event = {
    id = emerging_win.0
	title = emerging_win.0.t
	desc = emerging_win.0.d
	picture = GFX_election_day

    is_triggered_only = yes
	
	immediate  = {
		
	}
		
	option = {
		name = emerging_win.0.a
		ai_chance = { factor = 100 }
		trigger = { has_government = communism }
		country_event = { id = MD4_election.1 }
	}
	option = {
		name = emerging_win.0.b
		ai_chance = { factor = 80 }
		trigger = { NOT = { has_government = communism } }
		retire_country_leader = yes
		set_country_flag = { flag = approval_rating value = 50 }
		set_politics = {
					ruling_party = communism
				}
	}
	option = {
		name = emerging_win.0.c
		ai_chance = { factor = 20 }
		trigger = { NOT = { has_government = communism } }
		increase_corruption = yes
		add_popularity = {
		ideology = communism
		popularity = 0.10
		}
		country_event = { id = MD4_election.1 }
	}
}

country_event = {
    id = salafist_win.0
	title = salafist_win.0.t
	desc = salafist_win.0.d
	picture = GFX_election_day

    is_triggered_only = yes
	
	immediate  = {
		
	}
		
	option = {
		name = salafist_win.0.a
		ai_chance = { factor = 100 }
		trigger = { has_government = fascism }
		country_event = { id = MD4_election.1 }
	}
	option = {
		name = salafist_win.0.b
		ai_chance = { factor = 0 }
		trigger = { NOT = { has_government = fascism } }
		retire_country_leader = yes
		set_country_flag = { flag = approval_rating value = 50 }
		set_politics = {
					ruling_party = fascism
					elections_allowed = no
				}
	}
	option = {
		name = salafist_win.0.c
		ai_chance = { factor = 100 }
		trigger = { NOT = { has_government = fascism } }
		increase_corruption = yes
		add_popularity = {
		ideology = fascism
		popularity = 0.10
		}
		country_event = { id = MD4_election.1 }
	}
}

country_event = {
    id = non_alligned_win.0
	title = non_alligned_win.0.t
	desc = non_alligned_win.0.d
	picture = GFX_election_day

    is_triggered_only = yes
	
	immediate  = {
		
	}
		
	option = {
		name = non_alligned_win.0.a
		ai_chance = { factor = 100 }
		trigger = { has_government = neutrality }
		country_event = { id = MD4_election.1 }
	}
	option = {
		name = non_alligned_win.0.b
		ai_chance = { factor = 80 }
		trigger = { NOT = { has_government = neutrality } }
		retire_country_leader = yes
		set_country_flag = { flag = approval_rating value = 50 }
		set_politics = {
					ruling_party = neutrality
				}
	}
	option = {
		name = non_alligned_win.0.c
		ai_chance = { factor = 20 }
		trigger = { NOT = { has_government = neutrality } }
		increase_corruption = yes
		add_popularity = {
		ideology = neutrality
		popularity = 0.10
		}
		country_event = { id = MD4_election.1 }
	}
}

country_event = {
    id = nationalist_win.0
	title = nationalist_win.0.t
	desc = nationalist_win.0.d
	picture = GFX_election_day

    is_triggered_only = yes
	
	immediate  = {
		
	}
		
	option = {
		name = nationalist_win.0.a
		ai_chance = { factor = 100 }
		trigger = { has_government = Nationalist }
		country_event = { id = MD4_election.1 }
	}
	option = {
		name = nationalist_win.0.b
		ai_chance = { factor = 80 }
		trigger = { NOT = { has_government = Nationalist } }
		retire_country_leader = yes
		set_country_flag = { flag = approval_rating value = 50 }
		set_politics = {
					ruling_party = Nationalist
				}
	}
	option = {
		name = nationalist_win.0.c
		ai_chance = { factor = 20 }
		trigger = { NOT = { has_government = Nationalist } }
		increase_corruption = yes
		add_popularity = {
		ideology = Nationalist
		popularity = 0.10
		}
		country_event = { id = MD4_election.1 }
	}
}

#forming gov setup event
country_event = {
    id = MD4_election.1

	hidden = yes
    is_triggered_only = yes
	
	immediate  = {
		if = {
			limit = { 
				has_country_flag = {
					flag = approval_rating
					value > 50
				}
			}
			country_event = { days = 2 id = MD4_election.2 } #Won
			else = {
				if = {
					limit = {
						and = {
							has_country_flag = {
								flag = approval_rating
								value > 49
							}
							has_country_flag = {
								flag = approval_rating
								value < 51
							}
						}
					}
					random_list = {
								50 = {
								country_event = { days = 2 id = MD4_election.2 }
								}
								50 = {
								country_event = { days = 2 id = MD4_election.3 } #narrow loss
								}
					}
					else = {
						country_event = { days = 2 id = MD4_election.4 } #lost!
					}
				}
			}
		}
	}
		
	option = {
	}
}

### Winning! ###
country_event = {
    id = MD4_election.2
	title = MD4_election.2.t
	desc = MD4_election.2.d
	picture = GFX_election_rally
	
    is_triggered_only = yes
	
	immediate  = { }
		
	option = {
		name = MD4_election.2.a
		add_political_power = 150
		hidden_effect = { news_event = { days = 1 id = News_MD4_election.0 } }
		if = {
			limit = {
				is_North_America = yes
				is_major = no
			}
			every_country = {
				limit = { is_North_America = yes }
				news_event = {  days = 1 id = News_MD4_election.0 }
			}
		}
		if = {
			limit = {
				is_South_America = yes
				is_major = no
			}
			every_country = {
				limit = { is_South_America = yes }
				news_event = {  days = 1 id = News_MD4_election.0 }
			}
		}
		if = {
			limit = {
				is_Middle_East = yes
				is_major = no
			}
			every_country = {
				limit = { is_Middle_East = yes }
				news_event = {  days = 1 id = News_MD4_election.0 } 
			}
		}
		if = {
			limit = {
				is_african_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_african_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.0 } 
			}
		}
		if = {
			limit = {
				 is_european_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_european_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.0 } 
			}
		}
		if = {
			limit = {
				is_asian_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_asian_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.0 } 
			}
		}
		if = {
			limit = {
				is_oceania_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_oceania_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.0 } 
			}
		}
		if = {
			limit = {
				is_major = yes
			}
			every_country = {
				news_event = {  days = 1 id = News_MD4_election.0 } 
			}
		}
		
	}
}

### Narrow loss! ###
country_event = {
    id = MD4_election.3
	title = MD4_election.3.t
	desc = MD4_election.3.d
	picture = GFX_election_rally
	
    is_triggered_only = yes
	
	immediate  = { }
		
	option = {
		name = MD4_election.3.a
		ai_chance = { factor = 48 }
		retire_country_leader = yes
		set_country_flag = { flag = approval_rating value = 50 }
		approval_rating_update = yes
		hidden_effect = { news_event = { days = 1 id = News_MD4_election.1 } }
		if = {
			limit = {
				is_North_America = yes
				is_major = no
			}
			every_country = {
				limit = { is_North_America = yes }
				news_event = {  days = 1 id = News_MD4_election.1 } 
			}
		}
		if = {
			limit = {
				is_South_America = yes
				is_major = no
			}
			every_country = {
				limit = { is_South_America = yes }
				news_event = {  days = 1 id = News_MD4_election.1 } 
			}
		}
		if = {
			limit = {
				is_Middle_East = yes
				is_major = no
			}
			every_country = {
				limit = { is_Middle_East = yes }
				news_event = {  days = 1 id = News_MD4_election.1 } 
			}
		}
		if = {
			limit = {
				is_african_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_african_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.1 } 
			}
		}
		if = {
			limit = {
				 is_european_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_european_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.1 } 
			}
		}
		if = {
			limit = {
				is_asian_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_asian_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.1 } 
			}
		}
		if = {
			limit = {
				is_oceania_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_oceania_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.1 } 
			}
		}
		if = {
			limit = {
				is_major = yes
			}
			every_country = {
				news_event = {  days = 1 id = News_MD4_election.1 } 
			}
		}
		
	}
	option = {
		name = MD4_election.3.b
		ai_chance = { factor = 50 }
		add_political_power = -50
		random_list = {
					40 = {
					country_event = { days = 3 id = MD4_election.2 }
					}
					60 = {
					country_event = { days = 3 id = MD4_election.4 } #loss!
					}
		}
	}
	option = {
		name = MD4_election.3.c
		ai_chance = { factor = 2 }
		add_political_power = -50
		relative_change_neg_10 = yes
			hidden_effect = { news_event = { days = 1 id = News_MD4_election.3 } }
		if = {
			limit = {
				is_North_America = yes
				is_major = no
			}
			every_country = {
				limit = { is_North_America = yes }
				news_event = {  days = 1 id = News_MD4_election.3 } 
			}
		}
		if = {
			limit = {
				is_South_America = yes
				is_major = no
			}
			every_country = {
				limit = { is_South_America = yes }
				news_event = {  days = 1 id = News_MD4_election.3 } 
			}
		}
		if = {
			limit = {
				is_Middle_East = yes
				is_major = no
			}
			every_country = {
				limit = { is_Middle_East = yes }
				news_event = {  days = 1 id = News_MD4_election.3 } 
			}
		}
		if = {
			limit = {
				is_african_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_african_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.3 } 
			}
		}
		if = {
			limit = {
				 is_european_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_european_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.3 } 
			}
		}
		if = {
			limit = {
				is_asian_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_asian_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.3 } 
			}
		}
		if = {
			limit = {
				is_oceania_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_oceania_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.3 } 
			}
		}
		if = {
			limit = {
				is_major = yes
			}
			every_country = {
				news_event = {  days = 1 id = News_MD4_election.3 } 
			}
		}
		
	}
}

### Election loss! ###
country_event = {
    id = MD4_election.4
	title = MD4_election.4.t
	desc = MD4_election.4.d
	picture = GFX_election_hyperthink
	
    is_triggered_only = yes
	
	immediate  = { }
		
	option = {
		name = MD4_election.4.a
		ai_chance = { factor = 99 }
		retire_country_leader = yes
		set_country_flag = { flag = approval_rating value = 50 }
		approval_rating_update = yes
		hidden_effect = { news_event = { days = 1 id = News_MD4_election.1 } }
		if = {
			limit = {
				is_North_America = yes
				is_major = no
			}
			every_country = {
				limit = { is_North_America = yes }
				news_event = {  days = 1 id = News_MD4_election.1 } 
			}
		}
		if = {
			limit = {
				is_South_America = yes
				is_major = no
			}
			every_country = {
				limit = { is_South_America = yes }
				news_event = {  days = 1 id = News_MD4_election.1 } 
			}
		}
		if = {
			limit = {
				is_Middle_East = yes
				is_major = no
			}
			every_country = {
				limit = { is_Middle_East = yes }
				news_event = {  days = 1 id = News_MD4_election.1 } 
			}
		}
		if = {
			limit = {
				is_african_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_african_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.1 } 
			}
		}
		if = {
			limit = {
				 is_european_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_european_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.1 } 
			}
		}
		if = {
			limit = {
				is_asian_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_asian_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.1 } 
			}
		}
		if = {
			limit = {
				is_oceania_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_oceania_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.1 } 
			}
		}
		if = {
			limit = {
				is_major = yes
			}
			every_country = {
				news_event = {  days = 1 id = News_MD4_election.1 } 
			}
		}
	}
	option = {
		name = MD4_election.4.b
		ai_chance = { factor = 1 }
		relative_change_neg_20 = yes
		hidden_effect = { news_event = { days = 1 id = News_MD4_election.2 } }
		if = {
			limit = {
				is_North_America = yes
				is_major = no
			}
			every_country = {
				limit = { is_North_America = yes }
				news_event = {  days = 1 id = News_MD4_election.2 } 
			}
		}
		if = {
			limit = {
				is_South_America = yes
				is_major = no
			}
			every_country = {
				limit = { is_South_America = yes }
				news_event = {  days = 1 id = News_MD4_election.2 } 
			}
		}
		if = {
			limit = {
				is_Middle_East = yes
				is_major = no
			}
			every_country = {
				limit = { is_Middle_East = yes }
				news_event = {  days = 1 id = News_MD4_election.2 } 
			}
		}
		if = {
			limit = {
				is_african_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_african_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.2 } 
			}
		}
		if = {
			limit = {
				 is_european_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_european_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.2 } 
			}
		}
		if = {
			limit = {
				is_asian_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_asian_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.2 } 
			}
		}
		if = {
			limit = {
				is_oceania_nation = yes
				is_major = no
			}
			every_country = {
				limit = { is_oceania_nation = yes }
				news_event = {  days = 1 id = News_MD4_election.2 } 
			}
		}
		if = {
			limit = {
				is_major = yes
			}
			every_country = {
				news_event = {  days = 1 id = News_MD4_election.2 } 
			}
		}
		
	}
}

news_event = {
	
	id = News_MD4_election.0
	title = News_MD4_election.0.t
	desc = News_MD4_election.0.d
	picture = GFX_news_election_rally
	
	#major = yes
	is_triggered_only = yes
	
	option = {
		name = News_MD4_election.0.a
	}
}

news_event = {
	
	id = News_MD4_election.1
	title = News_MD4_election.1.t
	desc = News_MD4_election.1.d
	picture = GFX_news_election_rally
	
	#major = yes
	is_triggered_only = yes
	
	trigger = {	
	}
	
	option = {
		name = News_MD4_election.1.a
	}
}

news_event = {
	
	id = News_MD4_election.2
	title = News_MD4_election.2.t
	desc = News_MD4_election.2.d
	picture = GFX_news_election_rally
	
	#major = yes
	is_triggered_only = yes
	
	trigger = {
	}

	option = {
		name = News_MD4_election.2.a
	}
}

news_event = {
	
	id = News_MD4_election.3
	title = News_MD4_election.3.t
	desc = News_MD4_election.3.d
	picture = GFX_news_election_rally
	
	#major = yes
	is_triggered_only = yes
	
	trigger = {
	}
	
	option = {
		name = News_MD4_election.3.a
	}
}

# TODO
# Reset Internal factions on government change
# Add happyness to certain internal factions on certain ideology taking over (make it an on_action)?
# Add pre-election events
#
#
