# AI Investable Assets Commands
# Used in 00_influence_on_actions.txt :)
# Page 1
# line One - CIC - 1, MIC - 2, NIC - 3
# Line Two - Infrastructure - 4, Offices - 5, SAM - 6, Radar - 7
# Page 2
# Line One - Air Bases - 8, Fuel Silo - 9, Internet Station - 10
# Line Two - Biofuel Refineries - 11
# Positions of Line One: { 8, 45, 82, 119 }, 45
# Positions of Line Two: { 8, 45, 82, 119 }, 76
# In scope STATE random_owned_state
# TAG = { random_owned_state = { } }

# GUI : PREV = { CONTROLLER = { } }
invest_cic = {
	ROOT = {
		set_variable = { project_building_type^-1 = 1 }
		set_variable = { project_build_amount^-1 = 1 }
		update_gui = yes
		PREV = {
			save_event_target_as = AC_state_event_target
			CONTROLLER = { country_event = { id = AC_event.10 } }
		}
	}
}

invest_mic = {
	ROOT = {
		set_variable = { project_building_type^-1 = 2 }
		set_variable = { project_build_amount^-1 = 1 }
		update_gui = yes
		PREV = {
			save_event_target_as = AC_state_event_target
			CONTROLLER = { country_event = { id = AC_event.10 } }
		}
	}
}

invest_nic = {
	PREV.PREV = {
		set_variable = { project_building_type^-1 = 3 }
		set_variable = { project_build_amount^-1 = 1 }

		PREV = {
			save_event_target_as = AC_state_event_target
			CONTROLLER = { country_event = { id = AC_event.10 } }
		}
	}
}

invest_infra = {
	ROOT = {
		set_variable = { project_building_type^-1 = 4 }
		set_variable = { project_build_amount^-1 = 1 }
		update_gui = yes
		PREV = {
			save_event_target_as = AC_state_event_target
			CONTROLLER = { country_event = { id = AC_event.10 } }
		}
	}
}

invest_offices = {
	PREV.PREV = {
		set_variable = { project_building_type^-1 = 5 }
		set_variable = { project_build_amount^-1 = 1 }

		PREV = {
			save_event_target_as = AC_state_event_target
			CONTROLLER = { country_event = { id = AC_event.10 } }
		}
	}
}

invest_anti_air = {
	PREV.PREV = {
		set_variable = { project_building_type^-1 = 6 }
		set_variable = { project_build_amount^-1 = 1 }

		PREV = {
			save_event_target_as = AC_state_event_target
			CONTROLLER = { country_event = { id = AC_event.10 } }
		}
	}
}

invest_radar = {
	PREV.PREV = {
		set_variable = { project_building_type^-1 = 7 }
		set_variable = { project_build_amount^-1 = 1 }

		PREV = {
			save_event_target_as = AC_state_event_target
			CONTROLLER = { country_event = { id = AC_event.10 } }
		}
	}
}

invest_air_bases = {
	PREV.PREV = {
		set_variable = { project_building_type^-1 = 8 }
		set_variable = { project_build_amount^-1 = 1 }

		PREV = {
			save_event_target_as = AC_state_event_target
			CONTROLLER = { country_event = { id = AC_event.10 } }
		}
	}
}

invest_fuel_silo = {
	PREV.PREV = {
		set_variable = { project_building_type^-1 = 9 }
		set_variable = { project_build_amount^-1 = 1 }

		PREV = {
			save_event_target_as = AC_state_event_target
			CONTROLLER = { country_event = { id = AC_event.10 } }
		}
	}
}

invest_internet_station = {
	PREV.PREV = {
		set_variable = { project_building_type^-1 = 10 }
		set_variable = { project_build_amount^-1 = 1 }

		PREV = {
			save_event_target_as = AC_state_event_target
			CONTROLLER = { country_event = { id = AC_event.10 } }
		}
	}
}

invest_biofuel_refinery = {
	PREV.PREV = {
		set_variable = { project_building_type^-1 = 11 }
		set_variable = { project_build_amount^-1 = 1 }

		PREV = {
			save_event_target_as = AC_state_event_target
			CONTROLLER = { country_event = { id = AC_event.10 } }
		}
	}
}

# - Bird Scoring System
AI_choose_building = {
	# Set TempVariables Needed
	set_temp_variable = { min_state_score_for_project = 100 }
	set_temp_variable = { max_build_amount = 3 }
	set_temp_variable = { max_expensive_build_amount = 1 }
	# Find the Best State for a Project
	set_temp_variable = { AI_best_score = -1 }
	set_temp_variable = { AI_best_target = -1 }
	set_temp_variable = { AI_best_type = -1 }

	# Set anti_air_flag if investing nation
	if = {
		limit = {
			any_owned_state = {
				is_controlled_by = PREV
				days_since_last_strategic_bombing < 10
			}
			any_enemy_country = {
				has_deployed_air_force_size = { size > 800 type = strategic_bomber }
			}
		}
		ROOT = { set_country_flag = AI_antiair_needed }
	}

	# Controlled States of the AI Nation
	# This section Finds the BEST possible state for investment
	for_each_scope_loop = {
		array = controlled_states

		if = {
			limit = {
				free_building_slots = { building = infrastructure size < 10 include_locked = no }
				NOT = {
					is_in_array = { array = projects_in_state value = ROOT.id }
					PREV = { has_war_with = ROOT }
				}
			}
		}

		# If the min has been achieved continue
		if = {
			limit = { check_variable = { AI_best_score > min_state_score_for_project } }
			set_variable = { project_building_type^-1 = 1 }

			# Set Building Type to Desired Building Type
			set_variable = { project_building_type^-1 = AI_best_type }

			# Set Build Amount
			set_variable = { project_build_amount^-1 = max_build_amount }

			get_building_construction_values = yes
			if = { limit = { chec}

			}
		}
	}
}

AI_get_civilian_industry_score = {
	if = { limit = { free_building_slots = { building = industrial_complex size > 0  include_locked = no } }
		# Score Modeling
		set_temp_variable = { AI_score = 0 }

		# 20 building level
		set_temp_variable = { v1 = 150 }
		set_temp_variable = { v2 = building_level@industrial_complex }
		multiply_temp_variable = { v2 = 2 }
	}
}

AI_get_infrastructure_score = {
	if = { limit = { infrastructure < 10 }
		# Score Modeling
		set_temp_variable = { AI_score = 0 }

		set_temp_variable = { v1 = 100 }
		set_temp_variable = { v2 = building_level@infrastructure } #
		multiply_temp_variable = { v2 = 10 }
		subtract_from_temp_variable = { v1 = v2 }
		add_to_temp_variable = { AI_score = v1 }

		if = { limit = { check_variable = { AI_score > AI_best_score } }
			set_temp_variable = { AI_best_score = AI_score }
			set_temp_variable = { AI_best_target = THIS.id }
			set_temp_variable = { AI_best_type = 4 }
		}
	}
	# Ignore if you have 10 infrastructure or if it breaks and you somehow got more
}
