# Author(s): Kalkalash
#Great Man Made River must now be done as a special project
sp_libya_gmmr_phase3_project = {

	specialization = specialization_nuclear

	project_tags = sp_tag_civilian

	allowed = {
		original_tag = LBA
	}

	available = {
		FROM = {
			owns_state = 1100
			controls_state = 1100
		}
	}

	breakthrough_cost = {
		specialization_nuclear = 1
	}

	prototype_time = sp_time.prototype.medium

	complexity = sp_complexity.medium

	resource_cost = {
		resources = {
			steel = 8
		}
	}

	project_output = {
		country_effects = {
			libya_upgrade_gmmr_idea_level = yes
			set_temp_variable = { temp_productivity_change = 100 }
			1100 = {
				state_flat_productivity_change_effect = yes
			}
			hidden_effect = {
				CYR = {
					swap_ideas = {
						remove_idea = LBA_great_man_made_river_phase2
						add_idea = LBA_great_man_made_river_phase3
					}
				}
			}
		}
	}

	generic_prototype_rewards = {
		sp_civilian_generic_reward_scientist_xp_1
		sp_civilian_generic_reward_scientist_xp_2
		sp_civilian_generic_reward_scientist_xp_3
		sp_civilian_generic_reward_major_progress_1
		sp_civilian_generic_reward_major_progress_2
		sp_civilian_generic_reward_major_progress_3
		sp_civilian_generic_reward_test_failure_1
		sp_civilian_generic_reward_test_failure_2
		sp_civilian_generic_reward_test_failure_3
		sp_civilian_generic_reward_resource_scarcity
		sp_civilian_generic_reward_critical_failure
		sp_libya_reward_improve_cyrenaica_opinion
		sp_libya_reward_reduce_cyrenaica_opinion
	}

	unique_prototype_rewards = {
		sp_libya_gmmr_phase3_project_reward_al_jawf_agriculture = {
			fire_only_once = yes

			threshold = {
				min = 0
				max = 100
			}

			weight = {
				base = 1
			}

			option = {
				token = sp_libya_gmmr_phase3_project_reward_al_jawf_agriculture_option_slot

				iteration_output = {
					country_effects = {
						1100 = {
							add_extra_state_shared_building_slots = 1
						}
					}
				}
			}
			option = {
				token = sp_libya_gmmr_phase3_project_reward_al_jawf_agriculture_option_productivity

				iteration_output = {
					country_effects = {
						set_temp_variable = { temp_productivity_change = 150 }
						1100 = {
							state_flat_productivity_change_effect = yes
						}
					}
				}
			}
		}
	}

	ai_will_do = {
		base = 1
	}
}

sp_libya_gmmr_phase4_west_project = {

	specialization = specialization_nuclear

	project_tags = sp_tag_civilian

	allowed = {
		original_tag = LBA
	}

	available = {
		FROM = {
			owns_state = 393
			controls_state = 393
		}
	}

	breakthrough_cost = {
		specialization_nuclear = 1
	}

	prototype_time = sp_time.prototype.long

	complexity = sp_complexity.large

	resource_cost = {
		resources = {
			steel = 8
		}
	}

	project_output = {
		country_effects = {
			libya_upgrade_gmmr_idea_level = yes
			set_temp_variable = { temp_productivity_change = 100 }
			393 = {
				state_flat_productivity_change_effect = yes
			}
			hidden_effect = {
				TRP = {
					swap_ideas = {
						remove_idea = LBA_great_man_made_river_phase2
						add_idea = LBA_great_man_made_river_phase42
					}
				}
			}
		}
	}

	generic_prototype_rewards = {
		sp_civilian_generic_reward_scientist_xp_1
		sp_civilian_generic_reward_scientist_xp_2
		sp_civilian_generic_reward_scientist_xp_3
		sp_civilian_generic_reward_major_progress_1
		sp_civilian_generic_reward_major_progress_2
		sp_civilian_generic_reward_major_progress_3
		sp_civilian_generic_reward_test_failure_1
		sp_civilian_generic_reward_test_failure_2
		sp_civilian_generic_reward_test_failure_3
		sp_civilian_generic_reward_resource_scarcity
		sp_civilian_generic_reward_critical_failure
		sp_libya_reward_improve_tripolitania_opinion
		sp_libya_reward_reduce_tripolitania_opinion
	}

	unique_prototype_rewards = {
		sp_libya_gmmr_phase4_west_project_reward_tourism = {
			fire_only_once = yes

			threshold = {
				min = 0
				max = 100
			}

			weight = {
				base = 1
			}

			option = {
				token = sp_libya_gmmr_phase4_west_project_reward_tourism_option_infra

				iteration_output = {
					country_effects = {
						393 = {
							add_building_construction = {
								type = infrastructure
								level = 1
								instant_build = yes
							}
						}
					}
				}
			}
			option = {
				token = sp_libya_gmmr_phase4_west_project_reward_tourism_option_productivity

				iteration_output = {
					country_effects = {
						set_temp_variable = { temp_productivity_change = 150 }
						393 = {
							state_flat_productivity_change_effect = yes
						}
					}
				}
			}
		}
	}

	ai_will_do = {
		base = 1
	}
}

sp_libya_gmmr_phase4_east_project = {

	specialization = specialization_nuclear

	project_tags = sp_tag_civilian

	allowed = {
		original_tag = LBA
	}

	available = {
		FROM = {
			owns_state = 396
			controls_state = 396
		}
	}

	breakthrough_cost = {
		specialization_nuclear = 1
	}

	prototype_time = sp_time.prototype.long

	complexity = sp_complexity.large

	resource_cost = {
		resources = {
			steel = 8
		}
	}

	project_output = {
		country_effects = {
			libya_upgrade_gmmr_idea_level = yes
			set_temp_variable = { temp_productivity_change = 100 }
			396 = {
				state_flat_productivity_change_effect = yes
			}
			hidden_effect = {
				CYR = {
					swap_ideas = {
						remove_idea = LBA_great_man_made_river_phase3
						add_idea = LBA_great_man_made_river_phase42
					}
				}
			}
		}
	}

	generic_prototype_rewards = {
		sp_civilian_generic_reward_scientist_xp_1
		sp_civilian_generic_reward_scientist_xp_2
		sp_civilian_generic_reward_scientist_xp_3
		sp_civilian_generic_reward_major_progress_1
		sp_civilian_generic_reward_major_progress_2
		sp_civilian_generic_reward_major_progress_3
		sp_civilian_generic_reward_test_failure_1
		sp_civilian_generic_reward_test_failure_2
		sp_civilian_generic_reward_test_failure_3
		sp_civilian_generic_reward_resource_scarcity
		sp_civilian_generic_reward_critical_failure
		sp_libya_reward_improve_cyrenaica_opinion
		sp_libya_reward_reduce_cyrenaica_opinion
	}

	unique_prototype_rewards = {
		sp_libya_gmmr_phase4_east_project_reward_treasures = {
			fire_only_once = yes

			threshold = {
				min = 0
				max = 100
			}

			weight = {
				base = 1
			}

			option = {
				token = sp_libya_gmmr_phase4_east_project_reward_treasures_option_bonus

				iteration_output = {
					country_effects = {
						add_stability = 0.05
						add_war_support = 0.05
						add_political_power = 100
					}
				}
			}
			option = {
				token = sp_libya_gmmr_phase4_east_project_reward_treasures_option_productivity

				iteration_output = {
					country_effects = {
						set_temp_variable = { temp_productivity_change = 150 }
						396 = {
							state_flat_productivity_change_effect = yes
						}
					}
				}
			}
		}
	}

	ai_will_do = {
		base = 1
	}
}

sp_libya_gmmr_phase5_project = {

	specialization = specialization_nuclear

	project_tags = sp_tag_civilian

	allowed = {
		original_tag = LBA
	}

	available = {
		FROM = {
			owns_state = 919
			controls_state = 919
		}
	}

	breakthrough_cost = {
		specialization_nuclear = 1
	}

	prototype_time = sp_time.prototype.long

	complexity = sp_complexity.large

	resource_cost = {
		resources = {
			steel = 8
		}
	}

	project_output = {
		country_effects = {
			libya_upgrade_gmmr_idea_level = yes
			set_temp_variable = { temp_productivity_change = 100 }
			919 = {
				state_flat_productivity_change_effect = yes
			}
			hidden_effect = {
				TRP = {
					swap_ideas = {
						remove_idea = LBA_great_man_made_river_phase42
						add_idea = LBA_great_man_made_river_phase5
					}
				}
				CYR = {
					swap_ideas = {
						remove_idea = LBA_great_man_made_river_phase42
						add_idea = LBA_great_man_made_river_phase5
					}
				}
			}
		}
	}

	generic_prototype_rewards = {
		sp_civilian_generic_reward_scientist_xp_1
		sp_civilian_generic_reward_scientist_xp_2
		sp_civilian_generic_reward_scientist_xp_3
		sp_civilian_generic_reward_major_progress_1
		sp_civilian_generic_reward_major_progress_2
		sp_civilian_generic_reward_major_progress_3
		sp_civilian_generic_reward_test_failure_1
		sp_civilian_generic_reward_test_failure_2
		sp_civilian_generic_reward_test_failure_3
		sp_civilian_generic_reward_resource_scarcity
		sp_civilian_generic_reward_critical_failure
		sp_libya_reward_improve_tripolitania_opinion
		sp_libya_reward_reduce_tripolitania_opinion
	}

	unique_prototype_rewards = {
		sp_libya_gmmr_phase5_project_reward_investment = {
			fire_only_once = yes

			threshold = {
				min = 0
				max = 100
			}

			weight = {
				base = 1
			}

			option = {
				token = sp_libya_gmmr_phase5_project_reward_investment_option_airport

				iteration_output = {
					country_effects = {
						919 = {
							add_building_construction = {
								type = air_base
								level = 2
								instant_build = yes
							}
						}
					}
				}
			}
			option = {
				token = sp_libya_gmmr_phase5_project_reward_investment_option_naval_base

				iteration_output = {
					country_effects = {
						919 = {
							add_building_construction = {
								type = naval_base
								level = 3
								instant_build = yes
								province = 4047
							}
						}
					}
				}
			}
		}
	}

	ai_will_do = {
		base = 1
	}
}
