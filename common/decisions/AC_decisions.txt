############################################################################################################
#	AC mod - decisions
############################################################################################################

AC_DECISIONS = {

	AC_assist_repair_decision = {
		icon = GFX_decision_category_generic

		highlight_states = {
			CONTROLLER = {
				has_country_flag = AC_assist_repair_target_by_@ROOT
			}
		}

		visible = {
			has_decision = AC_assist_repair_decision
		}

		cancel_trigger = {
			hidden_trigger = {
				NOT = {
					any_country = {
						has_country_flag = AC_assist_repair_target_by_@ROOT
					}
				}
			}
		}

		modifier = {
			political_power_gain = -1
		}

		cost = 0

		days_remove = 180

		remove_effect = {
			every_country = {
				limit = { has_country_flag = AC_assist_repair_target_by_@ROOT }

				remove_ideas = AC_assist_repair_target_idea

				clr_country_flag = AC_assist_repair_target_by_@ROOT
			}
		}

		ai_will_do = {
			factor = 0
		}
	}

	AC_assist_repair_CANCEL_decision = {
		icon = GFX_decision_category_generic_crisis

		visible = {
			has_decision = AC_assist_repair_decision
		}

		cost = 0

		complete_effect = {
			every_country = {
				limit = { has_country_flag = AC_assist_repair_target_by_@ROOT }

				remove_ideas = AC_assist_repair_target_idea

				clr_country_flag = AC_assist_repair_target_by_@ROOT
			}
		}

		ai_will_do = {
			factor = 0
		}
	}

	###################################################

	AC_construction_CIC_decision1 = { #civilian factories
		icon = GFX_decision_category_generic

		highlight_states = {
			is_owned_by = FROM
			has_state_flag = AC_construction_CIC_target_state1_@ROOT
		}
		target_trigger = {
			exists = yes
			FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state1_@ROOT } }
		}

		visible = {
			has_decision = AC_construction_CIC_decision1
		}

		cancel_trigger = {
			hidden_trigger = {
				NOT = {
					FROM = { not = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state1_@ROOT } } }
				}
			}
		}

		cost = 0

		days_remove = AC_construction_duration

		modifier = {
			#civilian_factory_use = 1
		}

		remove_effect = {
			if = { # check state eligibility
				limit = {
					FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state1_@ROOT free_building_slots = { building = industrial_complex size > 0 include_locked = no } } }
					#check_variable = { AC_active_project_building_type_6_@ROOT.ROOT = 1 }
					#AC_building_slot_available = yes
				}
				FROM = {
					random_owned_state = {
						limit = { has_state_flag = AC_construction_CIC_target_state1_@ROOT }

						add_building_construction = { type = industrial_complex level = 1 instant_build = yes }
						save_event_target_as = AC_state_event_target
					}
				}

				#hidden_effect = { # repeat until queue is finished
					if = {
						limit = {
							check_variable = { AC_build_amount_queue > 1 }
							
							FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state1_@ROOT free_building_slots = { building = industrial_complex size > 0 include_locked = no } } }
						}

						### reduce queue

						add_to_variable = { AC_build_amount_queue = -1 }
						
						### recalculate building speed

						AC_recalculate_CIC_construction_duration = yes

						### reactivate project

						activate_decision = AC_construction_CIC_decision1
						FROM = {
							random_owned_state = { # reactivate target project
								limit = { has_state_flag = AC_construction_CIC_target_state1_@ROOT }

								CONTROLLER = {
									set_variable = { AC_target_construction_duration = Root.AC_construction_duration }

									remove_targeted_decision = { target = ROOT decision = AC_construction_target_decision3 }

									activate_targeted_decision = { target = ROOT decision = AC_construction_target_decision3 }
								}
							}
						}

						else = {
							FROM = {
								random_owned_state = {
									limit = { has_state_flag = AC_construction_CIC_target_state1_@ROOT }

									clr_state_flag = AC_construction_CIC_target_state1_@ROOT
									clear_variable = AC_build_amount_queue
								}
								country_event = { id = AC_event.3 }
							}
						}
					}
				#}
			}
			else = { # failure
				hidden_effect = {
					FROM = {
						random_owned_state = {
							limit = { has_state_flag = AC_construction_CIC_target_state1_@ROOT }

							clr_state_flag = AC_construction_CIC_target_state1_@ROOT
							clear_variable = AC_build_amount_queue
						}
					}
				}
			}
		}

		ai_will_do = {
			factor = 0
		}
	}
	AC_construction_CIC_decision2 = { #civilian factories
		icon = GFX_decision_category_generic

		highlight_states = {
			is_owned_by = FROM
			has_state_flag = AC_construction_CIC_target_state2_@ROOT
		}
		target_trigger = {
			exists = yes
			FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state2_@ROOT } }
		}

		visible = {
			has_decision = AC_construction_CIC_decision2
		}

		cancel_trigger = {
			#hidden_trigger = {
				#NOT = {
				#	FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state1_@ROOT } }
				#}
			#}
		}

		cost = 0

		days_remove = AC_construction_duration

		modifier = {
			#civilian_factory_use = 1
		}

		remove_effect = {
			if = { # check state eligibility
				limit = {
					FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state2_@ROOT free_building_slots = { building = industrial_complex size > 0 include_locked = no } } }
					#check_variable = { AC_active_project_building_type_6_@ROOT.ROOT = 1 }
					#AC_building_slot_available = yes
				}
				FROM = {
					random_owned_state = {
						limit = { has_state_flag = AC_construction_CIC_target_state2_@ROOT }

						add_building_construction = { type = industrial_complex level = 1 instant_build = yes }
						save_event_target_as = AC_state_event_target
					}
				}

				#hidden_effect = { # repeat until queue is finished
					if = {
						limit = {
							check_variable = { AC_build_amount_queue > 1 }
							
							FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state2_@ROOT free_building_slots = { building = industrial_complex size > 0 include_locked = no } } }
						}

						### reduce queue

						add_to_variable = { AC_build_amount_queue = -1 }
						
						### recalculate building speed

						AC_recalculate_CIC_construction_duration = yes

						### reactivate project

						activate_decision = AC_construction_CIC_decision2
						FROM = {
							random_owned_state = { # reactivate target project
								limit = { has_state_flag = AC_construction_CIC_target_state2_@ROOT }

								CONTROLLER = {
									set_variable = { AC_target_construction_duration = Root.AC_construction_duration }

									remove_targeted_decision = { target = ROOT decision = AC_construction_target_decision2 }

									activate_targeted_decision = { target = ROOT decision = AC_construction_target_decision2 }
								}
							}
						}

						else = {
							FROM = {
								random_owned_state = {
									limit = { has_state_flag = AC_construction_CIC_target_state2_@ROOT }

									clr_state_flag = AC_construction_CIC_target_state2_@ROOT
									clear_variable = AC_build_amount_queue
								}
								country_event = { id = AC_event.3 }
							}
						}
					}
				#}
			}
			else = { # failure
				hidden_effect = {
					FROM = {
						random_owned_state = {
							limit = { has_state_flag = AC_construction_CIC_target_state2_@ROOT }

							clr_state_flag = AC_construction_CIC_target_state2_@ROOT
							clear_variable = AC_build_amount_queue
						}
					}
				}
			}
		}

		ai_will_do = {
			factor = 0
		}
	}
	AC_construction_CIC_decision3 = { #civilian factories
		icon = GFX_decision_category_generic

		highlight_states = {
			is_owned_by = FROM
			has_state_flag = AC_construction_CIC_target_state3_@ROOT
		}
		target_trigger = {
			exists = yes
			FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state3_@ROOT } }
		}

		visible = {
			has_decision = AC_construction_CIC_decision3
		}

		cancel_trigger = {
			#hidden_trigger = {
				#NOT = {
				#	FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state3_@ROOT } }
				#}
			#}
		}

		cost = 0

		days_remove = AC_construction_duration

		modifier = {
			#civilian_factory_use = 1
		}

		remove_effect = {
			if = { # check state eligibility
				limit = {
					FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state3_@ROOT free_building_slots = { building = industrial_complex size > 0 include_locked = no } } }
					#check_variable = { AC_active_project_building_type_6_@ROOT.ROOT = 1 }
					#AC_building_slot_available = yes
				}
				FROM = {
					random_owned_state = {
						limit = { has_state_flag = AC_construction_CIC_target_state3_@ROOT }

						add_building_construction = { type = industrial_complex level = 1 instant_build = yes }
						save_event_target_as = AC_state_event_target
					}
				}

				#hidden_effect = { # repeat until queue is finished
					if = {
						limit = {
							check_variable = { AC_build_amount_queue > 1 }
							
							FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state3_@ROOT free_building_slots = { building = industrial_complex size > 0 include_locked = no } } }
						}

						### reduce queue

						add_to_variable = { AC_build_amount_queue = -1 }
						
						### recalculate building speed

						AC_recalculate_CIC_construction_duration = yes

						### reactivate project

						activate_decision = AC_construction_CIC_decision3
						FROM = {
							random_owned_state = { # reactivate target project
								limit = { has_state_flag = AC_construction_CIC_target_state3_@ROOT }

								CONTROLLER = {
									set_variable = { AC_target_construction_duration = Root.AC_construction_duration }

									remove_targeted_decision = { target = ROOT decision = AC_construction_target_decision3 }

									activate_targeted_decision = { target = ROOT decision = AC_construction_target_decision3 }
								}
							}
						}

						else = {
							FROM = {
								random_owned_state = {
									limit = { has_state_flag = AC_construction_CIC_target_state3_@ROOT }

									clr_state_flag = AC_construction_CIC_target_state3_@ROOT
									clear_variable = AC_build_amount_queue
								}
								country_event = { id = AC_event.3 }
							}
						}
					}
				#}
			}
			else = { # failure
				hidden_effect = {
					FROM = {
						random_owned_state = {
							limit = { has_state_flag = AC_construction_CIC_target_state3_@ROOT }

							clr_state_flag = AC_construction_CIC_target_state3_@ROOT
							clear_variable = AC_build_amount_queue
						}
					}
				}
			}
		}

		ai_will_do = {
			factor = 0
		}
	}
	AC_construction_CIC_decision4 = { #civilian factories
		icon = GFX_decision_category_generic

		highlight_states = {
			is_owned_by = FROM
			has_state_flag = AC_construction_CIC_target_state4_@ROOT
		}
		target_trigger = {
			exists = yes
			FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state4_@ROOT } }
		}

		visible = {
			has_decision = AC_construction_CIC_decision4
		}

		cancel_trigger = {
			#hidden_trigger = {
				#NOT = {
				#	FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state4_@ROOT } }
				#}
			#}
		}

		cost = 0

		days_remove = AC_construction_duration

		modifier = {
			#civilian_factory_use = 1
		}

		remove_effect = {
			if = { # check state eligibility
				limit = {
					FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state4_@ROOT free_building_slots = { building = industrial_complex size > 0 include_locked = no } } }
					#check_variable = { AC_active_project_building_type_6_@ROOT.ROOT = 1 }
					#AC_building_slot_available = yes
				}
				FROM = {
					random_owned_state = {
						limit = { has_state_flag = AC_construction_CIC_target_state4_@ROOT }

						add_building_construction = { type = industrial_complex level = 1 instant_build = yes }
						save_event_target_as = AC_state_event_target
					}
				}

				#hidden_effect = { # repeat until queue is finished
					if = {
						limit = {
							check_variable = { AC_build_amount_queue > 1 }
							
							FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state4_@ROOT free_building_slots = { building = industrial_complex size > 0 include_locked = no } } }
						}

						### reduce queue

						add_to_variable = { AC_build_amount_queue = -1 }
						
						### recalculate building speed

						AC_recalculate_CIC_construction_duration = yes

						### reactivate project

						activate_decision = AC_construction_CIC_decision4
						FROM = {
							random_owned_state = { # reactivate target project
								limit = { has_state_flag = AC_construction_CIC_target_state4_@ROOT }

								CONTROLLER = {
									set_variable = { AC_target_construction_duration = Root.AC_construction_duration }

									remove_targeted_decision = { target = ROOT decision = AC_construction_target_decision4 }

									activate_targeted_decision = { target = ROOT decision = AC_construction_target_decision4 }
								}
							}
						}

						else = {
							FROM = {
								random_owned_state = {
									limit = { has_state_flag = AC_construction_CIC_target_state4_@ROOT }

									clr_state_flag = AC_construction_CIC_target_state4_@ROOT
									clear_variable = AC_build_amount_queue
								}
								country_event = { id = AC_event.3 }
							}
						}
					}
				#}
			}
			else = { # failure
				hidden_effect = {
					FROM = {
						random_owned_state = {
							limit = { has_state_flag = AC_construction_CIC_target_state4_@ROOT }

							clr_state_flag = AC_construction_CIC_target_state4_@ROOT
							clear_variable = AC_build_amount_queue
						}
					}
				}
			}
		}

		ai_will_do = {
			factor = 0
		}
	}
	AC_construction_CIC_decision5 = { #civilian factories
		icon = GFX_decision_category_generic

		highlight_states = {
			is_owned_by = FROM
			has_state_flag = AC_construction_CIC_target_state5_@ROOT
		}
		target_trigger = {
			exists = yes
			FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state5_@ROOT } }
		}

		visible = {
			has_decision = AC_construction_CIC_decision5
		}

		cancel_trigger = {
			#hidden_trigger = {
				#NOT = {
				#	FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state5_@ROOT } }
				#}
			#}
		}

		cost = 0

		days_remove = AC_construction_duration

		modifier = {
			#civilian_factory_use = 1
		}

		remove_effect = {
			if = { # check state eligibility
				limit = {
					FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state5_@ROOT free_building_slots = { building = industrial_complex size > 0 include_locked = no } } }
					#check_variable = { AC_active_project_building_type_6_@ROOT.ROOT = 1 }
					#AC_building_slot_available = yes
				}
				FROM = {
					random_owned_state = {
						limit = { has_state_flag = AC_construction_CIC_target_state5_@ROOT }

						add_building_construction = { type = industrial_complex level = 1 instant_build = yes }
						save_event_target_as = AC_state_event_target
					}
				}

				#hidden_effect = { # repeat until queue is finished
					if = {
						limit = {
							check_variable = { AC_build_amount_queue > 1 }
							
							FROM = { any_owned_state = { has_state_flag = AC_construction_CIC_target_state5_@ROOT free_building_slots = { building = industrial_complex size > 0 include_locked = no } } }
						}

						### reduce queue

						add_to_variable = { AC_build_amount_queue = -1 }
						
						### recalculate building speed

						AC_recalculate_CIC_construction_duration = yes

						### reactivate project

						activate_decision = AC_construction_CIC_decision5
						FROM = {
							random_owned_state = { # reactivate target project
								limit = { has_state_flag = AC_construction_CIC_target_state5_@ROOT }

								CONTROLLER = {
									set_variable = { AC_target_construction_duration = Root.AC_construction_duration }

									remove_targeted_decision = { target = ROOT decision = AC_construction_target_decision5 }

									activate_targeted_decision = { target = ROOT decision = AC_construction_target_decision5 }
								}
							}
						}

						else = {
							FROM = {
								random_owned_state = {
									limit = { has_state_flag = AC_construction_CIC_target_state5_@ROOT }

									clr_state_flag = AC_construction_CIC_target_state5_@ROOT
									clear_variable = AC_build_amount_queue
								}
								country_event = { id = AC_event.3 }
							}
						}
					}
				#}
			}
			else = { # failure
				hidden_effect = {
					FROM = {
						random_owned_state = {
							limit = { has_state_flag = AC_construction_CIC_target_state5_@ROOT }

							clr_state_flag = AC_construction_CIC_target_state5_@ROOT
							clear_variable = AC_build_amount_queue
						}
					}
				}
			}
		}

		ai_will_do = {
			factor = 0
		}
	}
	
	
}

AC_target_country_DECISIONS = {

	AC_construction_target_decision1 = {

		allowed = { always = no }

		available = {
			
		}

		cancel_trigger = {
			hidden_trigger = {
				NOT = {
					any_owned_state = {
						is_controlled_by = ROOT
					
						has_state_flag = AC_construction_CIC_target_state1_@FROM
					}
				}
			}
		}

		highlight_states = {
			is_controlled_by = ROOT
			has_state_flag = AC_construction_CIC_target_state1_@FROM
		}

		is_good = yes

		selectable_mission = yes

		days_mission_timeout = AC_target_construction_duration

		cost = 10

		remove_effect = {

		}

		timeout_effect = {

		}

		complete_effect = { # cancel
			remove_targeted_decision = { target = FROM decision = AC_construction_target_decision1 }

			FROM = {
				hidden_effect = {
					country_event = AC_event.3

					every_state = {
						limit = { has_state_flag = AC_construction_CIC_target_state1_@PREV }

						clr_state_flag = AC_construction_CIC_target_state1_@PREV
					}

					clear_variable = AC_build_amount_queue

					clear_variable = AC_active_project_building_type_@PREV
				}
			}
		}

		ai_will_do = {
			factor = 0
		}
	}
	AC_construction_target_decision2 = {

		allowed = { always = no }

		available = {
			
		}

		cancel_trigger = {
			hidden_trigger = {
				NOT = {
					any_state = {
						is_controlled_by = ROOT
					
						has_state_flag = AC_construction_CIC_target_state2_@FROM
					}
				}
			}
		}

		highlight_states = {
			is_controlled_by = ROOT
			has_state_flag = AC_construction_CIC_target_state2_@FROM
		}

		is_good = yes

		selectable_mission = yes

		days_mission_timeout = AC_target_construction_duration

		cost = 10

		remove_effect = {

		}

		timeout_effect = {

		}

		complete_effect = { # cancel
			remove_targeted_decision = { target = FROM decision = AC_construction_target_decision2 }

			FROM = {
				hidden_effect = {
					country_event = AC_event.3

					add_political_power = AC_political_power_cost

					every_state = {
						limit = { has_state_flag = AC_construction_CIC_target_state2_@PREV }

						clr_state_flag = AC_construction_CIC_target_state2_@PREV
					}

					clear_variable = AC_build_amount_queue

					clear_variable = AC_active_project_building_type_@PREV
				}
			}
		}

		ai_will_do = {
			factor = 0
		}
	}
}