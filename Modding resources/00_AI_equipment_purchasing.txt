run_eq_purchasing_ai = {
	if = {
		limit = {
			check_variable = { debt_ratio < 0.5 }
			check_variable = { active_equipment_orders < 6 }
		}

		set_temp_variable = { order_tag = THIS }
		find_seller = yes

		# we found a seller
		if = {
			limit = { NOT = { check_variable = { order_tag = THIS } } }

			if = {
				limit = { has_equipment = { cnc_equipment < 1 } }

				log = "[GetDateText]: [THIS.GetName]: AI buying cnc equipment from [?order_tag.GetName]"

				set_temp_variable = { equipment_selected_index = token:cnc_equipment }
				set_temp_variable = { amount_selected = 110 }
				set_temp_variable = { order_purchaser_tag = order_tag }
				set_temp_variable = { timeset = 30 }
				set_temp_variable = { price = 2 }
				check_embargo = yes
			}
			if = {
				limit = {
					check_variable = { active_equipment_orders < 6 }
					has_equipment = { Inf_equipment < 1 }
				}

				log = "[GetDateText]: [THIS.GetName]: AI buying infantry equipment from [?order_tag.GetName]"

				set_temp_variable = { equipment_selected_index = token:Inf_equipment }
				set_temp_variable = { amount_selected = 300 }
				set_temp_variable = { order_purchaser_tag = order_tag }
				set_temp_variable = { timeset = 30 }
				set_temp_variable = { price = 1.25 }
				check_embargo = yes
			}
			if = {
				limit = {
					check_variable = { active_equipment_orders < 6 }
					has_equipment = { util_vehicle_equipment < 1 }
				}

				log = "[GetDateText]: [THIS.GetName]: AI buying utility vehicle equipment from [?order_tag.GetName]"

				set_temp_variable = { equipment_selected_index = token:util_vehicle_equipment }
				set_temp_variable = { amount_selected = 110 }
				set_temp_variable = { order_purchaser_tag = order_tag }
				set_temp_variable = { timeset = 60 }
				set_temp_variable = { price = 2.75 }
				check_embargo = yes
			}
			if = {
				limit = {
					check_variable = { active_equipment_orders < 6 }
					has_equipment = { spaa_hull < 1 }
				}

				log = "[GetDateText]: [THIS.GetName]: AI buying spaa equipment from [?order_tag.GetName]"

				if = {
					limit = {
						check_variable = { order_tag = SOV }
						NOT = { ENG = { has_tech = nsb_SP_Anti_Air_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:spaa_hull_1 }
				}
				else = {
					set_temp_variable = { equipment_selected_index = token:spaa_hull }
				}

				set_temp_variable = { amount_selected = 9 }
				set_temp_variable = { order_purchaser_tag = order_tag }
				set_temp_variable = { timeset = 30 }
				set_temp_variable = { price = 2 }
				check_embargo = yes
			}
			if = {
				limit = {
					check_variable = { active_equipment_orders < 6 }
					has_equipment = { mbt_hull < 1 }
				}

				log = "[GetDateText]: [THIS.GetName]: AI buying mbt equipment from [?order_tag.GetName]"

				# they do not have mbt_hull_2
				if = {
					limit = {
						check_variable = { order_tag = USA }
						NOT = { USA = { has_tech = mbt_tech_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:mbt_hull_1 }
				}
				else_if = {
					limit = {
						check_variable = { order_tag = GER }
						NOT = { GER = { has_tech = mbt_tech_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:mbt_hull_1 }
				}
				else_if = {
					limit = {
						check_variable = { order_tag = ENG }
						NOT = { ENG = { has_tech = mbt_tech_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:mbt_hull_1 }
				}
				else = {
					set_temp_variable = { equipment_selected_index = token:mbt_hull }
				}

				set_temp_variable = { amount_selected = 84 }
				set_temp_variable = { order_purchaser_tag = order_tag }
				set_temp_variable = { timeset = 180 }
				set_temp_variable = { price = 9.25 }
				check_embargo = yes
			}
			if = {
				limit = {
					check_variable = { active_equipment_orders < 6 }
					has_equipment = { ifv_hull < 1 }
				}

				log = "[GetDateText]: [THIS.GetName]: AI buying ifv equipment from [?order_tag.GetName]"

				if = {
					limit = {
						check_variable = { order_tag = USA }
						NOT = { USA = { has_tech = afv_tech_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:ifv_hull_1 }
				}
				else_if = {
					limit = {
						check_variable = { order_tag = GER }
						NOT = { GER = { has_tech = afv_tech_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:ifv_hull_1 }
				}
				else_if = {
					limit = {
						check_variable = { order_tag = FRA }
						NOT = { FRA = { has_tech = afv_tech_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:ifv_hull_1 }
				}
				else_if = {
					limit = {
						check_variable = { order_tag = ENG }
						NOT = { ENG = { has_tech = afv_tech_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:ifv_hull_1 }
				}
				else = {
					set_temp_variable = { equipment_selected_index = token:ifv_hull }
				}

				set_temp_variable = { amount_selected = 100 }
				set_temp_variable = { order_purchaser_tag = order_tag }
				set_temp_variable = { timeset = 150 }
				set_temp_variable = { price = 9 }
				check_embargo = yes
			}
			if = {
				limit = {
					check_variable = { active_equipment_orders < 6 }
					has_equipment = { apc_hull < 1 }
				}

				log = "[GetDateText]: [THIS.GetName]: AI buying apc equipment from [?order_tag.GetName]"

				if = {
					limit = {
						check_variable = { order_tag = USA }
						NOT = { USA = { has_tech = afv_tech_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:apc_hull_1 }
				}
				else_if = {
					limit = {
						check_variable = { order_tag = GER }
						NOT = { GER = { has_tech = afv_tech_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:apc_hull_1 }
				}
				else_if = {
					limit = {
						check_variable = { order_tag = SOV }
						NOT = { SOV = { has_tech = afv_tech_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:apc_hull_1 }
				}
				else_if = {
					limit = {
						check_variable = { order_tag = FRA }
						NOT = { FRA = { has_tech = afv_tech_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:apc_hull_1 }
				}
				else_if = {
					limit = {
						check_variable = { order_tag = ENG }
						NOT = { ENG = { has_tech = afv_tech_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:apc_hull_1 }
				}
				else = {
					set_temp_variable = { equipment_selected_index = token:apc_hull }
				}

				set_temp_variable = { amount_selected = 120 }
				set_temp_variable = { order_purchaser_tag = order_tag }
				set_temp_variable = { timeset = 150 }
				set_temp_variable = { price = 8.5 }
				check_embargo = yes
			}
			if = {
				limit = {
					check_variable = { active_equipment_orders < 6 }
					has_equipment = { spart_hull < 1 }
				}

				log = "[GetDateText]: [THIS.GetName]: AI buying spart equipment from [?order_tag.GetName]"

				if = {
					limit = {
						check_variable = { order_tag = USA }
						NOT = { USA = { has_tech = nsb_SP_arty_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:spart_hull_1 }
				}
				else_if = {
					limit = {
						check_variable = { order_tag = SOV }
						NOT = { SOV = { has_tech = nsb_SP_arty_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:spart_hull_1 }
				}
				else_if = {
					limit = {
						check_variable = { order_tag = GER }
						NOT = { GER = { has_tech = nsb_SP_arty_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:spart_hull_1 }
				}
				else_if = {
					limit = {
						check_variable = { order_tag = FRA }
						NOT = { FRA = { has_tech = nsb_SP_arty_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:spart_hull_1 }
				}
				else_if = {
					limit = {
						check_variable = { order_tag = ENG }
						NOT = { ENG = { has_tech = nsb_SP_arty_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:spart_hull_1 }
				}
				else_if = {
					limit = {
						check_variable = { order_tag = USA }
						NOT = { USA = { has_tech = nsb_SP_arty_3 } }
					}
					set_temp_variable = { equipment_selected_index = token:spart_hull_1 }
				}
				else = {
					set_temp_variable = { equipment_selected_index = token:spart_hull }
				}

				set_temp_variable = { amount_selected = 42 }
				set_temp_variable = { order_purchaser_tag = order_tag }
				set_temp_variable = { timeset = 90 }
				set_temp_variable = { price = 4.25 }
				check_embargo = yes
			}
			if = {
				limit = {
					check_variable = { active_equipment_orders < 6 }
					has_equipment = { H_AT_Equipment < 1 }
				}

				log = "[GetDateText]: [THIS.GetName]: AI buying heavy AT equipment from [?order_tag.GetName]"

				set_temp_variable = { equipment_selected_index = token:H_AT_Equipment }
				set_temp_variable = { amount_selected = 30 }
				set_temp_variable = { order_purchaser_tag = order_tag }
				set_temp_variable = { timeset = 30 }
				set_temp_variable = { price = 2 }
				check_embargo = yes
			}
			if = {
				limit = {
					check_variable = { active_equipment_orders < 6 }
					has_equipment = { L_AT_Equipment < 1 }
				}

				log = "[GetDateText]: [THIS.GetName]: AI buying light AT equipment from [?order_tag.GetName]"

				set_temp_variable = { equipment_selected_index = token:L_AT_Equipment }
				set_temp_variable = { amount_selected = 150 }
				set_temp_variable = { order_purchaser_tag = order_tag }
				set_temp_variable = { timeset = 30 }
				set_temp_variable = { price = 2 }
				check_embargo = yes
			}
			if = {
				limit = {
					check_variable = { active_equipment_orders < 6 }
					has_equipment = { AA_Equipment < 1 }
				}

				log = "[GetDateText]: [THIS.GetName]: AI buying manpads equipment from [?order_tag.GetName]"

				set_temp_variable = { equipment_selected_index = token:AA_Equipment }
				set_temp_variable = { amount_selected = 100 }
				set_temp_variable = { order_purchaser_tag = order_tag }
				set_temp_variable = { timeset = 30 }
				set_temp_variable = { price = 1.75 }
				check_embargo = yes
			}
			# no helis or light tanks coz many don't have any
		}
	}
}

find_seller = {
	if = {
		limit = {
			NOT = { tag = USA }
			NOT = { is_embargoed_by = USA }
			country_exists = USA
			USA = { has_opinion = { target = ROOT value > 49 } }
		}

		set_temp_variable = { order_tag = USA }
	}
	else_if = {
		limit = {
			NOT = { tag = SOV }
			NOT = { is_embargoed_by = SOV }
			country_exists = SOV
			SOV = { has_opinion = { target = ROOT value > 49 } }
		}

		set_temp_variable = { order_tag = SOV }
	}
	else_if = {
		limit = {
			NOT = { tag = FRA }
			NOT = { is_embargoed_by = FRA }
			country_exists = FRA
			FRA = { has_opinion = { target = ROOT value > 49 } }
		}

		set_temp_variable = { order_tag = FRA }
	}
	else_if = {
		limit = {
			NOT = { tag = GER }
			NOT = { is_embargoed_by = GER }
			country_exists = GER
			GER = { has_opinion = { target = ROOT value > 49 } }
		}

		set_temp_variable = { order_tag = GER }
	}
	else_if = {
		limit = {
			NOT = { tag = CHI }
			NOT = { is_embargoed_by = CHI }
			country_exists = CHI
			CHI = { has_opinion = { target = ROOT value > 49 } }
		}

		set_temp_variable = { order_tag = CHI }
	}
	else_if = {
		limit = {
			NOT = { tag = ENG }
			NOT = { is_embargoed_by = ENG }
			country_exists = ENG
			ENG = { has_opinion = { target = ROOT value > 49 } }
		}

		set_temp_variable = { order_tag = ENG }
	}
}