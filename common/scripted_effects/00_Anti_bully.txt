#Written by hiddengearz

#Used only to intialize AB system sets claim in deffender capital- modular
AB_init = {
	
	if = { 
		limit = {
			event_target:AB_DEFF = {
				has_defensive_war_with = event_target:AB_ATT
			}
		}
		
		capital_scope = {
			add_claim_by = event_target:AB_ATT
		}
		
	}
}

#Used to check if AB System is Active and
#attacker is still at war - modular
AB_war_test = {

	if = { #checks if deffender still in war
		limit = {
			event_target:AB_DEFF = {
				has_defensive_war_with = event_target:AB_ATT
				# capital_scope = {
					# is_claimed_by = event_target:AB_ATT
				# }
			}
			event_target:AB_ATT = {
				has_offensive_war_with = event_target:AB_DEFF
			}
		}
		event_target:AB_ATT = {
			set_country_flag = AB_test_true
		}

	}
	
}

#Starts peace process - modular
AB_white_peace = { 
	
	
	if = { #Ends any war
		limit = {
			event_target:AB_ATT = {	
				has_offensive_war_with = event_target:AB_DEFF
			}
		}
		event_target:AB_ATT = {
			white_peace = event_target:AB_DEFF
		}
	}
	
	if = { #call Regain national unity function for war 1
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_war1_pause}
				has_country_flag = AB_end_war1
				or = {
					has_country_flag = AB_War1_NU10
					has_country_flag = AB_War1_NU9
					has_country_flag = AB_War1_NU8
					has_country_flag = AB_War1_NU7
					has_country_flag = AB_War1_NU6
					has_country_flag = AB_War1_NU5
					has_country_flag = AB_War1_NU4
					has_country_flag = AB_War1_NU3
					has_country_flag = AB_War1_NU2
					has_country_flag = AB_War1_NU1
				}
			}
		}
		AB_regain_NU_war1 = yes
	}
	
	if = { #call Regain national unity function for war 2
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_war2_pause}
				has_country_flag = AB_end_war2
				or = {
					has_country_flag = AB_War2_NU10
					has_country_flag = AB_War2_NU9
					has_country_flag = AB_War2_NU8
					has_country_flag = AB_War2_NU7
					has_country_flag = AB_War2_NU6
					has_country_flag = AB_War2_NU5
					has_country_flag = AB_War2_NU4
					has_country_flag = AB_War2_NU3
					has_country_flag = AB_War2_NU2
					has_country_flag = AB_War2_NU1
				}
			}
		}
		AB_regain_NU_war2 = yes
	}
	
	
}

#Calculates & lower national unity - War 1
Anti_bully_l_nu = {
	
	#Checks to make sure still at war and AB active if false everything below is ignored
	AB_war_test = yes 
	
	#Anti Bully loose National Unity #1
	if = {
		limit = {
			not = {
				has_country_flag = AB_war1_pause
			}
			has_country_flag = AB_War1_NU0
			has_country_flag = AB_test_true
		}
		event_target:AB_ATT = {
			set_country_flag = AB_War1_NU1
			set_country_flag = AB_war1_pause
			clr_country_flag = AB_War1_NU0
			clr_country_flag = AB_test_true
			
			
			add_country_leader_trait = AB_1_NU1
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.3 } #Generic event loose National Unity
			
		}
	}
	
	#Anti Bully loose National Unity #2
	if = {
		limit = {
			not = {
				has_country_flag = AB_war1_pause
			}
			has_country_flag = AB_test_true
			has_country_flag = AB_War1_NU1
		}
		set_country_flag = AB_War1_NU2
		set_country_flag = AB_war1_pause
		clr_country_flag = AB_War1_NU1
		clr_country_flag = AB_test_true
		
		
		remove_country_leader_trait = AB_1_NU1
		add_country_leader_trait = AB_1_NU2
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.3 } #Generic event loose National Unity
		
		
		
	}
	#Anti Bully loose National Unity #3
	if = {
		limit = {
			not = {
				has_country_flag = AB_war1_pause
			}
			has_country_flag = AB_test_true
			has_country_flag = AB_War1_NU2
			
		}
		event_target:AB_ATT = {
			set_country_flag = AB_War1_NU3
			set_country_flag = AB_war1_pause
			clr_country_flag = AB_War1_NU2
			clr_country_flag = AB_test_true
			
			remove_country_leader_trait = AB_1_NU2
			add_country_leader_trait = AB_1_NU3
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.3 } #Generic event loose National Unity
			
			
		}
	}
	#Anti Bully loose National Unity #4
	if = {
		limit = {
			not = {
				has_country_flag = AB_war1_pause
			}
			has_country_flag = AB_test_true
			has_country_flag = AB_War1_NU3
			
		}
		event_target:AB_ATT = {
			set_country_flag = AB_War1_NU4
			set_country_flag = AB_war1_pause
			clr_country_flag = AB_War1_NU3
			clr_country_flag = AB_test_true
			
			remove_country_leader_trait = AB_1_NU3
			add_country_leader_trait = AB_1_NU4
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.3 } #Generic event loose National Unity
			
			
		}
	}
	#Anti Bully loose National Unity #5
	if = {
		limit = {
			not = {
				has_country_flag = AB_war1_pause
				has_country_flag = AB_war1_peace_1
			}
			has_country_flag = AB_test_true
			has_country_flag = AB_War1_NU4
			
			
		}
		event_target:AB_ATT = {
			set_country_flag = AB_War1_NU5
			set_country_flag = AB_war1_pause
			set_country_flag = AB_end_war1
			
			clr_country_flag = AB_War1_NU4
			clr_country_flag = AB_test_true
			
			remove_country_leader_trait = AB_1_NU4
			add_country_leader_trait = AB_1_NU5
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.3 } #Generic event loose National Unity
			
			
		}
	}
	
	#First white peace offering
	if = {
		limit = {
			not = {
				has_country_flag = AB_war1_pause
				has_country_flag = AB_war1_peace_1
			}
			has_country_flag = AB_War1_NU5
			has_country_flag = AB_test_true
		}
		event_target:AB_ATT = {
			set_country_flag = AB_war1_pause
			set_country_flag = AB_war1_peace_1
			country_event = { id = anti_bully.4 } #Attacker offers white peace
		}
		
	}
	
	#Anti Bully loose National Unity #6
	if = {
		limit = {
			not = {
				has_country_flag = AB_war1_pause
			}
			has_country_flag = AB_War1_NU5
			has_country_flag = AB_test_true
		}
		
		event_target:AB_ATT = {
			set_country_flag = AB_War1_NU6
			set_country_flag = AB_war1_pause
			
			clr_country_flag = AB_War1_NU5
			clr_country_flag = AB_test_true
			clr_country_flag = AB_end_war1
			
			remove_country_leader_trait = AB_1_NU5
			add_country_leader_trait = AB_1_NU6
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.3 } #Generic event loose National Unity
			
			
		}
	}
	
	#Anti Bully loose National Unity #7
	if = {
		limit = {
			not = {
				has_country_flag = AB_war1_pause
			}
			has_country_flag = AB_War1_NU6
			has_country_flag = AB_test_true
		}
		
		event_target:AB_ATT = {
			set_country_flag = AB_War1_NU7
			set_country_flag = AB_war1_pause
			
			clr_country_flag = AB_War1_NU6
			clr_country_flag = AB_test_true
			
			remove_country_leader_trait = AB_1_NU6
			add_country_leader_trait = AB_1_NU7
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.3 } #Generic event loose National Unity
			
			
		}
	}
	#Anti Bully loose National Unity #8
	if = {
		limit = {
			not = {
				has_country_flag = AB_war1_pause
				has_country_flag = AB_war1_peace_2
			}
			has_country_flag = AB_War1_NU7
			has_country_flag = AB_test_true
		}
		
		event_target:AB_ATT = {
			set_country_flag = AB_War1_NU8
			set_country_flag = AB_war1_pause
			set_country_flag = AB_end_war1
			
			clr_country_flag = AB_War1_NU7
			clr_country_flag = AB_test_true
			
			remove_country_leader_trait = AB_1_NU7
			add_country_leader_trait = AB_1_NU8
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.3 } #Generic event loose National Unity
			
			
		}
	}
	
	#Second white peace offering - if attacker offers white peace and gets declined
	#attacker starts to regain NU as its a real war now
	if = {
		limit = {
			not = {
				has_country_flag = AB_war1_pause
				has_country_flag = AB_war1_peace_2
			}
			has_country_flag = AB_War1_NU8
			has_country_flag = AB_test_true
		}
		event_target:AB_ATT = {
			set_country_flag = AB_war1_pause
			set_country_flag = AB_war1_peace_2
			country_event = { days = 2 id = anti_bully.4 } #Attacker offers white peace
		}
		
	}
	
	#Anti Bully loose National Unity #9
	if = {
		limit = {
			not = {
				has_country_flag = AB_war1_pause
			}
			has_country_flag = AB_War1_NU8
			has_country_flag = AB_test_true
		}
		
		event_target:AB_ATT = {
			set_country_flag = AB_War1_NU9
			set_country_flag = AB_war1_pause
			
			clr_country_flag = AB_War1_NU8
			clr_country_flag = AB_test_true
			clr_country_flag = AB_end_war1
			
			remove_country_leader_trait = AB_1_NU8
			add_country_leader_trait = AB_1_NU9
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.3 } #Generic event loose National Unity
			
			
		}
	}
	
	#Anti Bully loose National Unity #10
	if = {
		limit = {
			not = {
				has_country_flag = AB_war1_pause
			}
			has_country_flag = AB_War1_NU9
			has_country_flag = AB_test_true
		}
		
		event_target:AB_ATT = {
			set_country_flag = AB_War1_NU10
			set_country_flag = AB_war1_pause
			
			clr_country_flag = AB_War1_NU9
			clr_country_flag = AB_test_true
			
			remove_country_leader_trait = AB_1_NU9
			add_country_leader_trait = AB_1_NU10
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.3 } #Generic event loose National Unity
			
			
		}
	}
	
	#Attacker has max -nu have to contiuiosly check to see if the war is over
	#So we can start to give back their NU
	if = {
		limit = {
			event_target:AB_ATT = {
				has_country_flag = AB_War1_NU10
				has_country_flag = AB_test_true
			}
		}
		event_target:AB_ATT = {
			clr_country_flag = AB_test_true
			set_country_flag = AB_war1_pause
			country_event = { days = 30 id = anti_bully.8 }
		}
	}
	
	
	if = { #if not in war start returning national unity - war1
		limit = {
			event_target:AB_ATT = {
				not = {
					has_country_flag = AB_test_true
					has_country_flag = AB_war1_pause 
				}
				
			}
		}
		event_target:AB_ATT = {
			clr_country_flag = AB_test_true
			set_country_flag = AB_end_war1
			AB_regain_NU_war1 = yes
		}

	}
}

#regain national unity for - war 1
AB_regain_NU_war1 = {

	if = {
		limit = {
			event_target:AB_ATT = {
				not = {
					has_country_flag = AB_war1_pause
					has_country_flag = AB_war1_NU_start
				}
				has_country_flag = AB_end_war1
				or = {
					has_country_flag = AB_War1_NU10
					has_country_flag = AB_War1_NU9
					has_country_flag = AB_War1_NU8
					has_country_flag = AB_War1_NU7
					has_country_flag = AB_War1_NU6
					has_country_flag = AB_War1_NU5
					has_country_flag = AB_War1_NU4
					has_country_flag = AB_War1_NU3
					has_country_flag = AB_War1_NU2
					has_country_flag = AB_War1_NU1
					
				}
			}
			
		}
		set_country_flag = AB_war1_pause
		set_country_flag = AB_war1_NU_start
		country_event = { days = 30 id = anti_bully.7 }
	}
	
	if = { #lower national unity penalty from #10 - 9
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_war1_pause}
				has_country_flag = AB_end_war1
				has_country_flag = AB_War1_NU10
			}
		}
		
		set_country_flag = AB_war1_pause
		clr_country_flag = AB_War1_NU10
		set_country_flag = AB_War1_NU9
		add_country_leader_trait = AB_1_NU9
		remove_country_leader_trait = AB_1_NU10
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.7 }
	}
	if = { #lower national unity penalty from #9 - 8
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_war1_pause}
				has_country_flag = AB_end_war1
				has_country_flag = AB_War1_NU9
			}
		}
		
		set_country_flag = AB_war1_pause
		clr_country_flag = AB_War1_NU9
		set_country_flag = AB_War1_NU8
		add_country_leader_trait = AB_1_NU8
		remove_country_leader_trait = AB_1_NU9
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.7 }
	}
	if = { #lower national unity penalty from #8 - 7
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_war1_pause}
				has_country_flag = AB_end_war1
				has_country_flag = AB_War1_NU8
			}
		}
		
		set_country_flag = AB_war1_pause
		clr_country_flag = AB_War1_NU8
		set_country_flag = AB_War1_NU7
		add_country_leader_trait = AB_1_NU7
		remove_country_leader_trait = AB_1_NU8
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.7 }
	}
	if = { #lower national unity penalty from #7 - 6
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_war1_pause}
				has_country_flag = AB_end_war1
				has_country_flag = AB_War1_NU7
			}
		}
		
		set_country_flag = AB_war1_pause
		clr_country_flag = AB_War1_NU7
		set_country_flag = AB_War1_NU6
		add_country_leader_trait = AB_1_NU6
		remove_country_leader_trait = AB_1_NU7
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.7 }
	}
	if = { #lower national unity penalty from #6 - 5
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_war1_pause}
				has_country_flag = AB_end_war1
				has_country_flag = AB_War1_NU6
			}
		}
		
		set_country_flag = AB_war1_pause
		clr_country_flag = AB_War1_NU6
		set_country_flag = AB_War1_NU5
		add_country_leader_trait = AB_1_NU5
		remove_country_leader_trait = AB_1_NU6
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.7 }
	}
	if = { #lower national unity penalty from #5 - 4
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_war1_pause}
				has_country_flag = AB_end_war1
				has_country_flag = AB_War1_NU5
			}
		}
		
		set_country_flag = AB_war1_pause
		clr_country_flag = AB_War1_NU5
		set_country_flag = AB_War1_NU4
		add_country_leader_trait = AB_1_NU4
		remove_country_leader_trait = AB_1_NU5
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.7 }
	}
	
	if = { #lower national unity penalty from #4 - 3
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_war1_pause}
				has_country_flag = AB_end_war1
				has_country_flag = AB_War1_NU4
			}
		}
		
		set_country_flag = AB_war1_pause
		clr_country_flag = AB_War1_NU4
		set_country_flag = AB_War1_NU3
		add_country_leader_trait = AB_1_NU3
		remove_country_leader_trait = AB_1_NU4
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.7 }
	}
	
	if = { #lower national unity penalty from #3 - 2
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_war1_pause}
				has_country_flag = AB_end_war1
				has_country_flag = AB_War1_NU3
			}
		}
		
		set_country_flag = AB_war1_pause
		clr_country_flag = AB_War1_NU3
		set_country_flag = AB_War1_NU2
		add_country_leader_trait = AB_1_NU2
		remove_country_leader_trait = AB_1_NU3
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.7 }
	}
	
	if = { #lower national unity penalty from #2 - 1
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_war1_pause}
				has_country_flag = AB_end_war1
				has_country_flag = AB_War1_NU2
			}
		}
		
		set_country_flag = AB_war1_pause
		clr_country_flag = AB_War1_NU2
		set_country_flag = AB_War1_NU1
		add_country_leader_trait = AB_1_NU1
		remove_country_leader_trait = AB_1_NU2
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.7 }
	}
	
	if = { #lower national unity penalty from #1 - none
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_war1_pause}
				has_country_flag = AB_end_war1
				has_country_flag = AB_War1_NU1
			}
		}
		
		set_country_flag = AB_war1_pause
		clr_country_flag = AB_War1_NU1
		remove_country_leader_trait = AB_1_NU1
		hidden_effect = { set_pp_gain = yes }
		event_target:AB_DEFF = {
			AB_war1_cleaup = yes
		}
		country_event = { days = 1 id = anti_bully.9 }
	}

}

#clears all flags related to ab system - war 1
AB_war1_cleaup = {
	event_target:AB_ATT = {
		clr_country_flag = AB_end_war1
		clr_country_flag = AB_War1_NU1
		clr_country_flag = AB_war1_pause
		clr_country_flag = AB_War1_NU0
		clr_country_flag = AB_War1_NU1
		clr_country_flag = AB_War1_NU2
		clr_country_flag = AB_War1_NU3
		clr_country_flag = AB_War1_NU4
		clr_country_flag = AB_War1_NU5
		clr_country_flag = AB_War1_NU6
		clr_country_flag = AB_War1_NU7
		clr_country_flag = AB_War1_NU8
		clr_country_flag = AB_War1_NU9
		clr_country_flag = AB_War1_NU10
		clr_country_flag = AB_test_true
		clr_country_flag = AB_war1_peace_1
		clr_country_flag = AB_war1_peace_2
		clr_country_flag = AB_War1
		
	}
	event_target:AB_DEFF = {
		clr_country_flag = AB_end_war1
		clr_country_flag = AB_War1_NU1
		clr_country_flag = AB_war1_pause
		clr_country_flag = AB_War1_NU0
		clr_country_flag = AB_War1_NU1
		clr_country_flag = AB_War1_NU2
		clr_country_flag = AB_War1_NU3
		clr_country_flag = AB_War1_NU4
		clr_country_flag = AB_War1_NU5
		clr_country_flag = AB_War1_NU6
		clr_country_flag = AB_War1_NU7
		clr_country_flag = AB_War1_NU8
		clr_country_flag = AB_War1_NU9
		clr_country_flag = AB_War1_NU10
		clr_country_flag = AB_test_true
		clr_country_flag = AB_war1_peace_1
		clr_country_flag = AB_war1_peace_2
		clr_country_flag = AB_War1
	}
	
	if = {
		limit = {
			tag = event_target:AB_DEFF
		}
		
		capital_scope = {
			remove_claim_by = event_target:AB_ATT
		}
	}
	
}


#Calculates & lower national unity - War 2
Anti_bully_2_nu = {
	
	#Checks to make sure still at war and AB active if false everything below is ignored
	AB_war_test = yes 
	
	#Anti Bully loose National Unity #1
	if = {
		limit = {
			not = {
				has_country_flag = AB_War2_pause
			}
			has_country_flag = AB_War2_NU0
			has_country_flag = AB_test_true
		}
		event_target:AB_ATT = {
			set_country_flag = AB_War2_NU1
			set_country_flag = AB_War2_pause
			clr_country_flag = AB_War2_NU0
			clr_country_flag = AB_test_true
			
			
			add_country_leader_trait = AB_2_NU1
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.12 } #Generic event loose National Unity
			
		}
	}
	
	#Anti Bully loose National Unity #2
	if = {
		limit = {
			not = {
				has_country_flag = AB_War2_pause
			}
			has_country_flag = AB_test_true
			has_country_flag = AB_War2_NU1
		}
		set_country_flag = AB_War2_NU2
		set_country_flag = AB_War2_pause
		clr_country_flag = AB_War2_NU1
		clr_country_flag = AB_test_true
		
		
		remove_country_leader_trait = AB_2_NU1
		add_country_leader_trait = AB_2_NU2
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.12 } #Generic event loose National Unity
		
		
		
	}
	#Anti Bully loose National Unity #3
	if = {
		limit = {
			not = {
				has_country_flag = AB_War2_pause
			}
			has_country_flag = AB_test_true
			has_country_flag = AB_War2_NU2
			
		}
		event_target:AB_ATT = {
			set_country_flag = AB_War2_NU3
			set_country_flag = AB_War2_pause
			clr_country_flag = AB_War2_NU2
			clr_country_flag = AB_test_true
			
			remove_country_leader_trait = AB_2_NU2
			add_country_leader_trait = AB_2_NU3
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.12 } #Generic event loose National Unity
			
			
		}
	}
	#Anti Bully loose National Unity #4
	if = {
		limit = {
			not = {
				has_country_flag = AB_War2_pause
			}
			has_country_flag = AB_test_true
			has_country_flag = AB_War2_NU3
			
		}
		event_target:AB_ATT = {
			set_country_flag = AB_War2_NU4
			set_country_flag = AB_War2_pause
			clr_country_flag = AB_War2_NU3
			clr_country_flag = AB_test_true
			
			remove_country_leader_trait = AB_2_NU3
			add_country_leader_trait = AB_2_NU4
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.12 } #Generic event loose National Unity
			
			
		}
	}
	#Anti Bully loose National Unity #5
	if = {
		limit = {
			not = {
				has_country_flag = AB_War2_pause
				has_country_flag = AB_war2_peace_1
			}
			has_country_flag = AB_test_true
			has_country_flag = AB_War2_NU4
			
			
		}
		event_target:AB_ATT = {
			set_country_flag = AB_War2_NU5
			set_country_flag = AB_War2_pause
			set_country_flag = AB_end_war2
			
			clr_country_flag = AB_War2_NU4
			clr_country_flag = AB_test_true
			
			remove_country_leader_trait = AB_2_NU4
			add_country_leader_trait = AB_2_NU5
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.12 } #Generic event loose National Unity
			
			
		}
	}
	
	#First white peace offering
	if = {
		limit = {
			not = {
				has_country_flag = AB_War2_pause
				has_country_flag = AB_war2_peace_1
			}
			has_country_flag = AB_War2_NU5
			has_country_flag = AB_test_true
		}
		event_target:AB_ATT = {
			set_country_flag = AB_War2_pause
			set_country_flag = AB_war2_peace_1
			country_event = { id = anti_bully.13 } #Attacker offers white peace
		}
		
	}
	
	#Anti Bully loose National Unity #6
	if = {
		limit = {
			not = {
				has_country_flag = AB_War2_pause
			}
			has_country_flag = AB_War2_NU5
			has_country_flag = AB_test_true
		}
		
		event_target:AB_ATT = {
			set_country_flag = AB_War2_NU6
			set_country_flag = AB_War2_pause
			
			clr_country_flag = AB_War2_NU5
			clr_country_flag = AB_test_true
			clr_country_flag = AB_end_war2
			
			remove_country_leader_trait = AB_2_NU5
			add_country_leader_trait = AB_2_NU6
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.12 } #Generic event loose National Unity
			
			
		}
	}
	
	#Anti Bully loose National Unity #7
	if = {
		limit = {
			not = {
				has_country_flag = AB_War2_pause
			}
			has_country_flag = AB_War2_NU6
			has_country_flag = AB_test_true
		}
		
		event_target:AB_ATT = {
			set_country_flag = AB_War2_NU7
			set_country_flag = AB_War2_pause
			
			clr_country_flag = AB_War2_NU6
			clr_country_flag = AB_test_true
			
			remove_country_leader_trait = AB_2_NU6
			add_country_leader_trait = AB_2_NU7
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.12 } #Generic event loose National Unity
			
			
		}
	}
	#Anti Bully loose National Unity #8
	if = {
		limit = {
			not = {
				has_country_flag = AB_War2_pause
				has_country_flag = AB_war2_peace_2
			}
			has_country_flag = AB_War2_NU7
			has_country_flag = AB_test_true
		}
		
		event_target:AB_ATT = {
			set_country_flag = AB_War2_NU8
			set_country_flag = AB_War2_pause
			set_country_flag = AB_end_war2
			
			clr_country_flag = AB_War2_NU7
			clr_country_flag = AB_test_true
			
			remove_country_leader_trait = AB_2_NU7
			add_country_leader_trait = AB_2_NU8
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.12 } #Generic event loose National Unity
			
			
		}
	}
	
	#Second white peace offering - if attacker offers white peace and gets declined
	#attacker starts to regain NU as its a real war now
	if = {
		limit = {
			not = {
				has_country_flag = AB_War2_pause
				has_country_flag = AB_war2_peace_2
			}
			has_country_flag = AB_War2_NU8
			has_country_flag = AB_test_true
		}
		event_target:AB_ATT = {
			set_country_flag = AB_War2_pause
			set_country_flag = AB_war2_peace_2
			country_event = { days = 2 id = anti_bully.13 } #Attacker offers white peace
		}
		
	}
	
	#Anti Bully loose National Unity #9
	if = {
		limit = {
			not = {
				has_country_flag = AB_War2_pause
			}
			has_country_flag = AB_War2_NU8
			has_country_flag = AB_test_true
		}
		
		event_target:AB_ATT = {
			set_country_flag = AB_War2_NU9
			set_country_flag = AB_War2_pause
			
			clr_country_flag = AB_War2_NU8
			clr_country_flag = AB_test_true
			clr_country_flag = AB_end_war2
			
			remove_country_leader_trait = AB_2_NU8
			add_country_leader_trait = AB_2_NU9
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.12 } #Generic event loose National Unity
			
			
		}
	}
	
	#Anti Bully loose National Unity #10
	if = {
		limit = {
			not = {
				has_country_flag = AB_War2_pause
			}
			has_country_flag = AB_War2_NU9
			has_country_flag = AB_test_true
		}
		
		event_target:AB_ATT = {
			set_country_flag = AB_War2_NU10
			set_country_flag = AB_War2_pause
			
			clr_country_flag = AB_War2_NU9
			clr_country_flag = AB_test_true
			
			remove_country_leader_trait = AB_2_NU9
			add_country_leader_trait = AB_2_NU10
			hidden_effect = { set_pp_gain = yes }
			
			country_event = { days = 30 id = anti_bully.12 } #Generic event loose National Unity
			
			
		}
	}
	
	#Attacker has max -nu have to contiuiosly check to see if the war is over
	#So we can start to give back their NU
	if = {
		limit = {
			event_target:AB_ATT = {
				has_country_flag = AB_War2_NU10
				has_country_flag = AB_test_true
			}
		}
		event_target:AB_ATT = {
			clr_country_flag = AB_test_true
			set_country_flag = AB_war1_pause
			country_event = { days = 30 id = anti_bully.17 }
		}
	}
	
	
	if = { #if not in war start returning national unity - war2
		limit = {
			event_target:AB_ATT = {
				not = {
					has_country_flag = AB_test_true
					has_country_flag = AB_war1_pause 
				}
				
			}
		}
		event_target:AB_ATT = {
			clr_country_flag = AB_test_true
			set_country_flag = AB_end_war2
			AB_regain_NU_war2 = yes
		}

	}
}

#regain national unity for - war 2
AB_regain_NU_war2 = {

	if = {
		limit = {
			event_target:AB_ATT = {
				not = {
					has_country_flag = AB_War2_pause
					has_country_flag = AB_War2_NU_start
				}
				has_country_flag = AB_end_war2
				or = {
					has_country_flag = AB_War2_NU10
					has_country_flag = AB_War2_NU9
					has_country_flag = AB_War2_NU8
					has_country_flag = AB_War2_NU7
					has_country_flag = AB_War2_NU6
					has_country_flag = AB_War2_NU5
					has_country_flag = AB_War2_NU4
					has_country_flag = AB_War2_NU3
					has_country_flag = AB_War2_NU2
					has_country_flag = AB_War2_NU1
					
				}
			}
			
		}
		set_country_flag = AB_War2_pause
		set_country_flag = AB_War2_NU_start
		country_event = { days = 30 id = anti_bully.16 }
	}
	
	if = { #lower national unity penalty from #10 - 9
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_War2_pause}
				has_country_flag = AB_end_war2
				has_country_flag = AB_War2_NU10
			}
		}
		
		set_country_flag = AB_War2_pause
		clr_country_flag = AB_War2_NU10
		set_country_flag = AB_War2_NU9
		add_country_leader_trait = AB_2_NU9
		remove_country_leader_trait = AB_2_NU10
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.16 }
	}
	if = { #lower national unity penalty from #9 - 8
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_War2_pause}
				has_country_flag = AB_end_war2
				has_country_flag = AB_War2_NU9
			}
		}
		
		set_country_flag = AB_War2_pause
		clr_country_flag = AB_War2_NU9
		set_country_flag = AB_War2_NU8
		add_country_leader_trait = AB_2_NU8
		remove_country_leader_trait = AB_2_NU9
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.16 }
	}
	if = { #lower national unity penalty from #8 - 7
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_War2_pause}
				has_country_flag = AB_end_war2
				has_country_flag = AB_War2_NU8
			}
		}
		
		set_country_flag = AB_War2_pause
		clr_country_flag = AB_War2_NU8
		set_country_flag = AB_War2_NU7
		add_country_leader_trait = AB_2_NU7
		remove_country_leader_trait = AB_2_NU8
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.16 }
	}
	if = { #lower national unity penalty from #7 - 6
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_War2_pause}
				has_country_flag = AB_end_war2
				has_country_flag = AB_War2_NU7
			}
		}
		
		set_country_flag = AB_War2_pause
		clr_country_flag = AB_War2_NU7
		set_country_flag = AB_War2_NU6
		add_country_leader_trait = AB_2_NU6
		remove_country_leader_trait = AB_2_NU7
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.16 }
	}
	if = { #lower national unity penalty from #6 - 5
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_War2_pause}
				has_country_flag = AB_end_war2
				has_country_flag = AB_War2_NU6
			}
		}
		
		set_country_flag = AB_War2_pause
		clr_country_flag = AB_War2_NU6
		set_country_flag = AB_War2_NU5
		add_country_leader_trait = AB_2_NU5
		remove_country_leader_trait = AB_2_NU6
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.16 }
	}
	if = { #lower national unity penalty from #5 - 4
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_War2_pause}
				has_country_flag = AB_end_war2
				has_country_flag = AB_War2_NU5
			}
		}
		
		set_country_flag = AB_War2_pause
		clr_country_flag = AB_War2_NU5
		set_country_flag = AB_War2_NU4
		add_country_leader_trait = AB_2_NU4
		remove_country_leader_trait = AB_2_NU5
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.16 }
	}
	
	if = { #lower national unity penalty from #4 - 3
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_War2_pause}
				has_country_flag = AB_end_war2
				has_country_flag = AB_War2_NU4
			}
		}
		
		set_country_flag = AB_War2_pause
		clr_country_flag = AB_War2_NU4
		set_country_flag = AB_War2_NU3
		add_country_leader_trait = AB_2_NU3
		remove_country_leader_trait = AB_2_NU4
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.16 }
	}
	
	if = { #lower national unity penalty from #3 - 2
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_War2_pause}
				has_country_flag = AB_end_war2
				has_country_flag = AB_War2_NU3
			}
		}
		
		set_country_flag = AB_War2_pause
		clr_country_flag = AB_War2_NU3
		set_country_flag = AB_War2_NU2
		add_country_leader_trait = AB_2_NU2
		remove_country_leader_trait = AB_2_NU3
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.16 }
	}
	
	if = { #lower national unity penalty from #2 - 1
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_War2_pause}
				has_country_flag = AB_end_war2
				has_country_flag = AB_War2_NU2
			}
		}
		
		set_country_flag = AB_War2_pause
		clr_country_flag = AB_War2_NU2
		set_country_flag = AB_War2_NU1
		add_country_leader_trait = AB_2_NU1
		remove_country_leader_trait = AB_2_NU2
		hidden_effect = { set_pp_gain = yes }
		
		country_event = { days = 30 id = anti_bully.16 }
	}
	
	if = { #lower national unity penalty from #1 - none
		limit = {
			event_target:AB_ATT = {
				not = {has_country_flag = AB_War2_pause}
				has_country_flag = AB_end_war2
				has_country_flag = AB_War2_NU1
			}
		}
		
		set_country_flag = AB_War2_pause
		clr_country_flag = AB_War2_NU1
		remove_country_leader_trait = AB_2_NU1
		hidden_effect = { set_pp_gain = yes }
		event_target:AB_DEFF = {
			AB_war2_cleaup = yes
		}
		country_event = { days = 1 id = anti_bully.18 }
	}

}

#clears all flags related to ab system - war 2
AB_war2_cleaup = {
	event_target:AB_ATT = {
		clr_country_flag = AB_end_war2
		clr_country_flag = AB_War2_NU1
		clr_country_flag = AB_War2_pause
		clr_country_flag = AB_War2_NU0
		clr_country_flag = AB_War2_NU1
		clr_country_flag = AB_War2_NU2
		clr_country_flag = AB_War2_NU3
		clr_country_flag = AB_War2_NU4
		clr_country_flag = AB_War2_NU5
		clr_country_flag = AB_War2_NU6
		clr_country_flag = AB_War2_NU7
		clr_country_flag = AB_War2_NU8
		clr_country_flag = AB_War2_NU9
		clr_country_flag = AB_War2_NU10
		clr_country_flag = AB_test_true
		clr_country_flag = AB_war2_peace_1
		clr_country_flag = AB_war2_peace_2
		clr_country_flag = AB_War2
		
	}
	event_target:AB_DEFF = {
		clr_country_flag = AB_end_war2
		clr_country_flag = AB_War2_NU1
		clr_country_flag = AB_War2_pause
		clr_country_flag = AB_War2_NU0
		clr_country_flag = AB_War2_NU1
		clr_country_flag = AB_War2_NU2
		clr_country_flag = AB_War2_NU3
		clr_country_flag = AB_War2_NU4
		clr_country_flag = AB_War2_NU5
		clr_country_flag = AB_War2_NU6
		clr_country_flag = AB_War2_NU7
		clr_country_flag = AB_War2_NU8
		clr_country_flag = AB_War2_NU9
		clr_country_flag = AB_War2_NU10
		clr_country_flag = AB_test_true
		clr_country_flag = AB_peace_1
		clr_country_flag = AB_peace_2
		clr_country_flag = AB_War2

	}
	
	if = {
		limit = {
			tag = event_target:AB_DEFF
		}
		
		capital_scope = {
			remove_claim_by = event_target:AB_ATT
		}
	}
}
