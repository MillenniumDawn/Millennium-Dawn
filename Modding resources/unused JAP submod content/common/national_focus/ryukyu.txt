# Author(s): AngriestBird, n_mosimo
shared_focus = {
	id = RYU_indep_path
	icon = peasant_rebellion
	x = 6
	y = 6
	cost = 1
	search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_INDUSTRY FOCUS_FILTER_INFLUENCE FOCUS_FILTER_EXPENDITURE FOCUS_FILTER_INSURGENCY }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	allow_branch = {
		original_tag = RYU
	}

	completion_reward = {
		add_political_power = 100
		add_offsite_building = { type = arms_factory level = 1 }
		set_temp_variable = { debt_change = 3.5 }
		modify_debt_effect = yes

		set_country_flag = MDMOSJAP_EXTERNAL_DEBT_CHANGE
		set_temp_variable = { percent_change = 25 }
		change_domestic_influence_percentage = yes
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
	}
}

#Occupy Southern Police Station 本島南部の警察署の制圧
shared_focus = {
	id = RYU_indep_path_midleft1
	icon = rearmament
	x = -1	y = 2	cost = 1	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_MANPOWER FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		add_equipment_to_stockpile = { type = infantry_weapons2 amount = 200 producer = JAP }
		add_equipment_to_stockpile = { type = command_control_equipment2 amount = 300 producer = JAP }
		add_equipment_to_stockpile = { type = util_vehicle_2 amount = 100 producer = JAP }
		add_equipment_to_stockpile = { type = util_vehicle_3 amount = 100 producer = JAP }
		division_template = {
			name = "Revolutionary Mobile Squad"
			regiments = {
				L_Inf_Bat = { x = 0 y = 0 }
				Militia_Bat = { x = 1 y = 0 }
				Mot_Inf_Bat = { x = 2 y = 0 }
			}
		}
		division_template = {
			name = "Revolutionary Squad"
			regiments = {
				L_Inf_Bat = { x = 0 y = 0 }
				Militia_Bat = { x = 1 y = 0 }
			}
		}
		618 = {
			create_unit = {
				division = "name =\"Ryukyu Civil Defence Forces\" division_template = \"Revolutionary Mobile Squad\" start_experience_factor = 0.0 start_equipment_factor = 1.00"
				prioritize_location = 11932
				owner = RYU
				count = 1
			}
			create_unit = {
				division = "name =\"Ryukyu Civil Defence Forces\" division_template = \"Revolutionary Squad\" start_experience_factor = 0.0 start_equipment_factor = 1.00"
				prioritize_location = 11932
				owner = RYU
				count = 1
			}
		}
		if = {
			limit = { has_idea = police_01 }
			swap_ideas = { remove_idea = police_01 add_idea = police_02 }
		}
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
	}
}

#73-88 Lines 73-88防衛線
shared_focus = {
	id = RYU_indep_path_midleft2
	icon = generic_entrenchment
	x = -1	y = 3	cost = 2	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path_midleft1 }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		618 = {
			remove_building = { type = infrastructure level = 2 }
			remove_building = { type = industrial_complex level = 1 }
			add_building_construction = { type = bunker level = 2 province = 11932 instant_build = yes }
		}
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
	}
}

#Download and Print ダウンロードとプリントアウト
shared_focus = {
	id = RYU_indep_path_midright1
	icon = examine_foreign_small_arms
	x = 1	y = 2	cost = 1	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_RESEARCH FOCUS_FILTER_INDUSTRY FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		add_tech_bonus = { name = infantry_weapons_bonus bonus = 1.00 uses = 1 category = Cat_INF_WEP }
		random_owned_state = {
			limit = { is_capital = yes }
			add_extra_state_shared_building_slots = 1
			add_building_construction = { type = arms_factory level = 1 instant_build = yes }
		}
		add_ideas = JAP_RYU_ikusayuu1
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
	}
}

#Gama Network ガマネットワーク
shared_focus = {
	id = RYU_indep_path_midright2
	icon = infiltration_tactics
	x = 1	y = 3	cost = 2	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_RESEARCH FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path_midright1 }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		swap_ideas = { remove_idea = JAP_RYU_ikusayuu1 add_idea = JAP_RYU_ikusayuu2 }
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
	}
}

#Awaken from the Memory 記憶からの覚醒
shared_focus = {
	id = RYU_indep_path_mid1
	icon = volunteers
	x = 0	y = 4	cost = 3	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_RESEARCH FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path_midleft2 }
	prerequisite = { focus = RYU_indep_path_midright2 }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		swap_ideas = { remove_idea = JAP_RYU_ikusayuu2 add_idea = JAP_RYU_ikusayuu3 }
		if = {
			limit = { has_idea = JAP_RYU_rebellion_middle }
			swap_ideas = { remove_idea = JAP_RYU_rebellion_middle add_idea = JAP_RYU_rebellion_strong }
		}
		if = {
			limit = { has_idea = JAP_RYU_rebellion_weak }
			swap_ideas = { remove_idea = JAP_RYU_rebellion_weak add_idea = JAP_RYU_rebellion_middle }
		}
		custom_effect_tooltip = MDMOSJAP_RYU_independence_will_execute_TT

		hidden_effect = {
			if = {
				limit = {
					has_completed_focus = RYU_indep_path_revolution2
				}
				set_variable = { mdmosjap_RYU_var_IndependenceCountdown = 30 }
			}
			if = {
				limit = {
					has_completed_focus = RYU_indep_path_renovation2
				}
				set_variable = { mdmosjap_RYU_var_IndependenceCountdown = 60 }
			}
		}
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
	}
}

#Strategy of Revolution 革命戦術
shared_focus = {
	id = RYU_indep_path_revolution
	icon = hammer_star
	x = -4	y = 1	cost = 1	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_EXPENDITURE FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path }
	mutually_exclusive = { focus = RYU_indep_path_renovation }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		swap_ideas = { remove_idea = JAP_RYU_all_okinawa add_idea = JAP_RYU_all_okinawa_aut2 }
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
		modifier = {
			NOT = { has_completed_focus = RYU_indep_path_mid1 }
			factor = 0
		}
		modifier = {
			is_historical_focus_on = yes
			factor = 0.1
		}
	}
}

#Propagate the Terror 恐怖心の播種
shared_focus = {
	id = RYU_indep_path_revolutionleft1
	icon = war_against_japan
	x = -5	y = 2	cost = 1	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_WAR_SUPPORT FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path_revolution }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		add_war_support = 0.10
		add_popularity = { ideology = communism popularity = 0.20 }
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
	}
}

#Heroes of War 戦争の英雄
shared_focus = {
	id = RYU_indep_path_revolutionleft2
	icon = recruitment
	x = -5	y = 3	cost = 2	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path_revolutionleft1 }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		add_command_power = 40
		army_experience = 100
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
	}
}

#Destroy Harbors 港湾の破壊
shared_focus = {
	id = RYU_indep_path_revolutionright1
	icon = coastal_fort
	x = -3	y = 2	cost = 1	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path_revolution }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		every_owned_state = {
			limit = { naval_base > 3 }
		#	remove_building = { type = naval_base level = 3 }	#DO NOT TOUCH THIS LINE OR YOU'LL MEET THE CRASH
			add_building_construction = { type = bunker level = 1 province = 11932 instant_build = yes }
			add_building_construction = { type = coastal_bunker level = 2 province = 11932 instant_build = yes }
		}
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
	}
}

#Commandeer Automobiles 自動車の徴発
shared_focus = {
	id = RYU_indep_path_revolutionright2
	icon = mining_truck
	x = -3	y = 3	cost = 2	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path_revolutionright1 }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		add_equipment_to_stockpile = { type = util_vehicle_2 amount = 500 producer = JAP }
		add_equipment_to_stockpile = { type = util_vehicle_3 amount = 1000 producer = JAP }
		add_stability = -0.05
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
	}
}

#Resistance 抵抗
shared_focus = {
	id = RYU_indep_path_revolution2
	icon = mass_assault
	x = -4	y = 4	cost = 3	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_INDUSTRY FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path_revolutionleft2 }
	prerequisite = { focus = RYU_indep_path_revolutionright2 }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		random_owned_state = {
			limit = { is_capital = yes }
			add_extra_state_shared_building_slots = 1
			add_building_construction = { type = industrial_complex level = 1 instant_build = yes }
		}
		swap_ideas = { remove_idea = JAP_RYU_all_okinawa_aut2 add_idea = JAP_RYU_all_okinawa_aut3 }
		if = {
			limit = { has_idea = JAP_RYU_rebellion_middle }
			swap_ideas = { remove_idea = JAP_RYU_rebellion_middle add_idea = JAP_RYU_rebellion_strong }
		}
		if = {
			limit = { has_idea = JAP_RYU_rebellion_weak }
			swap_ideas = { remove_idea = JAP_RYU_rebellion_weak add_idea = JAP_RYU_rebellion_middle }
		}
		if = {
			limit = { has_idea = officer_baptism_by_fire }
			swap_ideas = { remove_idea = officer_baptism_by_fire add_idea = officer_basic_training }
		}
		custom_effect_tooltip = MDMOSJAP_RYU_independence_will_execute_60days_TT
		hidden_effect = {
			if = {
				limit = {
					has_completed_focus = RYU_indep_path_mid1
				}
				set_variable = { mdmosjap_RYU_var_IndependenceCountdown = 60 }
			}
		}
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
	}
}

#Strategy of Renovation 革新戦術
shared_focus = {
	id = RYU_indep_path_renovation
	icon = democracy3
	x = 4	y = 1	cost = 1	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path }
	mutually_exclusive = { focus = RYU_indep_path_revolution }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		swap_ideas = { remove_idea = JAP_RYU_all_okinawa add_idea = JAP_RYU_all_okinawa_dem2 }
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
		modifier = {
			NOT = { has_completed_focus = RYU_indep_path_mid1 }
			factor = 0
		}
	}
}

#Secure Japanese 日本人の保護
shared_focus = {
	id = RYU_indep_path_renovationleft1
	icon = align_to_japan
	x = 5	y = 2	cost = 1	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_STABILITY FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path_renovation }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		add_stability = 0.05
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
	}
}

#Municipal Elections amid the War 戦時下の市町村選挙
shared_focus = {
	id = RYU_indep_path_renovationleft2
	icon = election2
	x = 5	y = 3	cost = 2	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path_renovationleft1 }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		add_stability = -0.10
		add_popularity = { ideology = democratic popularity = 0.20 }
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
	}
}

#Protect Foreign Enterprises 外国資本の保護
shared_focus = {
	id = RYU_indep_path_renovationright1
	icon = protectionist_economics
	x = 3	y = 2	cost = 1	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_INDUSTRY FOCUS_FILTER_EXPENDITURE FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path_renovation }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		random_owned_state = {
			limit = { is_capital = yes }
			add_extra_state_shared_building_slots = 1
			add_building_construction = { type = industrial_complex level = 1 instant_build = yes }
		}
		add_to_variable = { int_investments = 2.0 }
		custom_effect_tooltip = MDMOSJAP_add_2_invest_TT
		set_temp_variable = { debt_change = 3.5 }
		modify_debt_effect = yes

		set_country_flag = MDMOSJAP_EXTERNAL_DEBT_CHANGE
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
	}
}

#Umbrella of Great Powers 大国の傘
shared_focus = {
	id = RYU_indep_path_renovationright2
	icon = united_nations
	x = 3	y = 3	cost = 2	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path_renovationright1 }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		every_country = {
			limit = {
				OR = {
					has_opinion_modifier = refuse_to_apologize_for_warcrimes
					has_idea = G7_member
					has_idea = p5_member
					AND = {
						is_major = yes
						NOT = { tag = JAP }
						NOT = { tag = JPC }
						NOT = { tag = JPK }
						NOT = { tag = JPW }
					}
				}
			}
			add_opinion_modifier = { target = ROOT modifier = mdmosjap_opinion_RYU_request_to_the_world }
		}
	#	add_to_variable = { int_investments = 2.0 }
	#	custom_effect_tooltip = MDMOSJAP_add_2_invest_TT
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
	}
}

#Concurrence 協調
shared_focus = {
	id = RYU_indep_path_renovation2
	icon = diplomacy
	x = 4	y = 4	cost = 3	relative_position_id = RYU_indep_path
	search_filters = { FOCUS_FILTER_POLITICAL FOCUS_FILTER_INSURGENCY }

	prerequisite = { focus = RYU_indep_path_renovationleft2 }
	prerequisite = { focus = RYU_indep_path_renovationright2 }

	available = {
		has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
		has_war_with = JAP
	}

	completion_reward = {
		swap_ideas = { remove_idea = JAP_RYU_all_okinawa_dem2 add_idea = JAP_RYU_all_okinawa_dem3 }
		if = {
			limit = { has_idea = JAP_RYU_rebellion_middle }
			swap_ideas = { remove_idea = JAP_RYU_rebellion_middle add_idea = JAP_RYU_rebellion_strong }
		}
		if = {
			limit = { has_idea = JAP_RYU_rebellion_weak }
			swap_ideas = { remove_idea = JAP_RYU_rebellion_weak add_idea = JAP_RYU_rebellion_middle }
		}
		if = {
			limit = { has_idea = officer_baptism_by_fire }
			swap_ideas = { remove_idea = officer_baptism_by_fire add_idea = officer_basic_training }
		}
		custom_effect_tooltip = MDMOSJAP_RYU_independence_will_execute_30days_TT
		hidden_effect = {
			if = {
				limit = {
					has_completed_focus = RYU_indep_path_mid1
				}
				set_variable = { mdmosjap_RYU_var_IndependenceCountdown = 30 }
			}
		}
	}

	ai_will_do = {
		factor = 100
		modifier = {
			has_global_flag = MDMOSJAP_OKINAWA_IN_FLAMES
			factor = 100
		}
	}
}