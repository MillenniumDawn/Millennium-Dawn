#Israeli-Palestinian peace process
add_namespace = peace_plan
#USA Coalition forces - Iraq
add_namespace = iraqi_MNF
add_namespace = syria_MNF
#Iran Goverments post Invasion
add_namespace = iran_interim_admin

#[FROM.GetName] Proposes Middle East Peace Plan
news_event = {
	id = peace_plan.1
	title = peace_plan.1.t
	desc = {
		text = peace_plan.1.d
		trigger = { FROM = { has_completed_focus = GCC_jordanian_ties } }
	}
	desc = {
		text = peace_plan.1.d1
		trigger = { FROM = { has_completed_focus = GCC_favor_resistance } }
	}

	picture = GFX_news_press_conference

	is_triggered_only = yes

	option = {
		name = peace_plan.1.a #Not another doomed peace deal...
		log = "[GetDateText]: [This.GetName]: peace_plan.1.a executed"
		ai_chance = {
			factor = 1
		}
	}
}

#Right of Return
country_event = {
	id = peace_plan.2
	title = peace_plan.2.t
	desc = peace_plan.2.d

	picture = GFX_politics_negotiations

	is_triggered_only = yes

	option = {
		name = peace_plan.2.a #They should return to their homes.
		log = "[GetDateText]: [This.GetName]: peace_plan.2.a executed"
		custom_effect_tooltip = palestine_peace_deal_proposed_tt
		subtract_from_variable = { isreali_support = 1 }
		add_to_variable = { palestinian_support = 1 }
		country_event = { days = 1 id = peace_plan.3 }
		set_country_flag = right_of_return_yes
		ai_chance = {
			factor = 1
			modifier = {
				add = 1
				has_completed_focus = GCC_favor_resistance
			}
		}
	}

	option = {
		name = peace_plan.2.b #They should stay where they are.
		log = "[GetDateText]: [This.GetName]: peace_plan.2.b executed"
		custom_effect_tooltip = israel_peace_deal_proposed_tt
		add_to_variable = { isreali_support = 1 }
		subtract_from_variable = { palestinian_support = 1 }
		country_event = { days = 1 id = peace_plan.3 }
		set_country_flag = right_of_return_no
		ai_chance = {
			factor = 1
		}
	}
}

#Settlements in the West Bank
country_event = {
	id = peace_plan.3
	title = peace_plan.3.t
	desc = peace_plan.3.d

	picture = GFX_politics_negotiations

	is_triggered_only = yes

	option = {
		name = peace_plan.3.a #The settlements must be dismantled.
		log = "[GetDateText]: [This.GetName]: peace_plan.3.a executed"
		custom_effect_tooltip = palestine_peace_deal_proposed_tt
		subtract_from_variable = { isreali_support = 1 }
		add_to_variable = { palestinian_support = 1 }
		country_event = { days = 1 id = peace_plan.4 }
		set_country_flag = settlements_yes
		ai_chance = {
			factor = 1
			modifier = {
				add = 1
				has_completed_focus = GCC_favor_resistance
			}
		}
	}

	option = {
		name = peace_plan.3.b #The settlements should stay, and Israel should be favored in land swaps.
		log = "[GetDateText]: [This.GetName]: peace_plan.3.b executed"
		custom_effect_tooltip = israel_peace_deal_proposed_tt
		add_to_variable = { isreali_support = 1 }
		subtract_from_variable = { palestinian_support = 1 }
		country_event = { days = 1 id = peace_plan.4 }
		set_country_flag = settlements_no
		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = peace_plan.3.c #The settlements should stay, and Palestine should be favored in land swaps.
		log = "[GetDateText]: [This.GetName]: peace_plan.3.c executed"
		country_event = { days = 1 id = peace_plan.4 }
		set_country_flag = settlements_ish
		ai_chance = {
			factor = 1
			modifier = {
				add = 1
				has_completed_focus = GCC_favor_resistance
			}
		}
	}
}

#The Fate of Jerusalem
country_event = {
	id = peace_plan.4
	title = peace_plan.4.t
	desc = peace_plan.4.d

	picture = GFX_politics_negotiations

	is_triggered_only = yes

	option = {
		name = peace_plan.4.a #The Palestinians should have the city.
		log = "[GetDateText]: [This.GetName]: peace_plan.4.a executed"
		custom_effect_tooltip = palestine_peace_deal_proposed1_tt
		subtract_from_variable = { isreali_support = 2 }
		add_to_variable = { palestinian_support = 2 }
		country_event = { days = 1 id = peace_plan.5 }
		set_country_flag = jerusalem_PAL
		ai_chance = {
			factor = 1
			modifier = {
				add = 1
				has_completed_focus = GCC_favor_resistance
			}
		}
	}

	option = {
		name = peace_plan.4.b #The Israelis should keep the city.
		log = "[GetDateText]: [This.GetName]: peace_plan.4.b executed"
		custom_effect_tooltip = israel_peace_deal_proposed_tt
		add_to_variable = { isreali_support = 1 }
		subtract_from_variable = { palestinian_support = 1 }
		country_event = { days = 1 id = peace_plan.5 }
		set_country_flag = jerusalem_ISR
		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = peace_plan.4.c #Jerusalem should be put under international administration.
		log = "[GetDateText]: [This.GetName]: peace_plan.4.c executed"
		custom_effect_tooltip = palestine_peace_deal_proposed_tt
		subtract_from_variable = { isreali_support = 1 }
		add_to_variable = { palestinian_support = 1 }
		country_event = { days = 1 id = peace_plan.5 }
		set_country_flag = jerusalem_UN
		ai_chance = {
			factor = 1
			modifier = {
				add = 1
				has_completed_focus = GCC_favor_resistance
			}
		}
	}
}

#Palestinian Statehood
country_event = {
	id = peace_plan.5
	title = peace_plan.5.t
	desc = peace_plan.5.d

	picture = GFX_politics_negotiations

	is_triggered_only = yes

	option = {
		name = peace_plan.5.a #The Palestinians should have a state.
		log = "[GetDateText]: [This.GetName]: peace_plan.5.a executed"
		custom_effect_tooltip = palestine_peace_deal_proposed_tt
		subtract_from_variable = { isreali_support = 1 }
		add_to_variable = { palestinian_support = 1 }
		set_country_flag = palestine_state_yes
		every_other_country = {
			limit = { OR = { original_tag = ISR original_tag = PAL } }
			country_event = { days = 1 id = peace_plan.6 }
		}
		ai_chance = {
			factor = 1
			modifier = {
				add = 1
				has_completed_focus = GCC_favor_resistance
			}
		}
	}

	option = {
		name = peace_plan.5.b #Palestinian sovereignty should be limited.
		log = "[GetDateText]: [This.GetName]: peace_plan.5.b executed"
		custom_effect_tooltip = israel_peace_deal_proposed_tt
		add_to_variable = { isreali_support = 1 }
		subtract_from_variable = { palestinian_support = 1 }
		set_country_flag = palestine_state_no
		every_other_country = {
			limit = { OR = { original_tag = ISR original_tag = PAL } }
			country_event = { days = 1 id = peace_plan.6 }
		}
		ai_chance = {
			factor = 1
		}
	}
}

#The [FROM.GetAdjective] Peace Proposal Announced!
country_event = {
	id = peace_plan.6
	title = peace_plan.6.t
	desc = peace_plan.6.d

	picture = GFX_politics_speak

	is_triggered_only = yes

	option = {
		name = peace_plan.6.a #This deal is acceptable to us.
		log = "[GetDateText]: [This.GetName]: peace_plan.6.a executed"
		set_country_flag = peace_deal_accepted_@FROM
		effect_tooltip = {
			if = {
				limit = {
					original_tag = ISR
					FROM = { has_country_flag = right_of_return_yes }
				}
				add_timed_idea = {
					idea = large_refugee_population
					days = 365
				}
			}
			if = {
				limit = {
					FROM = { has_country_flag = settlements_yes }
				}
				PAL = { remove_ideas = israeli_settlements }
			}
			if = {
				limit = {
					FROM = { has_country_flag = settlements_no }
				}
				PAL = { add_ideas = unfavorable_boundaries }
				ISR = { add_ideas = favorable_boundaries }
			}
			if = {
				limit = {
					FROM = { has_country_flag = settlements_ish }
				}
				PAL = { add_ideas = favorable_boundaries }
				ISR = { add_ideas = unfavorable_boundaries }
			}
			if = {
				limit = {
					FROM = { has_country_flag = jerusalem_ISR }
				}
				207 = { remove_core_of = PAL }
			}
			if = {
				limit = {
					FROM = { has_country_flag = jerusalem_PAL }
				}
				207 = { remove_core_of = ISR }
				PAL = { transfer_state = 207 }
			}
			if = {
				limit = {
					FROM = { has_country_flag = jerusalem_UN }
				}
				207 = {
					set_demilitarized_zone = yes
				}
				ISR = { set_capital = { state = 204 } }
			}
			if = {
				limit = {
					FROM = { has_country_flag = palestine_state_yes }
				}
				PAL = { remove_ideas = Lacks_International_Recognition }
			}
			if = {
				limit = {
					FROM = { has_country_flag = palestine_state_no }
				}
				ISR = {
					if = {
						limit = {
							has_global_flag = GAME_RULE_allow_colored_puppets
						}
						set_autonomy = {
							target = PAL
							autonomy_state = autonomy_puppet_state_colored
							end_wars = yes
							end_civil_wars = yes
						}
					}
					else = {
						set_autonomy = {
							target = PAL
							autonomy_state = autonomy_puppet_state
							end_wars = yes
							end_civil_wars = yes
						}
					}
				}
				PAL = {
					swap_ideas = {
						remove_idea = Lacks_International_Recognition
						add_idea = Non_State_Actor
					}
				}
			}
			if = {
				limit = { ISR = { has_idea = palestinian_resistance } }
				ISR = { remove_ideas = palestinian_resistance }
			}
			if = {
				limit = {
					HAM = { has_idea = israeli_blockade }
					country_exists = HAM
				}
				HAM = { remove_ideas = israeli_blockade }
			}

		}
		if = {
			limit = {
				ISR = { has_country_flag = peace_deal_accepted_@FROM }
				PAL = { has_country_flag = peace_deal_accepted_@FROM }
			}
			hidden_effect = {
				if = {
					limit = {
						FROM = { has_country_flag = settlements_no }
					}
					PAL = { add_ideas = unfavorable_boundaries }
					ISR = { add_ideas = favorable_boundaries }
				}
				if = {
					limit = {
						FROM = { has_country_flag = settlements_ish }
					}
					PAL = { add_ideas = favorable_boundaries }
					ISR = { add_ideas = unfavorable_boundaries }
				}
				if = {
					limit = {
						FROM = { has_country_flag = jerusalem_ISR }
					}
					207 = { remove_core_of = PAL }
				}
				if = {
					limit = {
						FROM = { has_country_flag = jerusalem_PAL }
					}
					207 = { remove_core_of = ISR }
					PAL = { transfer_state = 207 }
				}
				if = {
					limit = {
						FROM = { has_country_flag = jerusalem_UN }
					}
					207 = {
						set_demilitarized_zone = yes
					}
					ISR = { set_capital = { state = 204 } }
				}
				if = {
					limit = {
						FROM = { has_country_flag = palestine_state_yes }
					}
					PAL = { remove_ideas = Lacks_International_Recognition }
				}
				if = {
					limit = {
						FROM = { has_country_flag = palestine_state_no }
					}
					ISR = {
						if = {
							limit = {
								has_global_flag = GAME_RULE_allow_colored_puppets
							}
							set_autonomy = {
								target = PAL
								autonomy_state = autonomy_puppet_state_colored
								end_wars = yes
								end_civil_wars = yes
							}
						}
						else = {
							set_autonomy = {
								target = PAL
								autonomy_state = autonomy_puppet_state
								end_wars = yes
								end_civil_wars = yes
							}
						}
					}
					PAL = {
						swap_ideas = {
							remove_idea = Lacks_International_Recognition
							add_idea = Non_State_Actor
						}
					}
				}
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				original_tag = ISR
				FROM = { check_variable = { israeli_support < 0 } }
			}
			modifier = {
				factor = 0
				original_tag = PAL
				FROM = { check_variable = { palestinian_support < 0 } }
			}
		}
	}

	option = {
		name = peace_plan.6.b #We cannot be expected to agree to a deal like this!
		log = "[GetDateText]: [This.GetName]: peace_plan.6.b executed"
		FROM = { country_event = { days = 7 id = peace_plan.8 } }
		ai_chance = {
			factor = 2
			modifier = {
				factor = 0
				original_tag = ISR
				FROM = { check_variable = { israeli_support > palestinian_support } }
			}
			modifier = {
				factor = 0
				original_tag = PAL
				FROM = { check_variable = { israeli_support < palestinian_support } }
			}
		}
	}
}

#Israel and Palestinian Authority Sign Landmark Peace Deal
news_event = {
	id = peace_plan.7
	title = peace_plan.7.t
	desc = peace_plan.7.d

	picture = GFX_trade_agreement

	trigger = {
		PAL = { has_country_flag = peace_deal_accepted_@ROOT }
		ISR = { has_country_flag = peace_deal_accepted_@ROOT }
	}

	fire_only_once = yes

	mean_time_to_happen = { days = 2 }

	option = {
		name = peace_plan.7.a #A historic moment!
		hidden_effect = { every_other_country = { news_event = { id = peace_plan.9 } } }
		log = "[GetDateText]: [This.GetName]: peace_plan.7.a executed"
	}
}

#[FROM.GetName] Rejects Peace Deal
country_event = {
	id = peace_plan.8
	title = peace_plan.8.t
	desc = peace_plan.8.d

	picture = GFX_treaty_rejected

	is_triggered_only = yes

	option = {
		name = peace_plan.8.a #Our initiative has failed...
		log = "[GetDateText]: [This.GetName]: peace_plan.8.a executed"
	}
}

#Israel and Palestinian Authority Sign Landmark Peace Deal
news_event = {
	id = peace_plan.9
	title = peace_plan.7.t
	desc = peace_plan.7.d

	picture = GFX_trade_agreement

	is_triggered_only = yes

	option = {
		name = peace_plan.7.a #A historic moment!
		log = "[GetDateText]: [This.GetName]: peace_plan.7.a executed"
	}
}

#Create: Iraqi MNF
country_event = {
	id = iraqi_MNF.1
	title = "war in iraq event" # iraqi_MNF.1.t
	desc = "Create the Multi-National Force – Iraq (Coalition forces)" # peace_plan.7.d

	picture = GFX_trade_agreement

	is_triggered_only = yes

	option = {
		name = "yes" #iraqi_MNF.1 #Create
		log = "[GetDateText]: [This.GetName]: iraqi_MNF.1.a executed"
		IRQ_MNF_setup = yes
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = "no" #iraqi_MNF.2 #Pass (No thanks)
		log = "[GetDateText]: [This.GetName]: iraqi_MNF.2.a executed"
		ai_chance = {
			factor = 1
		}
	}
}

country_event = {
	id = iraqi_MNF.2
	title = iraqi_MNF.2.t
	desc = iraqi_MNF.2.d

	is_triggered_only = yes

	option = { # We surrender
		name = iraqi_MNF.2.a
		log = "[GetDateText]: [This.GetName]: iraqi_MNF.2.a executed"
		custom_effect_tooltip = IRQ_draft_constitution_TT
		clr_country_flag = IRQ_prepare_for_usa_war
		add_ideas = IRQ_aftermath_of_war
		add_ideas = IRQ_baath_equilibrium
		set_country_flag = IRQ_war_ended
		clr_country_flag = IRQ_iraq_war_ongoing
		set_country_flag = IRQ_Nut_sacks
		set_global_flag = IRQ_defeated_in_war
		hidden_effect = {
			USA = {
				release = IRQ
				set_autonomy = {
					target = IRQ
					autonomous_state = autonomy_fifty_first_state_iraq
					end_wars = no
				}
			}
			annex_country = {
				target = MNF
			}
			if = {
				limit = {
					MNF = {
						has_volunteers_amount_from = {
							tag = ENG
							count > 0
						}
					}
				}
				171 = { transfer_state_to = ENG }
				1122 = { transfer_state_to = ENG }
				1123 = { transfer_state_to = ENG }
				1124 = { transfer_state_to = ENG }
			}
			if = {
				limit = {
					MNF = {
						has_volunteers_amount_from = {
							tag = POL
							count > 0
						}
					}
				}
				169 = { transfer_state_to = POL }
				1142 = { transfer_state_to = POL }
				1141 = { transfer_state_to = POL }
				1143 = { transfer_state_to = POL }
			}
			country_event = {
				id = iraq_md.200
				days = 2190
			}
			clear_array = ruling_party
			clear_array = gov_coalition_array
			add_to_array = { ruling_party = 13 }
			update_government_coalition_strength = yes
			set_coalition_drift = yes
			set_ruling_leader = yes
			set_leader = yes
			set_politics = {
				ruling_party = neutrality
				elections_allowed = no
			}
			set_temp_variable = { party_index = 13 }
			set_temp_variable = { party_popularity_increase = 0.35 }
			set_temp_variable = { temp_outlook_increase = 0.35 }
			add_relative_party_popularity = yes
			create_country_leader = {
				name = "Jay Garner"
				picture = "jay_garner.dds"
				ideology = Neutral_Autocracy
				traits = {
					pro_american
					democratic_champion
					neutrality_Neutral_Autocracy
				}
			}
			set_country_flag = IRQ_interim_government
			country_event = {
				id = iraq_civil_war.1
				days = 90
			}
			if = { limit = { has_character = IRQ_izzat_ibrahim_al_douri } retire_character = IRQ_izzat_ibrahim_al_douri }

			# Changes in Internal Factions:
		}
		news_event = {
			id = iraqi_flavor_events.4
		}
		ai_chance = {
			base = 1
		}
	}
	option = { # Relocate to Mosul (meant for the player mostly, I don't want the AI to do it)
		name = iraqi_MNF.2.b
		log = "[GetDateText]: [This.GetName]: iraqi_MNF.2.b executed"
		ai_chance = {
			base = 0
		}
	}
}

country_event = {
	id = syria_MNF.1
	title = "war in iraq event" # iraqi_MNF.1.t
	desc = "Create the Multi-National Force – Iraq (Coalition forces)" # peace_plan.7.d

	picture = GFX_trade_agreement

	is_triggered_only = yes

	option = {
		name = "yes" #iraqi_MNF.1 #Create
		log = "[GetDateText]: [This.GetName]: syria_MNF.1.a executed"
		syrian_civil_war_setup = yes
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = "no" #iraqi_MNF.2 #Pass (No thanks)
		log = "[GetDateText]: [This.GetName]: syria_MNF.2.a executed"
		al_nusra_setup = yes
		ai_chance = {
			factor = 1
		}
	}
}

#Fall of Iran event
country_event = {
	id = iran_interim_admin.0
	title = iran_interim_admin.0.t
	desc = iran_interim_admin.0.d

	picture = GFX_treaty_rejected

	is_triggered_only = yes

	option = {
		name = iran_interim_admin.0.a #Un Mandate
		log = "[GetDateText]: [This.GetName]: peace_plan.0.a executed"
	}

	option = {
		name = iran_interim_admin.0.b #Set up a US Proxy State
		log = "[GetDateText]: [This.GetName]: peace_plan.0.b executed"
		country_event = { days = 1 id = iran_interim_admin.1}
	}

	option = {
		name = iran_interim_admin.0.c #We shall Pass on the Plan
		log = "[GetDateText]: [This.GetName]: peace_plan.0.c executed"
	}
}

#Leadership of US Proxy State
country_event = {
	id = iran_interim_admin.1
	title = iran_interim_admin.1.t
	desc = iran_interim_admin.1.d

	picture = GFX_treaty_rejected

	is_triggered_only = yes

	option = {
		name = iran_interim_admin.1.a #Reza Pahlavi
		log = "[GetDateText]: [This.GetName]: peace_plan.1.a executed"
	}

	option = {
		name = iran_interim_admin.1.b #Maryam Rajavi - if republicans in power
		log = "[GetDateText]: [This.GetName]: peace_plan.1.b executed"
	}

	option = {
		name = iran_interim_admin.1.c #Ali Reza Asgari
		log = "[GetDateText]: [This.GetName]: peace_plan.1.c executed"
	}

	option = {
		name = iran_interim_admin.1.e #Abdollah Nouri
		log = "[GetDateText]: [This.GetName]: peace_plan.1.e executed"
	}
}